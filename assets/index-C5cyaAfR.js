var Bn=Object.defineProperty;var qs=s=>{throw TypeError(s)};var Kn=(s,e,t)=>e in s?Bn(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var ot=(s,e,t)=>Kn(s,typeof e!="symbol"?e+"":e,t),Jn=(s,e,t)=>e.has(s)||qs("Cannot "+t);var T=(s,e,t)=>(Jn(s,e,"read from private field"),t?t.call(s):e.get(s)),j=(s,e,t)=>e.has(s)?qs("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();const Fs=!1;var as=Array.isArray,Hn=Array.prototype.indexOf,Ts=Array.from,Gn=Object.defineProperty,ct=Object.getOwnPropertyDescriptor,rn=Object.getOwnPropertyDescriptors,Vn=Object.prototype,zn=Array.prototype,Cs=Object.getPrototypeOf,Ms=Object.isExtensible;function Yn(s){return s()}function ms(s){for(var e=0;e<s.length;e++)s[e]()}const we=2,an=4,os=8,xs=16,qe=32,nt=64,Os=128,pe=256,zt=512,Se=1024,$e=2048,Ze=4096,Ue=8192,Ds=16384,on=32768,Is=65536,Qn=1<<17,Xn=1<<19,ln=1<<20,gs=1<<21,Qe=Symbol("$state"),Zn=Symbol("");function cn(s){return s===this.v}function er(s,e){return s!=s?e==e:s!==e||s!==null&&typeof s=="object"||typeof s=="function"}function un(s){return!er(s,this.v)}function tr(s){throw new Error("https://svelte.dev/e/effect_in_teardown")}function sr(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function nr(s){throw new Error("https://svelte.dev/e/effect_orphan")}function rr(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ir(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function ar(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function or(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Bt=!1,lr=!1;function cr(){Bt=!0}const Es=1,Ps=2,dn=4,ur=8,dr=16,hr=1,fr=2,oe=Symbol(),pr="http://www.w3.org/1999/xhtml";function vr(s){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let J=null;function Ws(s){J=s}function me(s,e=!1,t){var n=J={p:J,c:null,d:!1,e:null,m:!1,s,x:null,l:null};Bt&&!e&&(J.l={s:null,u:null,r1:[],r2:ht(!1)}),Tr(()=>{n.d=!0})}function ge(s){const e=J;if(e!==null){const a=e.e;if(a!==null){var t=$,n=N;e.e=null;try{for(var r=0;r<a.length;r++){var i=a[r];Ve(i.effect),Ae(i.reaction),us(i.fn)}}finally{Ve(t),Ae(n)}}J=e.p,e.m=!0}return{}}function Kt(){return!Bt||J!==null&&J.l===null}function V(s){if(typeof s!="object"||s===null||Qe in s)return s;const e=Cs(s);if(e!==Vn&&e!==zn)return s;var t=new Map,n=as(s),r=D(0),i=N,a=c=>{var o=N;Ae(i);var u=c();return Ae(o),u};return n&&t.set("length",D(s.length)),new Proxy(s,{defineProperty(c,o,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&ir();var h=t.get(o);return h===void 0?h=a(()=>{var d=D(u.value);return t.set(o,d),d}):S(h,u.value,!0),!0},deleteProperty(c,o){var u=t.get(o);if(u===void 0){if(o in c){const f=a(()=>D(oe));t.set(o,f),hs(r)}}else{if(n&&typeof o=="string"){var h=t.get("length"),d=Number(o);Number.isInteger(d)&&d<h.v&&S(h,d)}S(u,oe),hs(r)}return!0},get(c,o,u){var m;if(o===Qe)return s;var h=t.get(o),d=o in c;if(h===void 0&&(!d||(m=ct(c,o))!=null&&m.writable)&&(h=a(()=>{var g=V(d?c[o]:oe),w=D(g);return w}),t.set(o,h)),h!==void 0){var f=l(h);return f===oe?void 0:f}return Reflect.get(c,o,u)},getOwnPropertyDescriptor(c,o){var u=Reflect.getOwnPropertyDescriptor(c,o);if(u&&"value"in u){var h=t.get(o);h&&(u.value=l(h))}else if(u===void 0){var d=t.get(o),f=d==null?void 0:d.v;if(d!==void 0&&f!==oe)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return u},has(c,o){var f;if(o===Qe)return!0;var u=t.get(o),h=u!==void 0&&u.v!==oe||Reflect.has(c,o);if(u!==void 0||$!==null&&(!h||(f=ct(c,o))!=null&&f.writable)){u===void 0&&(u=a(()=>{var m=h?V(c[o]):oe,g=D(m);return g}),t.set(o,u));var d=l(u);if(d===oe)return!1}return h},set(c,o,u,h){var O;var d=t.get(o),f=o in c;if(n&&o==="length")for(var m=u;m<d.v;m+=1){var g=t.get(m+"");g!==void 0?S(g,oe):m in c&&(g=a(()=>D(oe)),t.set(m+"",g))}if(d===void 0)(!f||(O=ct(c,o))!=null&&O.writable)&&(d=a(()=>D(void 0)),S(d,V(u)),t.set(o,d));else{f=d.v!==oe;var w=a(()=>V(u));S(d,w)}var b=Reflect.getOwnPropertyDescriptor(c,o);if(b!=null&&b.set&&b.set.call(h,u),!f){if(n&&typeof o=="string"){var k=t.get("length"),P=Number(o);Number.isInteger(P)&&P>=k.v&&S(k,P+1)}hs(r)}return!0},ownKeys(c){l(r);var o=Reflect.ownKeys(c).filter(d=>{var f=t.get(d);return f===void 0||f.v!==oe});for(var[u,h]of t)h.v!==oe&&!(u in c)&&o.push(u);return o},setPrototypeOf(){ar()}})}function hs(s,e=1){S(s,s.v+e)}function Bs(s){try{if(s!==null&&typeof s=="object"&&Qe in s)return s[Qe]}catch{}return s}function mr(s,e){return Object.is(Bs(s),Bs(e))}function As(s){var e=we|$e,t=N!==null&&(N.f&we)!==0?N:null;return $===null||t!==null&&(t.f&pe)!==0?e|=pe:$.f|=ln,{ctx:J,deps:null,effects:null,equals:cn,f:e,fn:s,reactions:null,rv:0,v:null,wv:0,parent:t??$}}function Ne(s){const e=As(s);return e.equals=un,e}function hn(s){var e=s.effects;if(e!==null){s.effects=null;for(var t=0;t<e.length;t+=1)Ge(e[t])}}function gr(s){for(var e=s.parent;e!==null;){if((e.f&we)===0)return e;e=e.parent}return null}function fn(s){var e,t=$;Ve(gr(s));try{hn(s),e=En(s)}finally{Ve(t)}return e}function pn(s){var e=fn(s);if(s.equals(e)||(s.v=e,s.wv=Dn()),!it){var t=(Ke||(s.f&pe)!==0)&&s.deps!==null?Ze:Se;Re(s,t)}}const dt=new Map;function ht(s,e){var t={f:0,v:s,reactions:null,equals:cn,rv:0,wv:0};return t}function D(s,e){const t=ht(s);return Ar(t),t}function _r(s,e=!1,t=!0){var r;const n=ht(s);return e||(n.equals=un),Bt&&t&&J!==null&&J.l!==null&&((r=J.l).s??(r.s=[])).push(n),n}function S(s,e,t=!1){N!==null&&!Pe&&Kt()&&(N.f&(we|xs))!==0&&!(Z!=null&&Z[1].includes(s)&&Z[0]===N)&&or();let n=t?V(e):e;return ft(s,n)}function ft(s,e){if(!s.equals(e)){var t=s.v;it?dt.set(s,e):dt.set(s,t),s.v=e,(s.f&we)!==0&&((s.f&$e)!==0&&fn(s),Re(s,(s.f&pe)===0?Se:Ze)),s.wv=Dn(),vn(s,$e),Kt()&&$!==null&&($.f&Se)!==0&&($.f&(qe|nt))===0&&(be===null?Rr([s]):be.push(s))}return e}function vn(s,e){var t=s.reactions;if(t!==null)for(var n=Kt(),r=t.length,i=0;i<r;i++){var a=t[i],c=a.f;(c&$e)===0&&(!n&&a===$||(Re(a,e),(c&(Se|pe))!==0&&((c&we)!==0?vn(a,Ze):Us(a))))}}function yr(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let br=!1;var Ks,mn,gn,_n;function wr(){if(Ks===void 0){Ks=window,mn=/Firefox/.test(navigator.userAgent);var s=Element.prototype,e=Node.prototype,t=Text.prototype;gn=ct(e,"firstChild").get,_n=ct(e,"nextSibling").get,Ms(s)&&(s.__click=void 0,s.__className=void 0,s.__attributes=null,s.__style=void 0,s.__e=void 0),Ms(t)&&(t.__t=void 0)}}function ls(s=""){return document.createTextNode(s)}function Yt(s){return gn.call(s)}function cs(s){return _n.call(s)}function v(s,e){return Yt(s)}function je(s,e){{var t=Yt(s);return t instanceof Comment&&t.data===""?cs(t):t}}function _(s,e=1,t=!1){let n=s;for(;e--;)n=cs(n);return n}function Sr(s){s.textContent=""}function yn(s){$===null&&N===null&&nr(),N!==null&&(N.f&pe)!==0&&$===null&&sr(),it&&tr()}function kr(s,e){var t=e.last;t===null?e.last=e.first=s:(t.next=s,s.prev=t,e.last=s)}function rt(s,e,t,n=!0){var r=$,i={ctx:J,deps:null,nodes_start:null,nodes_end:null,f:s|$e,first:null,fn:e,last:null,next:null,parent:r,prev:null,teardown:null,transitions:null,wv:0};if(t)try{Ns(i),i.f|=on}catch(o){throw Ge(i),o}else e!==null&&Us(i);var a=t&&i.deps===null&&i.first===null&&i.nodes_start===null&&i.teardown===null&&(i.f&(ln|Os))===0;if(!a&&n&&(r!==null&&kr(i,r),N!==null&&(N.f&we)!==0)){var c=N;(c.effects??(c.effects=[])).push(i)}return i}function Tr(s){const e=rt(os,null,!1);return Re(e,Se),e.teardown=s,e}function _s(s){yn();var e=$!==null&&($.f&qe)!==0&&J!==null&&!J.m;if(e){var t=J;(t.e??(t.e=[])).push({fn:s,effect:$,reaction:N})}else{var n=us(s);return n}}function Cr(s){return yn(),bn(s)}function xr(s){const e=rt(nt,s,!0);return(t={})=>new Promise(n=>{t.outro?Qt(e,()=>{Ge(e),n(void 0)}):(Ge(e),n(void 0))})}function us(s){return rt(an,s,!1)}function bn(s){return rt(os,s,!0)}function U(s,e=[],t=As){const n=e.map(t);return Rs(()=>s(...n.map(l)))}function Rs(s,e=0){return rt(os|xs|e,s,!0)}function pt(s,e=!0){return rt(os|qe,s,!0,e)}function wn(s){var e=s.teardown;if(e!==null){const t=it,n=N;Js(!0),Ae(null);try{e.call(null)}finally{Js(t),Ae(n)}}}function Sn(s,e=!1){var t=s.first;for(s.first=s.last=null;t!==null;){var n=t.next;(t.f&nt)!==0?t.parent=null:Ge(t,e),t=n}}function Or(s){for(var e=s.first;e!==null;){var t=e.next;(e.f&qe)===0&&Ge(e),e=t}}function Ge(s,e=!0){var t=!1;(e||(s.f&Xn)!==0)&&s.nodes_start!==null&&s.nodes_end!==null&&(Dr(s.nodes_start,s.nodes_end),t=!0),Sn(s,e&&!t),ss(s,0),Re(s,Ds);var n=s.transitions;if(n!==null)for(const i of n)i.stop();wn(s);var r=s.parent;r!==null&&r.first!==null&&kn(s),s.next=s.prev=s.teardown=s.ctx=s.deps=s.fn=s.nodes_start=s.nodes_end=null}function Dr(s,e){for(;s!==null;){var t=s===e?null:cs(s);s.remove(),s=t}}function kn(s){var e=s.parent,t=s.prev,n=s.next;t!==null&&(t.next=n),n!==null&&(n.prev=t),e!==null&&(e.first===s&&(e.first=n),e.last===s&&(e.last=t))}function Qt(s,e){var t=[];Ls(s,t,!0),Tn(t,()=>{Ge(s),e&&e()})}function Tn(s,e){var t=s.length;if(t>0){var n=()=>--t||e();for(var r of s)r.out(n)}else e()}function Ls(s,e,t){if((s.f&Ue)===0){if(s.f^=Ue,s.transitions!==null)for(const a of s.transitions)(a.is_global||t)&&e.push(a);for(var n=s.first;n!==null;){var r=n.next,i=(n.f&Is)!==0||(n.f&qe)!==0;Ls(n,e,i?t:!1),n=r}}}function Xt(s){Cn(s,!0)}function Cn(s,e){if((s.f&Ue)!==0){s.f^=Ue;for(var t=s.first;t!==null;){var n=t.next,r=(t.f&Is)!==0||(t.f&qe)!==0;Cn(t,r?e:!1),t=n}if(s.transitions!==null)for(const i of s.transitions)(i.is_global||e)&&i.in()}}let Zt=[];function Ir(){var s=Zt;Zt=[],ms(s)}function Er(s){Zt.length===0&&queueMicrotask(Ir),Zt.push(s)}function Pr(s){var e=$;if((e.f&on)===0){if((e.f&Os)===0)throw s;e.fn(s)}else xn(s,e)}function xn(s,e){for(;e!==null;){if((e.f&Os)!==0)try{e.fn(s);return}catch{}e=e.parent}throw s}let ys=!1,es=null,Xe=!1,it=!1;function Js(s){it=s}let Vt=[];let N=null,Pe=!1;function Ae(s){N=s}let $=null;function Ve(s){$=s}let Z=null;function Ar(s){N!==null&&N.f&gs&&(Z===null?Z=[N,[s]]:Z[1].push(s))}let ne=null,fe=0,be=null;function Rr(s){be=s}let On=1,ts=0,Ke=!1,Ye=null;function Dn(){return++On}function ds(s){var d;var e=s.f;if((e&$e)!==0)return!0;if((e&Ze)!==0){var t=s.deps,n=(e&pe)!==0;if(t!==null){var r,i,a=(e&zt)!==0,c=n&&$!==null&&!Ke,o=t.length;if(a||c){var u=s,h=u.parent;for(r=0;r<o;r++)i=t[r],(a||!((d=i==null?void 0:i.reactions)!=null&&d.includes(u)))&&(i.reactions??(i.reactions=[])).push(u);a&&(u.f^=zt),c&&h!==null&&(h.f&pe)===0&&(u.f^=pe)}for(r=0;r<o;r++)if(i=t[r],ds(i)&&pn(i),i.wv>s.wv)return!0}(!n||$!==null&&!Ke)&&Re(s,Se)}return!1}function In(s,e,t=!0){var n=s.reactions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];Z!=null&&Z[1].includes(s)&&Z[0]===N||((i.f&we)!==0?In(i,e,!1):e===i&&(t?Re(i,$e):(i.f&Se)!==0&&Re(i,Ze),Us(i)))}}function En(s){var m;var e=ne,t=fe,n=be,r=N,i=Ke,a=Z,c=J,o=Pe,u=s.f;ne=null,fe=0,be=null,Ke=(u&pe)!==0&&(Pe||!Xe||N===null),N=(u&(qe|nt))===0?s:null,Z=null,Ws(s.ctx),Pe=!1,ts++,s.f|=gs;try{var h=(0,s.fn)(),d=s.deps;if(ne!==null){var f;if(ss(s,fe),d!==null&&fe>0)for(d.length=fe+ne.length,f=0;f<ne.length;f++)d[fe+f]=ne[f];else s.deps=d=ne;if(!Ke)for(f=fe;f<d.length;f++)((m=d[f]).reactions??(m.reactions=[])).push(s)}else d!==null&&fe<d.length&&(ss(s,fe),d.length=fe);if(Kt()&&be!==null&&!Pe&&d!==null&&(s.f&(we|Ze|$e))===0)for(f=0;f<be.length;f++)In(be[f],s);return r!==null&&r!==s&&(ts++,be!==null&&(n===null?n=be:n.push(...be))),h}catch(g){Pr(g)}finally{ne=e,fe=t,be=n,N=r,Ke=i,Z=a,Ws(c),Pe=o,s.f^=gs}}function Lr(s,e){let t=e.reactions;if(t!==null){var n=Hn.call(t,s);if(n!==-1){var r=t.length-1;r===0?t=e.reactions=null:(t[n]=t[r],t.pop())}}t===null&&(e.f&we)!==0&&(ne===null||!ne.includes(e))&&(Re(e,Ze),(e.f&(pe|zt))===0&&(e.f^=zt),hn(e),ss(e,0))}function ss(s,e){var t=s.deps;if(t!==null)for(var n=e;n<t.length;n++)Lr(s,t[n])}function Ns(s){var e=s.f;if((e&Ds)===0){Re(s,Se);var t=$,n=Xe;$=s,Xe=!0;try{(e&xs)!==0?Or(s):Sn(s),wn(s);var r=En(s);s.teardown=typeof r=="function"?r:null,s.wv=On;var i;Fs&&lr&&(s.f&$e)!==0&&s.deps}finally{Xe=n,$=t}}}function Nr(){try{rr()}catch(s){if(es!==null)xn(s,es);else throw s}}function Ur(){var s=Xe;try{var e=0;for(Xe=!0;Vt.length>0;){e++>1e3&&Nr();var t=Vt,n=t.length;Vt=[];for(var r=0;r<n;r++){var i=$r(t[r]);jr(i)}dt.clear()}}finally{ys=!1,Xe=s,es=null}}function jr(s){var e=s.length;if(e!==0)for(var t=0;t<e;t++){var n=s[t];(n.f&(Ds|Ue))===0&&ds(n)&&(Ns(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null?kn(n):n.fn=null))}}function Us(s){ys||(ys=!0,queueMicrotask(Ur));for(var e=es=s;e.parent!==null;){e=e.parent;var t=e.f;if((t&(nt|qe))!==0){if((t&Se)===0)return;e.f^=Se}}Vt.push(e)}function $r(s){for(var e=[],t=s;t!==null;){var n=t.f,r=(n&(qe|nt))!==0,i=r&&(n&Se)!==0;if(!i&&(n&Ue)===0){(n&an)!==0?e.push(t):r?t.f^=Se:ds(t)&&Ns(t);var a=t.first;if(a!==null){t=a;continue}}var c=t.parent;for(t=t.next;t===null&&c!==null;)t=c.next,c=c.parent}return e}function l(s){var e=s.f,t=(e&we)!==0;if(Ye!==null&&Ye.add(s),N!==null&&!Pe){if(!(Z!=null&&Z[1].includes(s))||Z[0]!==N){var n=N.deps;s.rv<ts&&(s.rv=ts,ne===null&&n!==null&&n[fe]===s?fe++:ne===null?ne=[s]:(!Ke||!ne.includes(s))&&ne.push(s))}}else if(t&&s.deps===null&&s.effects===null){var r=s,i=r.parent;i!==null&&(i.f&pe)===0&&(r.f^=pe)}return t&&(r=s,ds(r)&&pn(r)),it&&dt.has(s)?dt.get(s):s.v}function qr(s){var e=Ye;Ye=new Set;var t=Ye,n;try{if(y(s),e!==null)for(n of Ye)e.add(n)}finally{Ye=e}return t}function re(s){var e=qr(()=>y(s));for(var t of e)if((t.f&Qn)!==0)for(const n of t.deps||[])(n.f&we)===0&&ft(n,n.v);else ft(t,t.v)}function y(s){var e=Pe;try{return Pe=!0,s()}finally{Pe=e}}const Fr=-7169;function Re(s,e){s.f=s.f&Fr|e}function R(s){if(!(typeof s!="object"||!s||s instanceof EventTarget)){if(Qe in s)bs(s);else if(!Array.isArray(s))for(let e in s){const t=s[e];typeof t=="object"&&t&&Qe in t&&bs(t)}}}function bs(s,e=new Set){if(typeof s=="object"&&s!==null&&!(s instanceof EventTarget)&&!e.has(s)){e.add(s),s instanceof Date&&s.getTime();for(let n in s)try{bs(s[n],e)}catch{}const t=Cs(s);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const n=rn(t);for(let r in n){const i=n[r].get;if(i)try{i.call(s)}catch{}}}}}const Mr=["touchstart","touchmove"];function Wr(s){return Mr.includes(s)}let Hs=!1;function Br(){Hs||(Hs=!0,document.addEventListener("reset",s=>{Promise.resolve().then(()=>{var e;if(!s.defaultPrevented)for(const t of s.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function Kr(s){var e=N,t=$;Ae(null),Ve(null);try{return s()}finally{Ae(e),Ve(t)}}function Pn(s,e,t,n=t){s.addEventListener(e,()=>Kr(t));const r=s.__on_r;r?s.__on_r=()=>{r(),n(!0)}:s.__on_r=()=>n(!0),Br()}const An=new Set,ws=new Set;function ze(s){for(var e=0;e<s.length;e++)An.add(s[e]);for(var t of ws)t(s)}function Ht(s){var P;var e=this,t=e.ownerDocument,n=s.type,r=((P=s.composedPath)==null?void 0:P.call(s))||[],i=r[0]||s.target,a=0,c=s.__root;if(c){var o=r.indexOf(c);if(o!==-1&&(e===document||e===window)){s.__root=e;return}var u=r.indexOf(e);if(u===-1)return;o<=u&&(a=o)}if(i=r[a]||s.target,i!==e){Gn(s,"currentTarget",{configurable:!0,get(){return i||t}});var h=N,d=$;Ae(null),Ve(null);try{for(var f,m=[];i!==null;){var g=i.assignedSlot||i.parentNode||i.host||null;try{var w=i["__"+n];if(w!=null&&(!i.disabled||s.target===i))if(as(w)){var[b,...k]=w;b.apply(i,[s,...k])}else w.call(i,s)}catch(O){f?m.push(O):f=O}if(s.cancelBubble||g===e||g===null)break;i=g}if(f){for(let O of m)queueMicrotask(()=>{throw O});throw f}}finally{s.__root=e,delete s.currentTarget,Ae(h),Ve(d)}}}function Jr(s){var e=document.createElement("template");return e.innerHTML=s.replaceAll("<!>","<!---->"),e.content}function ns(s,e){var t=$;t.nodes_start===null&&(t.nodes_start=s,t.nodes_end=e)}function I(s,e){var t=(e&hr)!==0,n=(e&fr)!==0,r,i=!s.startsWith("<!>");return()=>{r===void 0&&(r=Jr(i?s:"<!>"+s),t||(r=Yt(r)));var a=n||mn?document.importNode(r,!0):r.cloneNode(!0);if(t){var c=Yt(a),o=a.lastChild;ns(c,o)}else ns(a,a);return a}}function rs(s=""){{var e=ls(s+"");return ns(e,e),e}}function Hr(){var s=document.createDocumentFragment(),e=document.createComment(""),t=ls();return s.append(e,t),ns(e,t),s}function x(s,e){s!==null&&s.before(e)}function L(s,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(s.__t??(s.__t=s.nodeValue))&&(s.__t=t,s.nodeValue=t+"")}function Gr(s,e){return Vr(s,e)}const tt=new Map;function Vr(s,{target:e,anchor:t,props:n={},events:r,context:i,intro:a=!0}){wr();var c=new Set,o=d=>{for(var f=0;f<d.length;f++){var m=d[f];if(!c.has(m)){c.add(m);var g=Wr(m);e.addEventListener(m,Ht,{passive:g});var w=tt.get(m);w===void 0?(document.addEventListener(m,Ht,{passive:g}),tt.set(m,1)):tt.set(m,w+1)}}};o(Ts(An)),ws.add(o);var u=void 0,h=xr(()=>{var d=t??e.appendChild(ls());return pt(()=>{if(i){me({});var f=J;f.c=i}r&&(n.$$events=r),u=s(d,n)||{},i&&ge()}),()=>{var g;for(var f of c){e.removeEventListener(f,Ht);var m=tt.get(f);--m===0?(document.removeEventListener(f,Ht),tt.delete(f)):tt.set(f,m)}ws.delete(o),d!==t&&((g=d.parentNode)==null||g.removeChild(d))}});return zr.set(u,h),u}let zr=new WeakMap;function z(s,e,[t,n]=[0,0]){var r=s,i=null,a=null,c=oe,o=t>0?Is:0,u=!1;const h=(f,m=!0)=>{u=!0,d(m,f)},d=(f,m)=>{c!==(c=f)&&(c?(i?Xt(i):m&&(i=pt(()=>m(r))),a&&Qt(a,()=>{a=null})):(a?Xt(a):m&&(a=pt(()=>m(r,[t+1,n]))),i&&Qt(i,()=>{i=null})))};Rs(()=>{u=!1,e(h),u||d(null,null)},o)}function Je(s,e){return e}function Yr(s,e,t,n){for(var r=[],i=e.length,a=0;a<i;a++)Ls(e[a].e,r,!0);var c=i>0&&r.length===0&&t!==null;if(c){var o=t.parentNode;Sr(o),o.append(t),n.clear(),Be(s,e[0].prev,e[i-1].next)}Tn(r,()=>{for(var u=0;u<i;u++){var h=e[u];c||(n.delete(h.k),Be(s,h.prev,h.next)),Ge(h.e,!c)}})}function ie(s,e,t,n,r,i=null){var a=s,c={flags:e,items:new Map,first:null},o=(e&dn)!==0;if(o){var u=s;a=u.appendChild(ls())}var h=null,d=!1,f=Ne(()=>{var m=t();return as(m)?m:m==null?[]:Ts(m)});Rs(()=>{var m=l(f),g=m.length;d&&g===0||(d=g===0,Qr(m,c,a,r,e,n,t),i!==null&&(g===0?h?Xt(h):h=pt(()=>i(a)):h!==null&&Qt(h,()=>{h=null})),l(f))})}function Qr(s,e,t,n,r,i,a){var Te,De,Ie,Le;var c=(r&ur)!==0,o=(r&(Es|Ps))!==0,u=s.length,h=e.items,d=e.first,f=d,m,g=null,w,b=[],k=[],P,O,C,E;if(c)for(E=0;E<u;E+=1)P=s[E],O=i(P,E),C=h.get(O),C!==void 0&&((Te=C.a)==null||Te.measure(),(w??(w=new Set)).add(C));for(E=0;E<u;E+=1){if(P=s[E],O=i(P,E),C=h.get(O),C===void 0){var M=f?f.e.nodes_start:t;g=Zr(M,e,g,g===null?e.first:g.next,P,O,E,n,r,a),h.set(O,g),b=[],k=[],f=g.next;continue}if(o&&Xr(C,P,E,r),(C.e.f&Ue)!==0&&(Xt(C.e),c&&((De=C.a)==null||De.unfix(),(w??(w=new Set)).delete(C))),C!==f){if(m!==void 0&&m.has(C)){if(b.length<k.length){var F=k[0],ee;g=F.prev;var Oe=b[0],ke=b[b.length-1];for(ee=0;ee<b.length;ee+=1)Gs(b[ee],F,t);for(ee=0;ee<k.length;ee+=1)m.delete(k[ee]);Be(e,Oe.prev,ke.next),Be(e,g,Oe),Be(e,ke,F),f=F,g=ke,E-=1,b=[],k=[]}else m.delete(C),Gs(C,f,t),Be(e,C.prev,C.next),Be(e,C,g===null?e.first:g.next),Be(e,g,C),g=C;continue}for(b=[],k=[];f!==null&&f.k!==O;)(f.e.f&Ue)===0&&(m??(m=new Set)).add(f),k.push(f),f=f.next;if(f===null)continue;C=f}b.push(C),g=C,f=C.next}if(f!==null||m!==void 0){for(var ce=m===void 0?[]:Ts(m);f!==null;)(f.e.f&Ue)===0&&ce.push(f),f=f.next;var _e=ce.length;if(_e>0){var Me=(r&dn)!==0&&u===0?t:null;if(c){for(E=0;E<_e;E+=1)(Ie=ce[E].a)==null||Ie.measure();for(E=0;E<_e;E+=1)(Le=ce[E].a)==null||Le.fix()}Yr(e,ce,Me,h)}}c&&Er(()=>{var Ee;if(w!==void 0)for(C of w)(Ee=C.a)==null||Ee.apply()}),$.first=e.first&&e.first.e,$.last=g&&g.e}function Xr(s,e,t,n){(n&Es)!==0&&ft(s.v,e),(n&Ps)!==0?ft(s.i,t):s.i=t}function Zr(s,e,t,n,r,i,a,c,o,u){var h=(o&Es)!==0,d=(o&dr)===0,f=h?d?_r(r,!1,!1):ht(r):r,m=(o&Ps)===0?a:ht(a),g={i:m,v:f,k:i,a:null,e:null,prev:t,next:n};try{return g.e=pt(()=>c(s,f,m,u),br),g.e.prev=t&&t.e,g.e.next=n&&n.e,t===null?e.first=g:(t.next=g,t.e.next=g.e),n!==null&&(n.prev=g,n.e.prev=g.e),g}finally{}}function Gs(s,e,t){for(var n=s.next?s.next.e.nodes_start:t,r=e?e.e.nodes_start:t,i=s.e.nodes_start;i!==n;){var a=cs(i);r.before(i),i=a}}function Be(s,e,t){e===null?s.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Rn(s){var e,t,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s)){var r=s.length;for(e=0;e<r;e++)s[e]&&(t=Rn(s[e]))&&(n&&(n+=" "),n+=t)}else for(t in s)s[t]&&(n&&(n+=" "),n+=t);return n}function ei(){for(var s,e,t=0,n="",r=arguments.length;t<r;t++)(s=arguments[t])&&(e=Rn(s))&&(n&&(n+=" "),n+=e);return n}function ti(s){return typeof s=="object"?ei(s):s??""}const Vs=[...` 	
\r\fÂ \v\uFEFF`];function si(s,e,t){var n=s==null?"":""+s;if(e&&(n=n?n+" "+e:e),t){for(var r in t)if(t[r])n=n?n+" "+r:r;else if(n.length)for(var i=r.length,a=0;(a=n.indexOf(r,a))>=0;){var c=a+i;(a===0||Vs.includes(n[a-1]))&&(c===n.length||Vs.includes(n[c]))?n=(a===0?"":n.substring(0,a))+n.substring(c+1):a=c}}return n===""?null:n}function ni(s,e){return s==null?null:String(s)}function X(s,e,t,n,r,i){var a=s.__className;if(a!==t||a===void 0){var c=si(t,n,i);c==null?s.removeAttribute("class"):s.className=c,s.__className=t}else if(i&&r!==i)for(var o in i){var u=!!i[o];(r==null||u!==!!r[o])&&s.classList.toggle(o,u)}return i}function is(s,e,t,n){var r=s.__style;if(r!==e){var i=ni(e);i==null?s.removeAttribute("style"):s.style.cssText=i,s.__style=e}return n}function Ln(s,e,t){if(s.multiple){if(e==null)return;if(!as(e))return yr();for(var n of s.options)n.selected=e.includes(ut(n));return}for(n of s.options){var r=ut(n);if(mr(r,e)){n.selected=!0;return}}(!t||e!==void 0)&&(s.selectedIndex=-1)}function ri(s,e){us(()=>{var t=new MutationObserver(()=>{var n=s.__value;Ln(s,n)});return t.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function zs(s,e,t=e){var n=!0;Pn(s,"change",r=>{var i=r?"[selected]":":checked",a;if(s.multiple)a=[].map.call(s.querySelectorAll(i),ut);else{var c=s.querySelector(i)??s.querySelector("option:not([disabled])");a=c&&ut(c)}t(a)}),us(()=>{var r=e();if(Ln(s,r,n),n&&r===void 0){var i=s.querySelector(":checked");i!==null&&(r=ut(i),t(r))}s.__value=r,n=!1}),ri(s)}function ut(s){return"__value"in s?s.__value:s.value}const ii=Symbol("is custom element"),ai=Symbol("is html");function Nn(s,e){var t=Un(s);t.value===(t.value=e??void 0)||s.value===e&&(e!==0||s.nodeName!=="PROGRESS")||(s.value=e??"")}function He(s,e,t,n){var r=Un(s);r[e]!==(r[e]=t)&&(e==="loading"&&(s[Zn]=t),t==null?s.removeAttribute(e):typeof t!="string"&&oi(s).includes(e)?s[e]=t:s.setAttribute(e,t))}function Un(s){return s.__attributes??(s.__attributes={[ii]:s.nodeName.includes("-"),[ai]:s.namespaceURI===pr})}var Ys=new Map;function oi(s){var e=Ys.get(s.nodeName);if(e)return e;Ys.set(s.nodeName,e=[]);for(var t,n=s,r=Element.prototype;r!==n;){t=rn(n);for(var i in t)t[i].set&&e.push(i);n=Cs(n)}return e}function le(s,e,t=e){var n=Kt();Pn(s,"input",r=>{var i=r?s.defaultValue:s.value;if(i=fs(s)?ps(i):i,t(i),n&&i!==(i=e())){var a=s.selectionStart,c=s.selectionEnd;s.value=i??"",c!==null&&(s.selectionStart=a,s.selectionEnd=Math.min(c,s.value.length))}}),y(e)==null&&s.value&&t(fs(s)?ps(s.value):s.value),bn(()=>{var r=e();fs(s)&&r===ps(s.value)||s.type==="date"&&!r&&!s.value||r!==s.value&&(s.value=r??"")})}function fs(s){var e=s.type;return e==="number"||e==="range"}function ps(s){return s===""?null:+s}function xe(s=!1){const e=J,t=e.l.u;if(!t)return;let n=()=>R(e.s);if(s){let r=0,i={};const a=As(()=>{let c=!1;const o=e.s;for(const u in o)o[u]!==i[u]&&(i[u]=o[u],c=!0);return c&&r++,r});n=()=>l(a)}t.b.length&&Cr(()=>{Qs(e,n),ms(t.b)}),_s(()=>{const r=y(()=>t.m.map(Yn));return()=>{for(const i of r)typeof i=="function"&&i()}}),t.a.length&&_s(()=>{Qs(e,n),ms(t.a)})}function Qs(s,e){if(s.l.s)for(const t of s.l.s)l(t);e()}function li(s){J===null&&vr(),Bt&&J.l!==null?ci(J).m.push(s):_s(()=>{const e=y(s);if(typeof e=="function")return e})}function ci(s){var e=s.l;return e.u??(e.u={a:[],b:[],m:[]})}const ui="5";var nn;typeof window<"u"&&((nn=window.__svelte??(window.__svelte={})).v??(nn.v=new Set)).add(ui);cr();class ve extends Error{constructor(e){var t,n,r,i;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,ve.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof ve||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(i=(r=(n=this.originalError)==null?void 0:n.cause)==null?void 0:r.message)!=null&&i.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong."),this.cause=this.originalError}get data(){return this.response}toJSON(){return{...this}}}const Gt=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function di(s,e){const t={};if(typeof s!="string")return t;const n=Object.assign({},{}).decode||hi;let r=0;for(;r<s.length;){const i=s.indexOf("=",r);if(i===-1)break;let a=s.indexOf(";",r);if(a===-1)a=s.length;else if(a<i){r=s.lastIndexOf(";",i-1)+1;continue}const c=s.slice(r,i).trim();if(t[c]===void 0){let o=s.slice(i+1,a).trim();o.charCodeAt(0)===34&&(o=o.slice(1,-1));try{t[c]=n(o)}catch{t[c]=o}}r=a+1}return t}function Xs(s,e,t){const n=Object.assign({},t||{}),r=n.encode||fi;if(!Gt.test(s))throw new TypeError("argument name is invalid");const i=r(e);if(i&&!Gt.test(i))throw new TypeError("argument val is invalid");let a=s+"="+i;if(n.maxAge!=null){const c=n.maxAge-0;if(isNaN(c)||!isFinite(c))throw new TypeError("option maxAge is invalid");a+="; Max-Age="+Math.floor(c)}if(n.domain){if(!Gt.test(n.domain))throw new TypeError("option domain is invalid");a+="; Domain="+n.domain}if(n.path){if(!Gt.test(n.path))throw new TypeError("option path is invalid");a+="; Path="+n.path}if(n.expires){if(!function(o){return Object.prototype.toString.call(o)==="[object Date]"||o instanceof Date}(n.expires)||isNaN(n.expires.valueOf()))throw new TypeError("option expires is invalid");a+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(a+="; HttpOnly"),n.secure&&(a+="; Secure"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():n.priority){case"low":a+="; Priority=Low";break;case"medium":a+="; Priority=Medium";break;case"high":a+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a}function hi(s){return s.indexOf("%")!==-1?decodeURIComponent(s):s}function fi(s){return encodeURIComponent(s)}const pi=typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal;let jn;function st(s){if(s)try{const e=decodeURIComponent(jn(s.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function $n(s,e=0){let t=st(s);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}jn=typeof atob!="function"||pi?s=>{let e=String(s).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,n,r=0,i=0,a="";n=e.charAt(i++);~n&&(t=r%4?64*t+n:n,r++%4)?a+=String.fromCharCode(255&t>>(-2*r&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return a}:atob;const Zs="pb_auth";class js{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get record(){return this.baseModel}get model(){return this.baseModel}get isValid(){return!$n(this.token)}get isSuperuser(){var t,n;let e=st(this.token);return e.type=="auth"&&(((t=this.record)==null?void 0:t.collectionName)=="_superusers"||!((n=this.record)!=null&&n.collectionName)&&e.collectionId=="pbc_3142635823")}get isAdmin(){return console.warn("Please replace pb.authStore.isAdmin with pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),this.isSuperuser}get isAuthRecord(){return console.warn("Please replace pb.authStore.isAuthRecord with !pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),st(this.token).type=="auth"&&!this.isSuperuser}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=Zs){const n=di(e||"")[t]||"";let r={};try{r=JSON.parse(n),(typeof r===null||typeof r!="object"||Array.isArray(r))&&(r={})}catch{}this.save(r.token||"",r.record||r.model||null)}exportToCookie(e,t=Zs){var o,u;const n={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},r=st(this.token);n.expires=r!=null&&r.exp?new Date(1e3*r.exp):new Date("1970-01-01"),e=Object.assign({},n,e);const i={token:this.token,record:this.record?JSON.parse(JSON.stringify(this.record)):null};let a=Xs(t,JSON.stringify(i),e);const c=typeof Blob<"u"?new Blob([a]).size:a.length;if(i.record&&c>4096){i.record={id:(o=i.record)==null?void 0:o.id,email:(u=i.record)==null?void 0:u.email};const h=["collectionId","collectionName","verified"];for(const d in this.record)h.includes(d)&&(i.record[d]=this.record[d]);a=Xs(t,JSON.stringify(i),e)}return a}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.record),()=>{for(let n=this._onChangeCallbacks.length-1;n>=0;n--)if(this._onChangeCallbacks[n]==e)return delete this._onChangeCallbacks[n],void this._onChangeCallbacks.splice(n,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.record)}}class vi extends js{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get record(){const e=this._storageGet(this.storageKey)||{};return e.record||e.model||null}get model(){return this.record}save(e,t){this._storageSet(this.storageKey,{token:e,record:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let n=t;typeof t!="string"&&(n=JSON.stringify(t)),window.localStorage.setItem(e,n)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.record||t.model||null)})}}class Fe{constructor(e){this.client=e}}class mi extends Fe{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,n,r){return r=Object.assign({method:"POST",body:{email:t,template:n,collection:e}},r),this.client.send("/api/settings/test/email",r).then(()=>!0)}async generateAppleClientSecret(e,t,n,r,i,a){return a=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:n,privateKey:r,duration:i}},a),this.client.send("/api/settings/apple/generate-client-secret",a)}}const gi=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function $s(s){if(s){s.query=s.query||{};for(let e in s)gi.includes(e)||(s.query[e]=s[e],delete s[e])}}function qn(s){const e=[];for(const t in s){const n=encodeURIComponent(t),r=Array.isArray(s[t])?s[t]:[s[t]];for(let i of r)i=_i(i),i!==null&&e.push(n+"="+i)}return e.join("&")}function _i(s){return s==null?null:s instanceof Date?encodeURIComponent(s.toISOString().replace("T"," ")):encodeURIComponent(typeof s=="object"?JSON.stringify(s):s)}class Fn extends Fe{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,n){var a;if(!e)throw new Error("topic must be set.");let r=e;if(n){$s(n=Object.assign({},n));const c="options="+encodeURIComponent(JSON.stringify({query:n.query,headers:n.headers}));r+=(r.includes("?")?"&":"?")+c}const i=function(c){const o=c;let u;try{u=JSON.parse(o==null?void 0:o.data)}catch{}t(u||{})};return this.subscriptions[r]||(this.subscriptions[r]=[]),this.subscriptions[r].push(i),this.isConnected?this.subscriptions[r].length===1?await this.submitSubscriptions():(a=this.eventSource)==null||a.addEventListener(r,i):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,i)}async unsubscribe(e){var n;let t=!1;if(e){const r=this.getSubscriptionsByTopic(e);for(let i in r)if(this.hasSubscriptionListeners(i)){for(let a of this.subscriptions[i])(n=this.eventSource)==null||n.removeEventListener(i,a);delete this.subscriptions[i],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var n;let t=!1;for(let r in this.subscriptions)if((r+"?").startsWith(e)){t=!0;for(let i of this.subscriptions[r])(n=this.eventSource)==null||n.removeEventListener(r,i);delete this.subscriptions[r]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var i;let n=!1;const r=this.getSubscriptionsByTopic(e);for(let a in r){if(!Array.isArray(this.subscriptions[a])||!this.subscriptions[a].length)continue;let c=!1;for(let o=this.subscriptions[a].length-1;o>=0;o--)this.subscriptions[a][o]===t&&(c=!0,delete this.subscriptions[a][o],this.subscriptions[a].splice(o,1),(i=this.eventSource)==null||i.removeEventListener(a,t));c&&(this.subscriptions[a].length||delete this.subscriptions[a],n||this.hasSubscriptionListeners(a)||(n=!0))}this.hasSubscriptionListeners()?n&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,n;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let r in this.subscriptions)if((n=this.subscriptions[r])!=null&&n.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let n in this.subscriptions)(n+"?").startsWith(e)&&(t[n]=this.subscriptions[n]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildURL("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let n=3;for(;this.hasUnsentSubscriptions()&&n>0;)n--,await this.submitSubscriptions()}).then(()=>{for(let r of this.pendingConnects)r.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const n=this.getSubscriptionsByTopic("PB_CONNECT");for(let r in n)for(let i of n[r])i(e)}).catch(n=>{this.clientId="",this.connectErrorHandler(n)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let n of this.pendingConnects)n.reject(new ve(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(this.clientId&&this.onDisconnect&&this.onDisconnect(Object.keys(this.subscriptions)),clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let n of this.pendingConnects)n.resolve();this.pendingConnects=[]}}}class Mn extends Fe{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let n=500;return(t=Object.assign({},e,t)).batch&&(n=t.batch,delete t.batch),this._getFullList(n,t)}async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send(this.baseCrudPath,n).then(r=>{var i;return r.items=((i=r.items)==null?void 0:i.map(a=>this.decode(a)))||[],r})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(n=>{var r;if(!((r=n==null?void 0:n.items)!=null&&r.length))throw new ve({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return n.items[0]})}async getOne(e,t){if(!e)throw new ve({url:this.client.buildURL(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(n=>this.decode(n))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(n=>this.decode(n))}async update(e,t,n){return n=Object.assign({method:"PATCH",body:t},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(r=>this.decode(r))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let n=[],r=async i=>this.getList(i,e||500,t).then(a=>{const c=a.items;return n=n.concat(c),c.length==a.perPage?r(i+1):n});return r(1)}}function We(s,e,t,n){const r=n!==void 0;return r||t!==void 0?r?(console.warn(s),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,n),e):Object.assign(e,t):e}function vs(s){var e;(e=s._resetAutoRefresh)==null||e.call(s)}class yi extends Mn{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}get isSuperusers(){return this.collectionIdOrName=="_superusers"||this.collectionIdOrName=="_pbc_2773867675"}async subscribe(e,t,n){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,n)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const n=Object.assign({},e,t);return super.getFullList(n)}async getList(e=1,t=30,n){return super.getList(e,t,n)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,n){return super.update(e,t,n).then(r=>{var i,a,c;if(((i=this.client.authStore.record)==null?void 0:i.id)===(r==null?void 0:r.id)&&(((a=this.client.authStore.record)==null?void 0:a.collectionId)===this.collectionIdOrName||((c=this.client.authStore.record)==null?void 0:c.collectionName)===this.collectionIdOrName)){let o=Object.assign({},this.client.authStore.record.expand),u=Object.assign({},this.client.authStore.record,r);o&&(u.expand=Object.assign(o,r.expand)),this.client.authStore.save(this.client.authStore.token,u)}return r})}async delete(e,t){return super.delete(e,t).then(n=>{var r,i,a;return!n||((r=this.client.authStore.record)==null?void 0:r.id)!==e||((i=this.client.authStore.record)==null?void 0:i.collectionId)!==this.collectionIdOrName&&((a=this.client.authStore.record)==null?void 0:a.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),n})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET",fields:"mfa,otp,password,oauth2"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e)}async authWithPassword(e,t,n){let r;n=Object.assign({method:"POST",body:{identity:e,password:t}},n),this.isSuperusers&&(r=n.autoRefreshThreshold,delete n.autoRefreshThreshold,n.autoRefresh||vs(this.client));let i=await this.client.send(this.baseCollectionPath+"/auth-with-password",n);return i=this.authResponse(i),r&&this.isSuperusers&&function(c,o,u,h){vs(c);const d=c.beforeSend,f=c.authStore.record,m=c.authStore.onChange((g,w)=>{(!g||(w==null?void 0:w.id)!=(f==null?void 0:f.id)||(w!=null&&w.collectionId||f!=null&&f.collectionId)&&(w==null?void 0:w.collectionId)!=(f==null?void 0:f.collectionId))&&vs(c)});c._resetAutoRefresh=function(){m(),c.beforeSend=d,delete c._resetAutoRefresh},c.beforeSend=async(g,w)=>{var O;const b=c.authStore.token;if((O=w.query)!=null&&O.autoRefresh)return d?d(g,w):{url:g,sendOptions:w};let k=c.authStore.isValid;if(k&&$n(c.authStore.token,o))try{await u()}catch{k=!1}k||await h();const P=w.headers||{};for(let C in P)if(C.toLowerCase()=="authorization"&&b==P[C]&&c.authStore.token){P[C]=c.authStore.token;break}return w.headers=P,d?d(g,w):{url:g,sendOptions:w}}}(this.client,r,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},n))),i}async authWithOAuth2Code(e,t,n,r,i,a,c){let o={method:"POST",body:{provider:e,code:t,codeVerifier:n,redirectURL:r,createData:i}};return o=We("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, options?).",o,a,c),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",o).then(u=>this.authResponse(u))}authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{};let n=null;t.urlCallback||(n=en(void 0));const r=new Fn(this.client);function i(){n==null||n.close(),r.unsubscribe()}const a={},c=t.requestKey;return c&&(a.requestKey=c),this.listAuthMethods(a).then(o=>{var f;const u=o.oauth2.providers.find(m=>m.name===t.provider);if(!u)throw new ve(new Error(`Missing or invalid provider "${t.provider}".`));const h=this.client.buildURL("/api/oauth2-redirect"),d=c?(f=this.client.cancelControllers)==null?void 0:f[c]:void 0;return d&&(d.signal.onabort=()=>{i()}),new Promise(async(m,g)=>{var w;try{await r.subscribe("@oauth2",async O=>{var E;const C=r.clientId;try{if(!O.state||C!==O.state)throw new Error("State parameters don't match.");if(O.error||!O.code)throw new Error("OAuth2 redirect error or missing code: "+O.error);const M=Object.assign({},t);delete M.provider,delete M.scopes,delete M.createData,delete M.urlCallback,(E=d==null?void 0:d.signal)!=null&&E.onabort&&(d.signal.onabort=null);const F=await this.authWithOAuth2Code(u.name,O.code,u.codeVerifier,h,t.createData,M);m(F)}catch(M){g(new ve(M))}i()});const b={state:r.clientId};(w=t.scopes)!=null&&w.length&&(b.scope=t.scopes.join(" "));const k=this._replaceQueryParams(u.authURL+h,b);await(t.urlCallback||function(O){n?n.location.href=O:n=en(O)})(k)}catch(b){i(),g(new ve(b))}})}).catch(o=>{throw i(),o})}async authRefresh(e,t){let n={method:"POST"};return n=We("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",n).then(r=>this.authResponse(r))}async requestPasswordReset(e,t,n){let r={method:"POST",body:{email:e}};return r=We("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",r,t,n),this.client.send(this.baseCollectionPath+"/request-password-reset",r).then(()=>!0)}async confirmPasswordReset(e,t,n,r,i){let a={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return a=We("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",a,r,i),this.client.send(this.baseCollectionPath+"/confirm-password-reset",a).then(()=>!0)}async requestVerification(e,t,n){let r={method:"POST",body:{email:e}};return r=We("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",r,t,n),this.client.send(this.baseCollectionPath+"/request-verification",r).then(()=>!0)}async confirmVerification(e,t,n){let r={method:"POST",body:{token:e}};return r=We("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",r,t,n),this.client.send(this.baseCollectionPath+"/confirm-verification",r).then(()=>{const i=st(e),a=this.client.authStore.record;return a&&!a.verified&&a.id===i.id&&a.collectionId===i.collectionId&&(a.verified=!0,this.client.authStore.save(this.client.authStore.token,a)),!0})}async requestEmailChange(e,t,n){let r={method:"POST",body:{newEmail:e}};return r=We("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",r,t,n),this.client.send(this.baseCollectionPath+"/request-email-change",r).then(()=>!0)}async confirmEmailChange(e,t,n,r){let i={method:"POST",body:{token:e,password:t}};return i=We("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",i,n,r),this.client.send(this.baseCollectionPath+"/confirm-email-change",i).then(()=>{const a=st(e),c=this.client.authStore.record;return c&&c.id===a.id&&c.collectionId===a.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,t){return this.client.collection("_externalAuths").getFullList(Object.assign({},t,{filter:this.client.filter("recordRef = {:id}",{id:e})}))}async unlinkExternalAuth(e,t,n){const r=await this.client.collection("_externalAuths").getFirstListItem(this.client.filter("recordRef = {:recordId} && provider = {:provider}",{recordId:e,provider:t}));return this.client.collection("_externalAuths").delete(r.id,n).then(()=>!0)}async requestOTP(e,t){return t=Object.assign({method:"POST",body:{email:e}},t),this.client.send(this.baseCollectionPath+"/request-otp",t)}async authWithOTP(e,t,n){return n=Object.assign({method:"POST",body:{otpId:e,password:t}},n),this.client.send(this.baseCollectionPath+"/auth-with-otp",n).then(r=>this.authResponse(r))}async impersonate(e,t,n){(n=Object.assign({method:"POST",body:{duration:t}},n)).headers=n.headers||{},n.headers.Authorization||(n.headers.Authorization=this.client.authStore.token);const r=new Wn(this.client.baseURL,new js,this.client.lang),i=await r.send(this.baseCollectionPath+"/impersonate/"+encodeURIComponent(e),n);return r.authStore.save(i==null?void 0:i.token,this.decode((i==null?void 0:i.record)||{})),r}_replaceQueryParams(e,t={}){let n=e,r="";e.indexOf("?")>=0&&(n=e.substring(0,e.indexOf("?")),r=e.substring(e.indexOf("?")+1));const i={},a=r.split("&");for(const c of a){if(c=="")continue;const o=c.split("=");i[decodeURIComponent(o[0].replace(/\+/g," "))]=decodeURIComponent((o[1]||"").replace(/\+/g," "))}for(let c in t)t.hasOwnProperty(c)&&(t[c]==null?delete i[c]:i[c]=t[c]);r="";for(let c in i)i.hasOwnProperty(c)&&(r!=""&&(r+="&"),r+=encodeURIComponent(c.replace(/%20/g,"+"))+"="+encodeURIComponent(i[c].replace(/%20/g,"+")));return r!=""?n+"?"+r:n}}function en(s){if(typeof window>"u"||!(window!=null&&window.open))throw new ve(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,n=window.innerWidth,r=window.innerHeight;e=e>n?n:e,t=t>r?r:t;let i=n/2-e/2,a=r/2-t/2;return window.open(s,"popup_window","width="+e+",height="+t+",top="+a+",left="+i+",resizable,menubar=no")}class bi extends Mn{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,n){return n=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},n),this.client.send(this.baseCrudPath+"/import",n).then(()=>!0)}async getScaffolds(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/meta/scaffolds",e)}async truncate(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/truncate",t).then(()=>!0)}}class wi extends Fe{async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send("/api/logs",n)}async getOne(e,t){if(!e)throw new ve({url:this.client.buildURL("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class Si extends Fe{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class ki extends Fe{getUrl(e,t,n={}){return console.warn("Please replace pb.files.getUrl() with pb.files.getURL()"),this.getURL(e,t,n)}getURL(e,t,n={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const r=[];r.push("api"),r.push("files"),r.push(encodeURIComponent(e.collectionId||e.collectionName)),r.push(encodeURIComponent(e.id)),r.push(encodeURIComponent(t));let i=this.client.buildURL(r.join("/"));if(Object.keys(n).length){n.download===!1&&delete n.download;const a=new URLSearchParams(n);i+=(i.includes("?")?"&":"?")+a}return i}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class Ti extends Fe{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return console.warn("Please replace pb.backups.getDownloadUrl() with pb.backups.getDownloadURL()"),this.getDownloadURL(e,t)}getDownloadURL(e,t){return this.client.buildURL(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class Ci extends Fe{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/crons",e)}async run(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/crons/${encodeURIComponent(e)}`,t).then(()=>!0)}}function Ss(s){return typeof Blob<"u"&&s instanceof Blob||typeof File<"u"&&s instanceof File||s!==null&&typeof s=="object"&&s.uri&&(typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal)}function ks(s){return s&&(s.constructor.name==="FormData"||typeof FormData<"u"&&s instanceof FormData)}function tn(s){for(const e in s){const t=Array.isArray(s[e])?s[e]:[s[e]];for(const n of t)if(Ss(n))return!0}return!1}const xi=/^[\-\.\d]+$/;function sn(s){if(typeof s!="string")return s;if(s=="true")return!0;if(s=="false")return!1;if((s[0]==="-"||s[0]>="0"&&s[0]<="9")&&xi.test(s)){let e=+s;if(""+e===s)return e}return s}class Oi extends Fe{constructor(){super(...arguments),this.requests=[],this.subs={}}collection(e){return this.subs[e]||(this.subs[e]=new Di(this.requests,e)),this.subs[e]}async send(e){const t=new FormData,n=[];for(let r=0;r<this.requests.length;r++){const i=this.requests[r];if(n.push({method:i.method,url:i.url,headers:i.headers,body:i.json}),i.files)for(let a in i.files){const c=i.files[a]||[];for(let o of c)t.append("requests."+r+"."+a,o)}}return t.append("@jsonPayload",JSON.stringify({requests:n})),e=Object.assign({method:"POST",body:t},e),this.client.send("/api/batch",e)}}class Di{constructor(e,t){this.requests=[],this.requests=e,this.collectionIdOrName=t}upsert(e,t){t=Object.assign({body:e||{}},t);const n={method:"PUT",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(n,t),this.requests.push(n)}create(e,t){t=Object.assign({body:e||{}},t);const n={method:"POST",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(n,t),this.requests.push(n)}update(e,t,n){n=Object.assign({body:t||{}},n);const r={method:"PATCH",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(r,n),this.requests.push(r)}delete(e,t){t=Object.assign({},t);const n={method:"DELETE",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(n,t),this.requests.push(n)}prepareRequest(e,t){if($s(t),e.headers=t.headers,e.json={},e.files={},t.query!==void 0){const r=qn(t.query);r&&(e.url+=(e.url.includes("?")?"&":"?")+r)}let n=t.body;ks(n)&&(n=function(i){let a={};return i.forEach((c,o)=>{if(o==="@jsonPayload"&&typeof c=="string")try{let u=JSON.parse(c);Object.assign(a,u)}catch(u){console.warn("@jsonPayload error:",u)}else a[o]!==void 0?(Array.isArray(a[o])||(a[o]=[a[o]]),a[o].push(sn(c))):a[o]=sn(c)}),a}(n));for(const r in n){const i=n[r];if(Ss(i))e.files[r]=e.files[r]||[],e.files[r].push(i);else if(Array.isArray(i)){const a=[],c=[];for(const o of i)Ss(o)?a.push(o):c.push(o);if(a.length>0&&a.length==i.length){e.files[r]=e.files[r]||[];for(let o of a)e.files[r].push(o)}else if(e.json[r]=c,a.length>0){let o=r;r.startsWith("+")||r.endsWith("+")||(o+="+"),e.files[o]=e.files[o]||[];for(let u of a)e.files[o].push(u)}}else e.json[r]=i}}}class Wn{get baseUrl(){return this.baseURL}set baseUrl(e){this.baseURL=e}constructor(e="/",t,n="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseURL=e,this.lang=n,t?this.authStore=t:typeof window<"u"&&window.Deno?this.authStore=new js:this.authStore=new vi,this.collections=new bi(this),this.files=new ki(this),this.logs=new wi(this),this.settings=new mi(this),this.realtime=new Fn(this),this.health=new Si(this),this.backups=new Ti(this),this.crons=new Ci(this)}get admins(){return this.collection("_superusers")}createBatch(){return new Oi(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new yi(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let n in t){let r=t[n];switch(typeof r){case"boolean":case"number":r=""+r;break;case"string":r="'"+r.replace(/'/g,"\\'")+"'";break;default:r=r===null?"null":r instanceof Date?"'"+r.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(r).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+n+"}",r)}return e}getFileUrl(e,t,n={}){return console.warn("Please replace pb.getFileUrl() with pb.files.getURL()"),this.files.getURL(e,t,n)}buildUrl(e){return console.warn("Please replace pb.buildUrl() with pb.buildURL()"),this.buildURL(e)}buildURL(e){var n;let t=this.baseURL;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(n=window.location.origin)!=null&&n.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseURL.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseURL),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let n=this.buildURL(e);if(this.beforeSend){const r=Object.assign({},await this.beforeSend(n,t));r.url!==void 0||r.options!==void 0?(n=r.url||n,t=r.options||t):Object.keys(r).length&&(t=r,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const r=qn(t.query);r&&(n+=(n.includes("?")?"&":"?")+r),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(n,t).then(async r=>{let i={};try{i=await r.json()}catch{}if(this.afterSend&&(i=await this.afterSend(r,i,t)),r.status>=400)throw new ve({url:r.url,status:r.status,data:i});return i}).catch(r=>{throw new ve(r)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=function(r){if(typeof FormData>"u"||r===void 0||typeof r!="object"||r===null||ks(r)||!tn(r))return r;const i=new FormData;for(const a in r){const c=r[a];if(c!==void 0)if(typeof c!="object"||tn({data:c})){const o=Array.isArray(c)?c:[c];for(let u of o)i.append(a,u)}else{let o={};o[a]=c,i.append("@jsonPayload",JSON.stringify(o))}}return i}(t.body),$s(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||ks(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const n=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(n);const r=new AbortController;this.cancelControllers[n]=r,t.signal=r.signal}return t}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let n in e)if(n.toLowerCase()==t)return e[n];return null}}let Ii=0;const lt=()=>`id_${Date.now()}_${Ii++}`;var vt,mt,gt,_t,yt,bt,wt,St,kt,Tt,Ct,xt,Ot,Dt,It,Et,Pt,At,Rt,Lt,Nt,Ut,jt,$t,qt,Ft,Mt,Wt;class Ei{constructor(){ot(this,"pb",new Wn(window.location.origin));j(this,vt,D(!0));ot(this,"lastSavedState",null);j(this,mt,D(""));j(this,gt,D(""));j(this,_t,D("London"));j(this,yt,D("saved"));ot(this,"saveTimeout",null);j(this,bt,D(!1));j(this,wt,D(""));ot(this,"notificationTimeout",null);j(this,St,D(V(navigator.onLine)));j(this,kt,D(V([])));j(this,Tt,D(!1));j(this,Ct,D(!1));j(this,xt,D(""));j(this,Ot,D(""));j(this,Dt,D(V(new Date().getDay())));j(this,It,D("Weekly Planner"));j(this,Et,D(V([])));j(this,Pt,D(V([])));j(this,At,D(V([])));j(this,Rt,D(V([])));j(this,Lt,D(V([])));j(this,Nt,D(V([])));j(this,Ut,D(V([])));j(this,jt,D(V([])));j(this,$t,D(null));j(this,qt,D(null));j(this,Ft,D(V([])));j(this,Mt,D(V([{name:"London",lat:51.5074,lon:-.1278},{name:"Cairo",lat:30.0444,lon:31.2357},{name:"Cape Town",lat:-33.9249,lon:18.4241},{name:"Amsterdam",lat:52.3676,lon:4.9041},{name:"Current Location",lat:null,lon:null}])));j(this,Wt,D(!1));this.pb.autoCancellation(!1),this.setupEventListeners()}get isInitializing(){return l(T(this,vt))}set isInitializing(e){S(T(this,vt),e,!0)}get currentWeek(){return l(T(this,mt))}set currentWeek(e){S(T(this,mt),e,!0)}get dateRange(){return l(T(this,gt))}set dateRange(e){S(T(this,gt),e,!0)}get city(){return l(T(this,_t))}set city(e){S(T(this,_t),e,!0)}get saveStatus(){return l(T(this,yt))}set saveStatus(e){S(T(this,yt),e,!0)}get showNotification(){return l(T(this,bt))}set showNotification(e){S(T(this,bt),e,!0)}get notificationMessage(){return l(T(this,wt))}set notificationMessage(e){S(T(this,wt),e,!0)}get isOnline(){return l(T(this,St))}set isOnline(e){S(T(this,St),e,!0)}get pendingSync(){return l(T(this,kt))}set pendingSync(e){S(T(this,kt),e,!0)}get showCitySelector(){return l(T(this,Tt))}set showCitySelector(e){S(T(this,Tt),e,!0)}get showWeekSelector(){return l(T(this,Ct))}set showWeekSelector(e){S(T(this,Ct),e,!0)}get cityDropdownStyle(){return l(T(this,xt))}set cityDropdownStyle(e){S(T(this,xt),e,!0)}get weekDropdownStyle(){return l(T(this,Ot))}set weekDropdownStyle(e){S(T(this,Ot),e,!0)}get currentDay(){return l(T(this,Dt))}set currentDay(e){S(T(this,Dt),e,!0)}get plannerTitle(){return l(T(this,It))}set plannerTitle(e){S(T(this,It),e,!0)}get times(){return l(T(this,Et))}set times(e){S(T(this,Et),e,!0)}get schedule(){return l(T(this,Pt))}set schedule(e){S(T(this,Pt),e,!0)}get tasks(){return l(T(this,At))}set tasks(e){S(T(this,At),e,!0)}get workoutPlan(){return l(T(this,Rt))}set workoutPlan(e){S(T(this,Rt),e,!0)}get meals(){return l(T(this,Lt))}set meals(e){S(T(this,Lt),e,!0)}get groceryList(){return l(T(this,Nt))}set groceryList(e){S(T(this,Nt),e,!0)}get bodyMeasurements(){return l(T(this,Ut))}set bodyMeasurements(e){S(T(this,Ut),e,!0)}get financials(){return l(T(this,jt))}set financials(e){S(T(this,jt),e,!0)}get currentTemplate(){return l(T(this,$t))}set currentTemplate(e){S(T(this,$t),e,!0)}get currentTemplateId(){return l(T(this,qt))}set currentTemplateId(e){S(T(this,qt),e,!0)}get savedWeeks(){return l(T(this,Ft))}set savedWeeks(e){S(T(this,Ft),e,!0)}get cityOptions(){return l(T(this,Mt))}set cityOptions(e){S(T(this,Mt),e,!0)}get showSetupModal(){return l(T(this,Wt))}set showSetupModal(e){S(T(this,Wt),e,!0)}setupEventListeners(){window.addEventListener("online",()=>{this.isOnline=!0,this.syncPendingData()}),window.addEventListener("offline",()=>this.isOnline=!1),document.addEventListener("click",e=>{e.target.closest(".dropdown-portal,.clickable")||(this.showCitySelector=this.showWeekSelector=!1)})}async init(){if(!await this.checkDatabaseInitialized()){this.showSetupNotification();return}this.pendingSync=JSON.parse(localStorage.getItem("planner_pending_sync")||"[]"),this.currentWeek=this.getCurrentIsoWeek(),this.dateRange=this.getWeekDateRange(this.parseISOWeek(this.currentWeek)),await this.loadWeek(this.currentWeek,!0),setInterval(()=>{!this.isInitializing&&this.hasSignificantChanges()&&this.saveData()},3e4),this.isOnline&&this.syncPendingData()}async checkDatabaseInitialized(){try{const e=await this.pb.collection("templates").getFirstListItem("is_default=true");return!0}catch{return!1}}showSetupNotification(){const e=document.createElement("div");e.className="setup-notification",e.innerHTML=`
      <span>Database not initialized</span>
      <button onclick="window.plannerStore.showSetupModal = true">Setup</button>
    `,document.body.appendChild(e)}async fetchTemplate(e="default"){const t=`template_${e}`;try{const n=localStorage.getItem(t);if(n)return JSON.parse(n)}catch{localStorage.removeItem(t)}if(!this.isOnline)return this.showMessage("Offline: Using fallback template"),this.getFallbackTemplate();try{const n=e==="default"?"is_default=true":`name="${e}"`,r=await this.pb.collection("templates").getFirstListItem(n);return localStorage.setItem(t,JSON.stringify(r)),r}catch{return this.showMessage("Template error: Using fallback"),this.getFallbackTemplate()}}getFallbackTemplate(){return{id:"fallback",name:"fallback",structure:{prayer_times:[{label:"Q",value:""},{label:"F",value:""},{label:"D",value:""},{label:"A",value:""},{label:"M",value:""},{label:"I",value:""}],schedule:[{name:"TOTAL",activities:[{name:"DAILY POINTS",max_per_day:0,max_score:0}]}],tasks:{count:5,fields:["num","priority","tag","description","start_date","expected_date","actual_date","completed"]},workout:[],meals:[],grocery:{categories:[]},measurements:[],financials:[],city_default:"London"}}}applyTemplateStructure(e){var n,r;this.currentTemplate=e,this.currentTemplateId=e.id;const t=e.structure;this.plannerTitle=t.title_default||"Weekly Planner",this.times=[...t.prayer_times||[]],this.schedule=this.buildScheduleFromTemplate(t.schedule||[]),this.tasks=Array(((n=t.tasks)==null?void 0:n.count)||15).fill().map(()=>({id:lt(),priority:"",tag:"",description:"",startDate:"",expectedDate:"",actualDate:"",completed:""})),this.workoutPlan=this.buildWorkoutFromTemplate(t.workout||[]),this.meals=this.ensureIds([...t.meals||[]]),this.groceryList=this.ensureIds([...((r=t.grocery)==null?void 0:r.categories)||[]]),this.bodyMeasurements=this.ensureIds([...t.measurements||[]]),this.financials=this.ensureIds([...t.financials||[]]),this.city=t.city_default||"London"}buildScheduleFromTemplate(e){return e.map(t=>({id:lt(),name:t.name,activities:(t.activities||[]).map(n=>({id:lt(),name:n.name,days:this.createDaysStructure(n.days,n.max_per_day||1),score:0,maxScore:n.max_score||0,streaks:{current:0,longest:0}}))}))}createDaysStructure(e,t){const n=["mon","tue","wed","thu","fri","sat","sun"],r={};return(e&&Array.isArray(e)?e:n).forEach(a=>{r[a]={value:"",max:t}}),r}buildWorkoutFromTemplate(e){return e.map(t=>({id:lt(),name:t.name,exercises:this.ensureIds((t.exercises||[]).map(n=>{var r,i,a;return{prefix:"â¢ ",name:n.name,weight:"",sets:"",reps:"",defaultWeight:((r=n.default_weight)==null?void 0:r.toString())||"",defaultSets:((i=n.default_sets)==null?void 0:i.toString())||"",defaultReps:((a=n.default_reps)==null?void 0:a.toString())||""}}))}))}ensureIds(e){return e.map(t=>({...t,id:t.id||lt()}))}async loadWeek(e,t=!1){if(!/^\\d{4}-W(0[1-9]|[1-4]\\d|5[0-3])$/.test(e)){this.showMessage("Invalid week format");return}this.showWeekSelector=!1,this.currentWeek=e,this.dateRange=this.getWeekDateRange(this.parseISOWeek(e));let n=await this.fetchPlannerRecord(e),r;n!=null&&n.template_id?r=await this.fetchTemplateById(n.template_id):r=await this.fetchTemplate("default"),this.applyTemplateStructure(r),n&&this.overlayUserData(n),this.calculateScores(),t&&!this.times.some(i=>i.value)&&await this.getPrayerTimes(),this.lastSavedState=JSON.stringify(this.getCurrentUserData()),t&&(this.isInitializing=!1)}async fetchPlannerRecord(e){if(this.isOnline)try{return await this.pb.collection("planners").getFirstListItem(`week_id="${e}"`)}catch{}const t=localStorage.getItem(`planner_${e}`);if(t)try{return JSON.parse(t)}catch{}return null}async fetchTemplateById(e){try{return await this.pb.collection("templates").getOne(e)}catch{return await this.fetchTemplate("default")}}overlayUserData(e){var t;e.title&&(this.plannerTitle=e.title),e.city&&(this.city=e.city),e.prayer_times&&this.overlayArray(this.times,e.prayer_times),e.schedule_data&&this.overlayComplexData(this.schedule,e.schedule_data,"name",this.overlayScheduleActivity),e.tasks_data&&this.overlayArray(this.tasks,e.tasks_data),e.workout_data&&this.overlayComplexData(this.workoutPlan,e.workout_data,"name",this.overlayWorkoutExercise),e.meals_data&&this.overlayArray(this.meals,e.meals_data),(t=e.grocery_data)!=null&&t.categories&&this.overlayArray(this.groceryList,e.grocery_data.categories),e.measurements_data&&this.overlayArray(this.bodyMeasurements,e.measurements_data),e.financials_data&&this.overlayArray(this.financials,e.financials_data)}overlayArray(e,t){t.forEach((n,r)=>{e[r]&&Object.assign(e[r],n)})}overlayComplexData(e,t,n,r){t.forEach(i=>{const a=e.find(c=>c[n]===i[n]);a&&r.call(this,a,i)})}overlayScheduleActivity(e,t){var n;(n=t.activities)==null||n.forEach(r=>{const i=e.activities.find(a=>a.name===r.name);i&&(r.days&&Object.keys(i.days).forEach(a=>{r.days[a]&&(i.days[a].value=r.days[a].value||"")}),i.score=r.score||0,i.streaks=r.streaks||{current:0,longest:0})})}overlayWorkoutExercise(e,t){var n;(n=t.exercises)==null||n.forEach(r=>{const i=e.exercises.find(a=>a.name===r.name);i&&(i.weight=r.weight||"",i.sets=r.sets||"",i.reps=r.reps||"")})}getCurrentUserData(){var e,t,n,r;return{week_id:this.currentWeek,template_id:this.currentTemplateId,title:this.plannerTitle!==((t=(e=this.currentTemplate)==null?void 0:e.structure)==null?void 0:t.title_default)?this.plannerTitle:null,city:this.city!==((r=(n=this.currentTemplate)==null?void 0:n.structure)==null?void 0:r.city_default)?this.city:null,date_range:this.dateRange,prayer_times:this.times.some(i=>i.value)?this.times:null,schedule_data:this.extractScheduleData(),tasks_data:this.extractUserTasks(),workout_data:this.extractWorkoutData(),meals_data:this.extractUserItems(this.meals,["name","ingredients"]),grocery_data:this.extractGroceryData(),measurements_data:this.extractUserItems(this.bodyMeasurements,["value"]),financials_data:this.extractUserItems(this.financials,["value"])}}extractScheduleData(){return this.extractComplexData(this.schedule,e=>({name:e.name,activities:e.activities.map(t=>({name:t.name,days:Object.keys(t.days).reduce((n,r)=>(t.days[r].value&&(n[r]={value:t.days[r].value}),n),{}),score:t.score,streaks:t.streaks})).filter(t=>Object.keys(t.days).length>0||t.score>0)}),e=>e.activities.length>0)}extractUserTasks(){return this.tasks.filter(e=>e.priority||e.tag||e.description||e.startDate||e.expectedDate||e.actualDate||e.completed)}extractWorkoutData(){return this.extractComplexData(this.workoutPlan,e=>({name:e.name,exercises:e.exercises.filter(t=>t.weight||t.sets||t.reps).map(t=>({name:t.name,weight:t.weight,sets:t.sets,reps:t.reps}))}),e=>e.exercises.length>0)}extractComplexData(e,t,n=()=>!0){return e.map(t).filter(n)}extractUserItems(e,t){return e.filter(n=>t.some(r=>n[r]))}extractGroceryData(){const e=this.extractUserItems(this.groceryList,["name","items"]);return e.length>0?{categories:e}:null}getTaskDelay(e){if(!e.expectedDate||!e.actualDate)return 0;const t=new Date(e.expectedDate),n=new Date(e.actualDate);return Math.ceil((n-t)/(1e3*60*60*24))}calculateTaskDelay(e){return e._delay=this.getTaskDelay(e),e._delay}formatDelay(e){return e===0?"0d":e>0?`+${e}d`:`${e}d`}toggleTaskCompletion(e){e.completed=e.completed==="â"?"â":"â",e.completed==="â"&&!e.actualDate&&(e.actualDate=new Date().toISOString().split("T")[0],this.calculateTaskDelay(e)),this.saveData()}toggleSelector(e,t){const n=t==="city"?"showCitySelector":"showWeekSelector",r=t==="city"?"showWeekSelector":"showCitySelector";if(this[r]=!1,this[n])this[n]=!1;else{const i=e.target.getBoundingClientRect();this[`${t}DropdownStyle`]=`position:fixed;top:${i.bottom+4}px;left:${Math.max(10,i.left-100)}px;z-index:9999;min-width:150px;max-width:250px;`,this[n]=!0,t==="week"&&this.fetchSavedWeeks()}}async selectCity(e){this.city=e.name,this.showCitySelector=!1;try{e.lat===null?await this.getPrayerTimes():await this.fetchPrayerTimes(e.lat,e.lon),this.saveData()}catch{this.showMessage("Failed to load prayer times")}}async getPrayerTimes(){var e,t,n;try{const r=await new Promise((c,o)=>navigator.geolocation.getCurrentPosition(c,o,{timeout:5e3,maximumAge:6e4})),{latitude:i,longitude:a}=r.coords;try{const o=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${i}&lon=${a}&zoom=10&accept-language=en`)).json();this.city=((e=o.address)==null?void 0:e.city)||((t=o.address)==null?void 0:t.town)||((n=o.address)==null?void 0:n.village)||"Current Location"}catch{this.city="Current Location"}await this.fetchPrayerTimes(i,a)}catch{this.showMessage("Location access failed. Using London"),this.city="London",await this.fetchPrayerTimes(51.5074,-.1278)}}async fetchPrayerTimes(e,t){var c,o;const n=new Date,i=`prayer_times_${`${n.getFullYear()}_${n.getMonth()+1}_${n.getDate()}`}_${e.toFixed(2)}_${t.toFixed(2)}`,a=localStorage.getItem(i);if(a)try{this.setPrayerTimes(JSON.parse(a));return}catch{localStorage.removeItem(i)}try{const u=await fetch(`https://api.aladhan.com/v1/calendar/${n.getFullYear()}/${n.getMonth()+1}?latitude=${e}&longitude=${t}&method=2`);if(!u.ok)throw new Error(`API error: ${u.status}`);const h=await u.json();if(h.code===200&&((o=(c=h.data)==null?void 0:c[n.getDate()-1])!=null&&o.timings))localStorage.setItem(i,JSON.stringify(h.data[n.getDate()-1].timings)),this.setPrayerTimes(h.data[n.getDate()-1].timings);else throw new Error("Invalid prayer time data")}catch{this.showMessage("Prayer times fetch failed"),this.setPrayerTimes({Fajr:"05:30",Dhuhr:"12:30",Asr:"15:45",Maghrib:"18:30",Isha:"20:00"})}}setPrayerTimes(e){const t={Q:this.calculateQiyamTime(e.Fajr),F:e.Fajr,D:e.Dhuhr,A:e.Asr,M:e.Maghrib,I:e.Isha};this.times.reduce((r,i)=>{const a=this.formatTime(t[i.label]);return i.value!==a?(i.value=a,!0):r},!1)&&!this.isInitializing&&this.saveData()}formatTime(e){if(!e)return"";const[t,n]=e.split(" ")[0].split(":"),r=parseInt(t),i=parseInt(n);return isNaN(r)||isNaN(i)?"":`${r%12||12}:${i.toString().padStart(2,"0")}${r>=12?"PM":"AM"}`}calculateQiyamTime(e){if(!e)return"";const[t,n]=e.split(" ")[0].split(":");let r=parseInt(t),i=parseInt(n);return isNaN(r)||isNaN(i)?"":(r=r-1,r<0&&(r=23),`${r}:${i.toString().padStart(2,"0")}`)}calculateScores(){var r;const e={mon:0,tue:0,wed:0,thu:0,fri:0,sat:0,sun:0},t=Object.keys(e);this.schedule.forEach(i=>{i.name!=="TOTAL"&&i.activities.forEach(a=>{let c=0;Object.entries(a.days||{}).forEach(([h,d])=>{if(!d)return;const f=parseInt(d.value)||0;f>0&&(d.max||0)>0&&(e[h]+=f,c+=f),d.value=f===0?"":f.toString()}),a.score=c,a.streaks=a.streaks||{current:0,longest:0};const o=this.currentDay===0?6:this.currentDay-1;let u=0;for(let h=0;h<7;h++){const d=(o-h+7)%7,f=t[d];if(a.days[f]&&parseInt(a.days[f].value)>0&&(a.days[f].max||0)>0)u++;else break}a.streaks.current=u,a.streaks.longest=Math.max(a.streaks.longest||0,u)})});const n=this.schedule.find(i=>i.name==="TOTAL");if((r=n==null?void 0:n.activities)!=null&&r[0]){const i=n.activities[0];let a=0,c=0;Object.entries(e).forEach(([o,u])=>{var h;(h=i.days)!=null&&h[o]&&(i.days[o].value=u.toString()),a+=u}),this.schedule.forEach(o=>{o.name!=="TOTAL"&&o.activities.forEach(u=>c+=u.maxScore||0)}),i.score=a,i.maxScore=c}}validateAndSave(e){const t=e.target,n=parseFloat(t.min),r=parseFloat(t.max);let i=parseFloat(t.value);isNaN(i)&&(i=0),!isNaN(n)&&i<n&&(i=n),!isNaN(r)&&i>r&&(i=r),t.value=i===0?"":i.toString(),this.calculateScores(),this.saveData()}saveData(){this.isInitializing||(clearTimeout(this.saveTimeout),this.saveStatus="saving",this.saveTimeout=setTimeout(async()=>{try{this.calculateScores();const e=this.getCurrentUserData();localStorage.setItem(`planner_${this.currentWeek}`,JSON.stringify(e)),this.isOnline?(await this.saveToPocketbase(this.currentWeek,e),this.pendingSync=this.pendingSync.filter(t=>!(t.weekId===this.currentWeek&&t.operation!=="delete"))):this.addToPendingSync(this.currentWeek,e),localStorage.setItem("planner_pending_sync",JSON.stringify(this.pendingSync)),this.lastSavedState=JSON.stringify(e),this.saveStatus="saved"}catch(e){this.saveStatus="error",this.showMessage("Save error: "+e.message),setTimeout(()=>this.saveStatus="saved",3e3)}},500))}hasSignificantChanges(){if(!this.lastSavedState)return!0;const e=this.getCurrentUserData();return JSON.stringify(e)!==this.lastSavedState}addToPendingSync(e,t,n="save"){this.pendingSync=this.pendingSync.filter(r=>!(r.weekId===e&&r.operation===n)),this.pendingSync.push({weekId:e,data:t?JSON.parse(JSON.stringify(t)):null,operation:n,timestamp:new Date().toISOString()}),localStorage.setItem("planner_pending_sync",JSON.stringify(this.pendingSync))}async syncPendingData(){if(!this.isOnline||this.pendingSync.length===0)return;const e=[...this.pendingSync];this.pendingSync=[];for(const t of e)try{t.operation==="delete"?await this.deleteFromPocketbase(t.weekId):await this.saveToPocketbase(t.weekId,t.data);const n=JSON.parse(localStorage.getItem("planner_pending_sync")||"[]");localStorage.setItem("planner_pending_sync",JSON.stringify(n.filter(r=>r.timestamp!==t.timestamp)))}catch{this.pendingSync.push(t)}this.pendingSync.length>0&&localStorage.setItem("planner_pending_sync",JSON.stringify(this.pendingSync))}async saveToPocketbase(e,t){try{const n=await this.pb.collection("planners").getFirstListItem(`week_id="${e}"`);await this.pb.collection("planners").update(n.id,t)}catch(n){if(n.status===404)await this.pb.collection("planners").create(t);else throw n}}async deleteFromPocketbase(e){try{const t=await this.pb.collection("planners").getFirstListItem(`week_id="${e}"`);await this.pb.collection("planners").delete(t.id)}catch(t){if(t.status!==404)throw t}}async fetchSavedWeeks(){const e=new Map,t=this.getCurrentIsoWeek(),n=(r,i,a,c)=>{const o=e.get(r),u=i||this.getWeekDateRange(this.parseISOWeek(r));!o||a==="pocketbase"&&o.source!=="pocketbase"||a==="local"&&o.source==="current"?e.set(r,{iso_week:r,dateRange:u,source:a,isCurrent:c}):o&&!o.dateRange&&u&&(o.dateRange=u)};if(n(t,this.getWeekDateRange(this.parseISOWeek(t)),"current",!0),this.isOnline)try{(await this.pb.collection("planners").getFullList({sort:"-week_id",fields:"week_id,date_range"})).forEach(i=>n(i.week_id,i.date_range,"pocketbase",i.week_id===t))}catch{}for(let r=0;r<localStorage.length;r++){const i=localStorage.key(r);if(i.startsWith("planner_")&&!i.includes("pending_sync")&&!i.startsWith("planner_template_")){const a=i.replace("planner_","");try{const c=JSON.parse(localStorage.getItem(i));n(a,c.date_range,"local",a===t)}catch{}}}this.savedWeeks=Array.from(e.values()).sort((r,i)=>r.isCurrent&&!i.isCurrent?-1:!r.isCurrent&&i.isCurrent?1:i.iso_week.localeCompare(r.iso_week))}confirmLoadWeek(e){this.hasSignificantChanges()&&e!==this.currentWeek&&!confirm("Unsaved changes. Load anyway?")||(this.showWeekSelector=!1,this.loadWeek(e))}confirmDeleteWeek(e){confirm(`Delete schedule for ${e}?`)&&this.deleteWeek(e)}async deleteWeek(e){if(localStorage.removeItem(`planner_${e}`),this.isOnline)try{await this.deleteFromPocketbase(e)}catch{this.addToPendingSync(e,null,"delete")}else this.addToPendingSync(e,null,"delete");this.savedWeeks=this.savedWeeks.filter(t=>t.iso_week!==e),this.currentWeek===e&&(this.currentWeek=this.getCurrentIsoWeek(),await this.loadWeek(this.currentWeek))}getCurrentIsoWeek(){const e=new Date,t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()));t.setUTCDate(t.getUTCDate()+4-(t.getUTCDay()||7));const n=new Date(Date.UTC(t.getUTCFullYear(),0,1)),r=Math.ceil(((t-n)/864e5+1)/7);return`${t.getUTCFullYear()}-W${r.toString().padStart(2,"0")}`}parseISOWeek(e){if(!/^\\d{4}-W(0[1-9]|[1-4]\\d|5[0-3])$/.test(e))return new Date;const[t,n]=e.split("-"),r=parseInt(n.substring(1)),i=new Date(Date.UTC(parseInt(t),0,1+(r-1)*7));return i.setUTCDate(i.getUTCDate()-(i.getUTCDay()||7)+1),i}getWeekDateRange(e){const t=new Date(e),n=new Date(t);return n.setUTCDate(t.getUTCDate()+6),`${this.formatDate(t)}-${this.formatDate(n)}`}formatDate(e){return`${(e.getUTCMonth()+1).toString().padStart(2,"0")}/${e.getUTCDate().toString().padStart(2,"0")}`}showMessage(e){this.notificationMessage=e,this.showNotification=!0,clearTimeout(this.notificationTimeout),this.notificationTimeout=setTimeout(()=>this.showNotification=!1,5e3)}}vt=new WeakMap,mt=new WeakMap,gt=new WeakMap,_t=new WeakMap,yt=new WeakMap,bt=new WeakMap,wt=new WeakMap,St=new WeakMap,kt=new WeakMap,Tt=new WeakMap,Ct=new WeakMap,xt=new WeakMap,Ot=new WeakMap,Dt=new WeakMap,It=new WeakMap,Et=new WeakMap,Pt=new WeakMap,At=new WeakMap,Rt=new WeakMap,Lt=new WeakMap,Nt=new WeakMap,Ut=new WeakMap,jt=new WeakMap,$t=new WeakMap,qt=new WeakMap,Ft=new WeakMap,Mt=new WeakMap,Wt=new WeakMap;const p=new Ei;window.plannerStore=p;var Pi=()=>p.saveData(),Ai=I('<div class="flex center"><span> </span> <input type="text" class="input input--time"/></div>'),Ri=s=>p.toggleSelector(s,"city"),Li=s=>p.toggleSelector(s,"week"),Ni=I('<div class="flex between center mb-1"><h1 class="text-sm bold"> </h1> <div class="flex center text-xs"><!> <span class="ml-1">|</span> <span class="clickable ml-1"> </span></div> <div class="text-sm"><span class="clickable"> </span> <span> </span></div></div>');function Ui(s,e){me(e,!1),xe();var t=Ni(),n=v(t),r=v(n),i=_(n,2),a=v(i);ie(a,1,()=>(R(p),y(()=>p.times)),Je,(g,w,b)=>{var k=Ai(),P=v(k),O=v(P),C=_(P,2);C.__change=[Pi],U(()=>L(O,`${l(w),y(()=>l(w).label)??""}:`)),le(C,()=>l(w).value,E=>(l(w).value=E,re(()=>p))),x(g,k)});var c=_(a,4);c.__click=[Ri];var o=v(c),u=_(i,2),h=v(u);h.__click=[Li];var d=v(h),f=_(h,2),m=v(f);U(()=>{L(r,(R(p),y(()=>p.plannerTitle))),L(o,(R(p),y(()=>p.city))),L(d,(R(p),y(()=>p.currentWeek))),L(m,(R(p),y(()=>p.dateRange)))}),x(s,t),ge()}ze(["change","click"]);var ji=I("<th> </th> <th>MAX</th>",1),$i=s=>p.validateAndSave(s),qi=I('<input type="number" class="input" min="0"/>'),Fi=I("<td><!></td> <td> </td>",1),Mi=I("<span> </span>"),Wi=I('<tr><td class="bold"> </td><td class="bold"> </td><td class="ac"><span> </span></td><!><td class="dc"><input type="number" class="input" readonly=""/></td><td class="dc"> </td><td><!></td></tr>'),Bi=I('<tr><td colspan="19" class="progress"><div></div></td></tr>'),Ki=I("<!> <!>",1),Ji=I('<table><thead><tr><th style="width:18mm">T</th><th style="width:20mm">D</th><th class="ac">ACTIVITY</th><!><th class="dc">ð</th><th class="dc">ð¯</th><th class="dc">ð¥</th></tr></thead><tbody></tbody></table>');function Hi(s,e){me(e,!1);const t=["M","T","W","T","F","S","S"],n=["mon","tue","wed","thu","fri","sat","sun"];xe();var r=Ji(),i=v(r),a=v(i),c=_(v(a),3);ie(c,1,()=>t,Je,(u,h,d)=>{var f=ji(),m=je(f);let g;var w=v(m),b=_(m,2);let k;U((P,O)=>{g=X(m,1,"dc",null,g,P),L(w,l(h)),k=X(b,1,"dc",null,k,O)},[()=>({"current-day":d===(p.currentDay||7)-1}),()=>({"current-day":d===(p.currentDay||7)-1})],Ne),x(u,f)});var o=_(i);ie(o,5,()=>(R(p),y(()=>[...p.schedule].reverse())),Je,(u,h)=>{var d=Ki(),f=je(d);ie(f,1,()=>(l(h),y(()=>l(h).activities)),Je,(w,b,k)=>{var P=Wi();let O;var C=v(P),E=v(C),M=_(C),F=v(M),ee=_(M),Oe=v(ee),ke=v(Oe),ce=_(ee);ie(ce,1,()=>n,Je,(se,q,Ce)=>{var B=Fi(),A=je(B);let W;var K=v(A);{var ue=te=>{var G=qi();G.__input=[$i],U(()=>{He(G,"max",(l(b),l(q),y(()=>l(b).days[l(q)].max<10?9:99))),G.readOnly=(l(h),y(()=>l(h).name==="TOTAL"))}),le(G,()=>l(b).days[l(q)].value,de=>(l(b).days[l(q)].value=de,re(()=>(l(h),p)))),x(te,G)};z(K,te=>{l(b),l(q),y(()=>l(b).days&&l(b).days[l(q)])&&te(ue)})}var Q=_(A,2);let H;var ae=v(Q);U((te,G)=>{W=X(A,1,"dc",null,W,te),H=X(Q,1,"dc",null,H,G),L(ae,(l(b),l(q),y(()=>{var de,Y;return((Y=(de=l(b).days)==null?void 0:de[l(q)])==null?void 0:Y.max)||""})))},[()=>({"current-day":Ce===(p.currentDay||7)-1}),()=>({"current-day":Ce===(p.currentDay||7)-1})],Ne),x(se,B)});var _e=_(ce),Me=v(_e),Te=_(_e),De=v(Te),Ie=_(Te);let Le;var Ee=v(Ie);{var et=se=>{var q=Mi(),Ce=v(q);U(()=>L(Ce,(l(b),y(()=>l(b).streaks.current)))),x(se,q)};z(Ee,se=>{l(b),y(()=>{var q;return((q=l(b).streaks)==null?void 0:q.current)>0})&&se(et)})}U((se,q,Ce,B)=>{O=X(P,1,"",null,O,se),L(E,(l(h),y(()=>k===0?l(h).name:""))),L(F,q),L(ke,Ce),Nn(Me,(l(b),y(()=>l(b).score))),L(De,(l(b),y(()=>l(b).maxScore))),Le=X(Ie,1,"dc cell cell--color",null,Le,B)},[()=>({total:l(h).name==="TOTAL"}),()=>(l(b),y(()=>l(b).name.includes(":")?l(b).name.split(":")[0]:"")),()=>(l(b),y(()=>l(b).name.includes(":")?l(b).name.split(":")[1].trim():l(b).name)),()=>{var se,q;return{streak:((se=l(b).streaks)==null?void 0:se.current)>2,yellow:((q=l(b).streaks)==null?void 0:q.current)>2}}],Ne),x(w,P)});var m=_(f,2);{var g=w=>{var b=Bi();const k=Ne(()=>(l(h),y(()=>l(h).activities[0]))),P=Ne(()=>(R(l(k)),y(()=>l(k).maxScore>0?Math.min(100,l(k).score/l(k).maxScore*100):0))),O=Ne(()=>(R(l(k)),y(()=>l(k).maxScore>0?l(k).score/l(k).maxScore<.33?"progress--low":l(k).score/l(k).maxScore<.66?"progress--medium":"progress--high":"")));var C=v(b),E=v(C);U(()=>{X(E,1,`progress__bar ${l(O)??""}`),is(E,`width: ${l(P)??""}%`)}),x(w,b)};z(m,w=>{l(h),y(()=>{var b;return l(h).name==="TOTAL"&&((b=l(h).activities)==null?void 0:b.length)>0&&l(h).activities[0].maxScore>0})&&w(g)})}x(u,d)}),x(s,r),ge()}ze(["input"]);var Gi=()=>p.saveData(),Vi=()=>p.saveData(),zi=()=>p.saveData(),Yi=I('<tr><td class="dc"> </td><td><select class="input"><option></option><option>A</option><option>B</option><option>C</option><option>D</option></select></td><td><input type="text" class="input input--text"/></td><td><select class="input"><option></option><option>Personal</option><option>Work</option></select></td><td><input type="text" class="input input--date"/></td><td><input type="text" class="input input--date"/></td><td><span> </span></td><td><input type="text" class="input input--date"/></td><td><input type="text" placeholder="â" readonly=""/></td></tr>'),Qi=I('<div class="section"><h3 class="title">TASKS & PROJECT MANAGEMENT</h3> <table><thead><tr><th>#</th><th>â­</th><th>Task</th><th>ð·ï¸</th><th class="icon-header">Start</th><th class="icon-header">Due</th><th class="icon-header">Delay</th><th class="icon-header">Done</th><th>â</th></tr></thead><tbody></tbody></table></div>');function Xi(s,e){me(e,!1);function t(c){const o=[];c.completed==="â"&&o.push("green");const u=p.getTaskDelay(c);return u>0?o.push("red"):u<0&&o.push("blue"),o.join(" ")}function n(c){return c<0?"green":c>0?"red":"yellow"}xe();var r=Qi(),i=_(v(r),2),a=_(v(i));ie(a,7,()=>(R(p),y(()=>p.tasks)),(c,o)=>c.id||o,(c,o,u)=>{var h=Yi(),d=v(h),f=v(d),m=_(d),g=v(m);U(()=>{l(o),re(()=>{})}),g.__change=[Gi];var w=v(g);w.value=w.__value="";var b=_(w);b.value=b.__value="A";var k=_(b);k.value=k.__value="B";var P=_(k);P.value=P.__value="C";var O=_(P);O.value=O.__value="D";var C=_(m),E=v(C);E.__change=[Vi];var M=_(C),F=v(M);U(()=>{l(o),re(()=>{})}),F.__change=[zi];var ee=v(F);ee.value=ee.__value="";var Oe=_(ee);Oe.value=Oe.__value="P";var ke=_(Oe);ke.value=ke.__value="W";var ce=_(M),_e=v(ce);_e.__change=()=>{p.calculateTaskDelay(l(o)),p.saveData()};var Me=_(ce),Te=v(Me);Te.__change=()=>{p.calculateTaskDelay(l(o)),p.saveData()};var De=_(Me),Ie=v(De),Le=v(Ie),Ee=_(De),et=v(Ee);et.__change=()=>{p.calculateTaskDelay(l(o)),p.saveData()};var se=_(Ee),q=v(se);let Ce;q.__click=B=>{B.preventDefault(),p.toggleTaskCompletion(l(o))},U((B,A,W,K)=>{X(h,1,B),L(f,l(u)+1),X(De,1,`dc cell cell--bold ${A??""}`),L(Le,W),Ce=X(q,1,"input",null,Ce,K),Nn(q,(l(o),y(()=>l(o).completed)))},[()=>ti((l(o),y(()=>t(l(o))))),()=>(R(p),l(o),y(()=>n(p.getTaskDelay(l(o))))),()=>(R(p),l(o),y(()=>p.formatDelay(p.getTaskDelay(l(o))))),()=>({"task-done":l(o).completed==="â"})],Ne),zs(g,()=>l(o).priority,B=>(l(o).priority=B,re(()=>p))),le(E,()=>l(o).description,B=>(l(o).description=B,re(()=>p))),zs(F,()=>l(o).tag,B=>(l(o).tag=B,re(()=>p))),le(_e,()=>l(o).startDate,B=>(l(o).startDate=B,re(()=>p))),le(Te,()=>l(o).expectedDate,B=>(l(o).expectedDate=B,re(()=>p))),le(et,()=>l(o).actualDate,B=>(l(o).actualDate=B,re(()=>p))),x(c,h)}),x(s,r),ge()}ze(["change","click"]);var Zi=()=>p.saveData(),ea=()=>p.saveData(),ta=()=>p.saveData(),sa=I('<div class="exercise"><div class="exercise-name"><span> </span> <span> </span>:</div> <div class="exercise-inputs"><input type="number" class="input"/> <span class="exercise-unit">kg,</span> <input type="number" class="input sets"/> <span class="exercise-unit">Ã</span> <input type="number" class="input reps"/></div></div>'),na=I('<div class="p-1 workout-day-card"><p class="bold text-center mb-1 workout-day-name"> </p> <!></div>'),ra=I('<div class="section"><h3 class="title">WORKOUT</h3> <div class="grid"></div></div>');function ia(s,e){me(e,!1),xe();var t=ra(),n=_(v(t),2);ie(n,5,()=>(R(p),y(()=>p.workoutPlan)),r=>r.id,(r,i)=>{var a=na(),c=v(a),o=v(c),u=_(c,2);ie(u,1,()=>(l(i),y(()=>l(i).exercises)),h=>h.id,(h,d,f)=>{var m=sa(),g=v(m),w=v(g),b=v(w),k=_(w,2),P=v(k),O=_(g,2),C=v(O);C.__input=[Zi];var E=_(C,4);E.__input=[ea];var M=_(E,4);M.__input=[ta],U(()=>{He(g,"title",`${l(d),y(()=>l(d).prefix)??""}${l(d),y(()=>l(d).name)??""}`),L(b,(l(d),y(()=>l(d).prefix))),L(P,(l(d),y(()=>l(d).name))),He(C,"placeholder",(l(d),y(()=>l(d).defaultWeight))),He(E,"placeholder",(l(d),y(()=>l(d).defaultSets))),He(M,"placeholder",(l(d),y(()=>l(d).defaultReps)))}),le(C,()=>l(d).weight,F=>(l(d).weight=F,re(()=>(l(i),p)))),le(E,()=>l(d).sets,F=>(l(d).sets=F,re(()=>(l(i),p)))),le(M,()=>l(d).reps,F=>(l(d).reps=F,re(()=>(l(i),p)))),x(h,m)}),U(()=>L(o,(l(i),y(()=>l(i).name)))),x(r,a)}),x(s,t),ge()}ze(["input"]);var aa=I('<div class="mb-05"><span class="bold"> </span> <span> </span></div>'),oa=I('<div class="section"><h3 class="title">MEALS</h3> <div class="text-xs"></div></div>');function la(s,e){me(e,!1),xe();var t=oa(),n=_(v(t),2);ie(n,5,()=>(R(p),y(()=>p.meals)),r=>r.id,(r,i)=>{var a=aa(),c=v(a),o=v(c),u=_(c,2),h=v(u);U(()=>{L(o,`${l(i),y(()=>l(i).name)??""}:`),L(h,(l(i),y(()=>l(i).ingredients)))}),x(r,a)}),x(s,t),ge()}var ca=I('<div class="mb-05"><span class="bold"> </span> <span> </span></div>'),ua=I('<div class="section"><h3 class="title">GROCERY</h3> <div class="text-xs"></div></div>');function da(s,e){me(e,!1),xe();var t=ua(),n=_(v(t),2);ie(n,5,()=>(R(p),y(()=>p.groceryList)),r=>r.id,(r,i)=>{var a=ca(),c=v(a),o=v(c),u=_(c,2),h=v(u);U(()=>{L(o,`${l(i),y(()=>l(i).name)??""}:`),L(h,(l(i),y(()=>l(i).items)))}),x(r,a)}),x(s,t),ge()}var ha=()=>p.saveData(),fa=I('<span><span> </span> <input type="text" class="input input--inline"/> <!></span>'),pa=I('<div class="section"><h3 class="title">BODY</h3> <div class="text-xs"></div></div>');function va(s,e){me(e,!1),xe();var t=pa(),n=_(v(t),2);ie(n,7,()=>(R(p),y(()=>p.bodyMeasurements)),r=>r.id,(r,i,a)=>{var c=fa(),o=v(c),u=v(o),h=_(o,2);h.__change=[ha];var d=_(h,2);{var f=m=>{var g=rs(",");x(m,g)};z(d,m=>{R(l(a)),R(p),y(()=>l(a)<p.bodyMeasurements.length-1)&&m(f)})}U(()=>{L(u,`${l(i),y(()=>l(i).name)??""}:`),He(h,"placeholder",(l(i),y(()=>l(i).placeholder)))}),le(h,()=>l(i).value,m=>(l(i).value=m,re(()=>p))),x(r,c)}),x(s,t),ge()}ze(["change"]);var ma=()=>p.saveData(),ga=I('<span><span> </span> Â£<input type="text" class="input input--inline"/> <span> </span> <!></span>'),_a=I('<div class="section"><h3 class="title">FINANCIAL</h3> <div class="text-xs"></div></div>');function ya(s,e){me(e,!1),xe();var t=_a(),n=_(v(t),2);ie(n,7,()=>(R(p),y(()=>p.financials)),r=>r.id,(r,i,a)=>{var c=ga(),o=v(c),u=v(o),h=_(o,2);h.__change=[ma];var d=_(h,2),f=v(d),m=_(d,2);{var g=w=>{var b=rs(",");x(w,b)};z(m,w=>{R(l(a)),R(p),y(()=>l(a)<p.financials.length-1)&&w(g)})}U(()=>{L(u,`${l(i),y(()=>l(i).name)??""}:`),He(h,"placeholder",(l(i),y(()=>l(i).placeholder))),L(f,(l(i),y(()=>l(i).account)))}),le(h,()=>l(i).value,w=>(l(i).value=w,re(()=>p))),x(r,c)}),x(s,t),ge()}ze(["change"]);var ba=I('<div id="sync-status"><span> </span></div>'),wa=I('<div id="notification" class="notification notification--show"> </div>'),Sa=I('<div id="save-status"> </div> <!> <!>',1);function ka(s,e){me(e,!1),xe();var t=Sa(),n=je(t),r=v(n),i=_(n,2);{var a=u=>{var h=ba(),d=v(h),f=v(d);U(()=>{X(h,1,`status status--sync ${R(p),y(()=>p.pendingSync.length>0?"status-pending":"status-synced")??""}`),L(f,(R(p),y(()=>p.isOnline?p.pendingSync.length>0?"Pending: "+p.pendingSync.length:"":"Offline")))}),x(u,h)};z(i,u=>{R(p),y(()=>p.pendingSync.length>0||!p.isOnline)&&u(a)})}var c=_(i,2);{var o=u=>{var h=wa(),d=v(h);U(()=>L(d,(R(p),y(()=>p.notificationMessage)))),x(u,h)};z(c,u=>{R(p),y(()=>p.showNotification)&&u(o)})}U(()=>{X(n,1,`status status--save status-${R(p),y(()=>p.saveStatus)??""}`),L(r,(R(p),y(()=>p.saveStatus==="saving"?"Saving...":p.saveStatus==="error"?"Error!":"Saved")))}),x(s,t),ge()}var Ta=(s,e)=>p.selectCity(l(e)),Ca=I('<div class="dropdown__item"> </div>'),xa=I('<div class="dropdown-portal"><div class="dropdown__content"></div></div>'),Oa=(s,e)=>p.confirmLoadWeek(l(e).iso_week),Da=(s,e)=>p.confirmDeleteWeek(l(e).iso_week),Ia=I('<div><span> </span> <span class="dropdown__delete">Ã</span></div>'),Ea=I('<div class="dropdown__item--empty">No saved schedules</div>'),Pa=I('<div class="dropdown-portal"><div class="dropdown__content"><!></div></div>'),Aa=I("<!> <!>",1);function Ra(s,e){me(e,!1),xe();var t=Aa(),n=je(t);{var r=c=>{var o=xa(),u=v(o);ie(u,5,()=>(R(p),y(()=>p.cityOptions)),Je,(h,d)=>{var f=Ca();f.__click=[Ta,d];var m=v(f);U(()=>L(m,(l(d),y(()=>l(d).name)))),x(h,f)}),U(()=>is(o,(R(p),y(()=>p.cityDropdownStyle)))),x(c,o)};z(n,c=>{R(p),y(()=>p.showCitySelector)&&c(r)})}var i=_(n,2);{var a=c=>{var o=Pa(),u=v(o),h=v(u);{var d=m=>{var g=Hr(),w=je(g);ie(w,1,()=>(R(p),y(()=>p.savedWeeks)),Je,(b,k)=>{var P=Ia();let O;var C=v(P);C.__click=[Oa,k];var E=v(C),M=_(C,2);M.__click=[Da,k],U(F=>{O=X(P,1,"flex between center dropdown__item",null,O,F),L(E,`${l(k),y(()=>l(k).iso_week)??""} ${l(k),y(()=>l(k).dateRange)??""}`)},[()=>({"dropdown__item--current":l(k).isCurrent})],Ne),x(b,P)}),x(m,g)},f=m=>{var g=Ea();x(m,g)};z(h,m=>{R(p),y(()=>p.savedWeeks.length>0)?m(d):m(f,!1)})}U(()=>is(o,(R(p),y(()=>p.weekDropdownStyle)))),x(c,o)};z(i,c=>{R(p),y(()=>p.showWeekSelector)&&c(a)})}x(s,t),ge()}ze(["click"]);async function La(s,e,t,n,r){S(e,!0),S(t,"");try{(await fetch(`${l(n)}/api/health`)).ok?(S(t,"success"),S(r,2)):S(t,"error")}catch{S(t,"error")}finally{S(e,!1)}}var Na=(s,e)=>s.target===s.currentTarget&&e(),Ua=I('<div><span class="setup-step-num svelte-1gw615y"> </span> <span class="setup-step-name text-xs svelte-1gw615y"> </span></div>'),ja=I('<span class="text-xs ml-1 green svelte-1gw615y">â Connected</span>'),$a=I('<span class="text-xs ml-1 red svelte-1gw615y">â Connection failed</span>'),qa=I('<div class="setup-section svelte-1gw615y"><h2 class="svelte-1gw615y">Step 1: PocketBase URL</h2> <p class="text-xs mb-05 svelte-1gw615y">Enter your PocketBase server URL</p> <input type="url" class="input input--text" placeholder="http://localhost:8090"/> <div class="flex center mt-1 svelte-1gw615y"><button> </button> <!></div></div>'),Fa=(s,e)=>S(e,!l(e)),Ma=I('<div class="setup-section svelte-1gw615y"><h2 class="svelte-1gw615y">Step 2: Admin Credentials</h2> <p class="text-xs mb-05 svelte-1gw615y">Enter your PocketBase admin credentials</p> <div class="mb-05 svelte-1gw615y"><input type="email" class="input input--text" placeholder="admin@example.com"/></div> <div class="mb-05 svelte-1gw615y" style="position: relative;"><input class="input input--text" placeholder="Password"/> <button class="setup-pass-toggle svelte-1gw615y"> </button></div> <button> </button></div>'),Wa=I('<div class="setup-section svelte-1gw615y"><h2 class="svelte-1gw615y">Step 3: Create Collections</h2> <p class="text-xs mb-05 svelte-1gw615y">Create required database collections</p> <div class="setup-collections svelte-1gw615y"><div class="text-xs mb-05 svelte-1gw615y">â¢ templates - Store planner templates</div> <div class="text-xs mb-05 svelte-1gw615y">â¢ planners - Store weekly planner data</div></div> <button> </button></div>'),Ba=I('<div class="progress mb-05 svelte-1gw615y"><div class="progress__bar progress--high"></div></div> <p class="text-xs"> </p>',1),Ka=I('<div class="text-xs mb-05 svelte-1gw615y"><!> Default template</div> <button>Seed Database</button>',1),Ja=I('<div class="setup-section svelte-1gw615y"><h2 class="svelte-1gw615y">Step 4: Seed Database</h2> <p class="text-xs mb-05 svelte-1gw615y">Initialize database with default template</p> <!></div>'),Ha=I('<div class="setup-section svelte-1gw615y"><h2 class="svelte-1gw615y">â Setup Complete!</h2> <p class="text-xs mb-05 svelte-1gw615y">Your A4 Planner database is ready to use.</p> <button class="svelte-1gw615y">Start Using Planner</button></div>'),Ga=I('<div class="setup-modal-overlay svelte-1gw615y"><div class="setup-modal-content svelte-1gw615y"><div class="setup-container svelte-1gw615y"><div class="flex between center mb-1 svelte-1gw615y"><h1 class="text-sm bold">A4 Planner - Database Setup</h1> <button class="clickable svelte-1gw615y">Ã</button></div> <div class="setup-steps svelte-1gw615y"><div class="flex center mb-1 svelte-1gw615y"></div></div> <!> <!> <!> <!> <!> <div class="setup-help mt-1 svelte-1gw615y"><details class="svelte-1gw615y"><summary class="text-xs bold svelte-1gw615y">Help & Documentation</summary> <div class="text-xs mt-05 svelte-1gw615y"><h3 class="bold mb-05 svelte-1gw615y">Prerequisites:</h3> <p class="mb-05 svelte-1gw615y">1. PocketBase server running and accessible</p> <p class="mb-05 svelte-1gw615y">2. Admin account created in PocketBase</p> <h3 class="bold mb-05 mt-1 svelte-1gw615y">Setup Steps:</h3> <p class="mb-05 svelte-1gw615y">1. <b>PocketBase URL:</b> Enter the URL where your PocketBase is running (e.g., http://localhost:8090)</p> <p class="mb-05 svelte-1gw615y">2. <b>Admin Credentials:</b> Use your PocketBase admin email and password</p> <p class="mb-05 svelte-1gw615y">3. <b>Create Collections:</b> This creates the database structure</p> <p class="mb-05 svelte-1gw615y">4. <b>Seed Database:</b> Adds the default template</p> <h3 class="bold mb-05 mt-1 svelte-1gw615y">Troubleshooting:</h3> <p class="mb-05 svelte-1gw615y">â¢ <b>Connection failed:</b> Check if PocketBase is running and the URL is correct</p> <p class="mb-05 svelte-1gw615y">â¢ <b>Authentication failed:</b> Verify your admin credentials</p> <p class="mb-05 svelte-1gw615y">â¢ <b>Collection exists:</b> Collections may already be created</p></div></details></div></div></div></div>');function Va(s,e){me(e,!0);let t=D(V(window.location.origin)),n=D("admin@example.com"),r=D(""),i=D(!1),a=D(1),c=D(""),o=D(!1),u=D(!1),h=D(!1),d=D(0),f=D(""),m=V({templates:!1,planners:!1});const g=[{num:1,name:"PocketBase URL"},{num:2,name:"Admin Credentials"},{num:3,name:"Create Collections"},{num:4,name:"Seed Database"},{num:5,name:"Complete"}];function w(){p.showSetupModal=!1;const A=document.querySelector(".setup-notification");A&&A.remove()}async function b(){S(o,!0);try{p.pb.baseURL=l(t),await p.pb.admins.authWithPassword(l(n),l(r)),S(a,3)}catch(A){alert("Authentication failed: "+A.message)}finally{S(o,!1)}}async function k(){S(o,!0);try{try{await p.pb.collections.getOne("templates")}catch(A){A.status===404&&await p.pb.collections.create(C())}try{await p.pb.collections.getOne("planners")}catch(A){A.status===404&&await p.pb.collections.create(E())}S(a,4)}catch(A){alert("Failed to create collections: "+A.message)}finally{S(o,!1)}}async function P(){S(h,!0),S(d,0);try{S(f,"Seeding templates..."),S(d,33),(await p.pb.collection("templates").getFullList()).length===0&&(await p.pb.collection("templates").create(M()),m.templates=!0),S(d,66),S(f,"Database seeded successfully"),S(a,5),S(d,100)}catch(A){alert("Failed to seed database: "+A.message),S(f,"Error: "+A.message)}finally{S(h,!1)}}async function O(){w(),await p.init()}function C(){return{name:"templates",type:"base",schema:[{name:"name",type:"text",required:!0,options:{min:1,max:50}},{name:"is_default",type:"bool"},{name:"structure",type:"json",required:!0}],indexes:["CREATE UNIQUE INDEX idx_templates_name ON templates (name)"]}}function E(){return{name:"planners",type:"base",schema:[{name:"week_id",type:"text",required:!0,options:{min:8,max:8,pattern:"^\\d{4}-W(0[1-9]|[1-4]\\d|5[0-3])$"}},{name:"template_id",type:"relation",required:!0,options:{collectionId:"templates",cascadeDelete:!1,maxSelect:1}},{name:"title",type:"text",options:{max:100}},{name:"city",type:"text",options:{max:50}},{name:"date_range",type:"text",options:{max:20}},{name:"prayer_times",type:"json"},{name:"schedule_data",type:"json"},{name:"tasks_data",type:"json"},{name:"workout_data",type:"json"},{name:"meals_data",type:"json"},{name:"grocery_data",type:"json"},{name:"measurements_data",type:"json"},{name:"financials_data",type:"json"}],indexes:["CREATE UNIQUE INDEX idx_planners_week ON planners (week_id)"]}}function M(){return{name:"default",is_default:!0,structure:{title_default:"Weekly Planner",city_default:"London",prayer_times:[{label:"Q",value:""},{label:"F",value:""},{label:"D",value:""},{label:"A",value:""},{label:"M",value:""},{label:"I",value:""}],schedule:[{name:"HABITS",activities:[{name:"Q: Quran",max_per_day:5,max_score:35},{name:"P: Prayer",max_per_day:5,max_score:35},{name:"E: Exercise",max_per_day:1,max_score:7},{name:"R: Read",max_per_day:1,max_score:7},{name:"L: Learn",max_per_day:1,max_score:7}]},{name:"TOTAL",activities:[{name:"DAILY POINTS",max_per_day:0,max_score:0}]}],tasks:{count:15,fields:["num","priority","tag","description","start_date","expected_date","actual_date","completed"]},workout:[{name:"PUSH",exercises:[{name:"Bench Press",default_weight:60,default_sets:4,default_reps:8},{name:"Shoulder Press",default_weight:40,default_sets:3,default_reps:10},{name:"Dips",default_weight:0,default_sets:3,default_reps:12}]},{name:"PULL",exercises:[{name:"Deadlift",default_weight:80,default_sets:4,default_reps:6},{name:"Pull-ups",default_weight:0,default_sets:3,default_reps:10},{name:"Rows",default_weight:50,default_sets:3,default_reps:12}]},{name:"LEGS",exercises:[{name:"Squats",default_weight:70,default_sets:4,default_reps:8},{name:"Lunges",default_weight:30,default_sets:3,default_reps:12},{name:"Calf Raises",default_weight:40,default_sets:3,default_reps:15}]}],meals:[{name:"Breakfast",ingredients:""},{name:"Lunch",ingredients:""},{name:"Dinner",ingredients:""},{name:"Snacks",ingredients:""}],grocery:{categories:[{name:"Proteins",items:""},{name:"Vegetables",items:""},{name:"Fruits",items:""},{name:"Dairy",items:""},{name:"Grains",items:""},{name:"Others",items:""}]},measurements:[{name:"Weight",placeholder:"kg"},{name:"Waist",placeholder:"cm"},{name:"Chest",placeholder:"cm"},{name:"Arms",placeholder:"cm"}],financials:[{name:"Income",placeholder:"0",account:""},{name:"Expenses",placeholder:"0",account:""},{name:"Savings",placeholder:"0",account:""},{name:"Investments",placeholder:"0",account:""}]}}}var F=Ga();F.__click=[Na,w];var ee=v(F),Oe=v(ee),ke=v(Oe),ce=_(v(ke),2);ce.__click=w;var _e=_(ke,2),Me=v(_e);ie(Me,21,()=>g,Je,(A,W)=>{var K=Ua();let ue;var Q=v(K),H=v(Q),ae=_(Q,2),te=v(ae);U(G=>{ue=X(K,1,"setup-step svelte-1gw615y",null,ue,G),L(H,l(W).num),L(te,l(W).name)},[()=>({active:l(a)>=l(W).num})]),x(A,K)});var Te=_(_e,2);{var De=A=>{var W=qa(),K=_(v(W),4),ue=_(K,2),Q=v(ue);Q.__click=[La,u,c,t,a];let H;var ae=v(Q),te=_(Q,2);{var G=Y=>{var he=ja();x(Y,he)},de=(Y,he)=>{{var Jt=ye=>{var at=$a();x(ye,at)};z(Y,ye=>{l(c)==="error"&&ye(Jt)},he)}};z(te,Y=>{l(c)==="success"?Y(G):Y(de,!1)})}U(Y=>{Q.disabled=l(u)||!l(t),H=X(Q,1,"svelte-1gw615y",null,H,Y),L(ae,l(u)?"Testing...":"Test Connection")},[()=>({"setup-disabled":l(u)||!l(t)})]),le(K,()=>l(t),Y=>S(t,Y)),x(A,W)};z(Te,A=>{l(a)===1&&A(De)})}var Ie=_(Te,2);{var Le=A=>{var W=Ma(),K=_(v(W),4),ue=v(K),Q=_(K,2),H=v(Q),ae=_(H,2);ae.__click=[Fa,i];var te=v(ae),G=_(Q,2);G.__click=b;let de;var Y=v(G);U(he=>{He(H,"type",l(i)?"text":"password"),L(te,l(i)?"Hide":"Show"),G.disabled=l(o)||!l(n)||!l(r),de=X(G,1,"svelte-1gw615y",null,de,he),L(Y,l(o)?"Authenticating...":"Authenticate")},[()=>({"setup-disabled":l(o)||!l(n)||!l(r)})]),le(ue,()=>l(n),he=>S(n,he)),le(H,()=>l(r),he=>S(r,he)),x(A,W)};z(Ie,A=>{l(a)===2&&A(Le)})}var Ee=_(Ie,2);{var et=A=>{var W=Wa(),K=_(v(W),6);K.__click=k;let ue;var Q=v(K);U(H=>{K.disabled=l(o),ue=X(K,1,"svelte-1gw615y",null,ue,H),L(Q,l(o)?"Creating...":"Create Collections")},[()=>({"setup-disabled":l(o)})]),x(A,W)};z(Ee,A=>{l(a)===3&&A(et)})}var se=_(Ee,2);{var q=A=>{var W=Ja(),K=_(v(W),4);{var ue=H=>{var ae=Ba(),te=je(ae),G=v(te),de=_(te,2),Y=v(de);U(()=>{is(G,`width: ${l(d)??""}%`),L(Y,l(f))}),x(H,ae)},Q=H=>{var ae=Ka(),te=je(ae),G=v(te);{var de=ye=>{var at=rs("â");x(ye,at)},Y=ye=>{var at=rs("â¢");x(ye,at)};z(G,ye=>{m.templates?ye(de):ye(Y,!1)})}var he=_(te,2);he.__click=P;let Jt;U(ye=>{he.disabled=l(h),Jt=X(he,1,"svelte-1gw615y",null,Jt,ye)},[()=>({"setup-disabled":l(h)})]),x(H,ae)};z(K,H=>{l(h)?H(ue):H(Q,!1)})}x(A,W)};z(se,A=>{l(a)===4&&A(q)})}var Ce=_(se,2);{var B=A=>{var W=Ha(),K=_(v(W),4);K.__click=O,x(A,W)};z(Ce,A=>{l(a)===5&&A(B)})}x(s,F),ge()}ze(["click"]);var za=I('<!> <div class="viewport-container"><div class="card"><!> <!> <!> <!> <!> <!> <!> <!></div></div> <!> <!>',1);function Ya(s,e){me(e,!1),li(()=>{p.init()}),xe();var t=za(),n=je(t);ka(n,{});var r=_(n,2),i=v(r),a=v(i);Ui(a,{});var c=_(a,2);Hi(c,{});var o=_(c,2);Xi(o,{});var u=_(o,2);ia(u,{});var h=_(u,2);la(h,{});var d=_(h,2);da(d,{});var f=_(d,2);va(f,{});var m=_(f,2);ya(m,{});var g=_(r,2);Ra(g,{});var w=_(g,2);{var b=k=>{Va(k,{})};z(w,k=>{R(p),y(()=>p.showSetupModal)&&k(b)})}x(s,t),ge()}Gr(Ya,{target:document.getElementById("app")});
