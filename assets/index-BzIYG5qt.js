(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();var fn=Object.defineProperty,ms=t=>{throw TypeError(t)},pn=(t,e,a)=>e in t?fn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,St=(t,e,a)=>pn(t,typeof e!="symbol"?e+"":e,a),hn=(t,e,a)=>e.has(t)||ms("Cannot "+a),b=(t,e,a)=>(hn(t,e,"read from private field"),a?a.call(t):e.get(t)),F=(t,e,a)=>e.has(t)?ms("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,a);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();const mn=!1;var ca=Array.isArray,gn=Array.prototype.indexOf,Aa=Array.from,yn=Object.defineProperty,ot=Object.getOwnPropertyDescriptor,gs=Object.getOwnPropertyDescriptors,_n=Object.prototype,wn=Array.prototype,Na=Object.getPrototypeOf,ns=Object.isExtensible;function Sn(t){return t()}function Ta(t){for(var e=0;e<t.length;e++)t[e]()}const ge=2,ys=4,ua=8,Wa=16,Re=32,st=64,Pa=128,ce=256,Xt=512,ye=1024,Ee=2048,Qe=4096,We=8192,Ea=16384,_s=32768,Ra=65536,xn=1<<17,bn=1<<19,ws=1<<20,Ia=1<<21,He=Symbol("$state"),kn=Symbol("");function Ss(t){return t===this.v}function Dn(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function xs(t){return!Dn(t,this.v)}function Tn(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function In(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function On(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Cn(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Mn(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function An(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Nn(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let pt=!1,Wn=!1;function Pn(){pt=!0}const La=1,Fa=2,bs=4,En=8,Rn=16,Ln=1,Fn=2,ie=Symbol(),$n="http://www.w3.org/1999/xhtml";function Un(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let V=null;function rs(t){V=t}function de(t,e=!1,a){var s=V={p:V,c:null,d:!1,e:null,m:!1,s:t,x:null,l:null};pt&&!e&&(V.l={s:null,u:null,r1:[],r2:dt(!1)}),Hn(()=>{s.d=!0})}function ve(t){const e=V;if(e!==null){const l=e.e;if(l!==null){var a=$,s=E;e.e=null;try{for(var n=0;n<l.length;n++){var r=l[n];ze(r.effect),De(r.reaction),fa(r.fn)}}finally{ze(a),De(s)}}V=e.p,e.m=!0}return{}}function ht(){return!pt||V!==null&&V.l===null}function G(t){if(typeof t!="object"||t===null||He in t)return t;const e=Na(t);if(e!==_n&&e!==wn)return t;var a=new Map,s=ca(t),n=T(0),r=E,l=c=>{var o=E;De(r);var d=c();return De(o),d};return s&&a.set("length",T(t.length)),new Proxy(t,{defineProperty(c,o,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&Mn();var u=a.get(o);return u===void 0?u=l(()=>{var v=T(d.value);return a.set(o,v),v}):S(u,d.value,!0),!0},deleteProperty(c,o){var d=a.get(o);if(d===void 0){if(o in c){const g=l(()=>T(ie));a.set(o,g),ba(n)}}else{if(s&&typeof o=="string"){var u=a.get("length"),v=Number(o);Number.isInteger(v)&&v<u.v&&S(u,v)}S(d,ie),ba(n)}return!0},get(c,o,d){var u;if(o===He)return t;var v=a.get(o),g=o in c;if(v===void 0&&(!g||(u=ot(c,o))!=null&&u.writable)&&(v=l(()=>{var w=G(g?c[o]:ie),D=T(w);return D}),a.set(o,v)),v!==void 0){var h=i(v);return h===ie?void 0:h}return Reflect.get(c,o,d)},getOwnPropertyDescriptor(c,o){var d=Reflect.getOwnPropertyDescriptor(c,o);if(d&&"value"in d){var u=a.get(o);u&&(d.value=i(u))}else if(d===void 0){var v=a.get(o),g=v==null?void 0:v.v;if(v!==void 0&&g!==ie)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return d},has(c,o){var d;if(o===He)return!0;var u=a.get(o),v=u!==void 0&&u.v!==ie||Reflect.has(c,o);if(u!==void 0||$!==null&&(!v||(d=ot(c,o))!=null&&d.writable)){u===void 0&&(u=l(()=>{var h=v?G(c[o]):ie,w=T(h);return w}),a.set(o,u));var g=i(u);if(g===ie)return!1}return v},set(c,o,d,u){var v,g=a.get(o),h=o in c;if(s&&o==="length")for(var w=d;w<g.v;w+=1){var D=a.get(w+"");D!==void 0?S(D,ie):w in c&&(D=l(()=>T(ie)),a.set(w+"",D))}if(g===void 0)(!h||(v=ot(c,o))!=null&&v.writable)&&(g=l(()=>T(void 0)),S(g,G(d)),a.set(o,g));else{h=g.v!==ie;var y=l(()=>G(d));S(g,y)}var k=Reflect.getOwnPropertyDescriptor(c,o);if(k!=null&&k.set&&k.set.call(u,d),!h){if(s&&typeof o=="string"){var x=a.get("length"),I=Number(o);Number.isInteger(I)&&I>=x.v&&S(x,I+1)}ba(n)}return!0},ownKeys(c){i(n);var o=Reflect.ownKeys(c).filter(v=>{var g=a.get(v);return g===void 0||g.v!==ie});for(var[d,u]of a)u.v!==ie&&!(d in c)&&o.push(d);return o},setPrototypeOf(){An()}})}function ba(t,e=1){S(t,t.v+e)}function is(t){try{if(t!==null&&typeof t=="object"&&He in t)return t[He]}catch{}return t}function qn(t,e){return Object.is(is(t),is(e))}function $a(t){var e=ge|Ee,a=E!==null&&(E.f&ge)!==0?E:null;return $===null||a!==null&&(a.f&ce)!==0?e|=ce:$.f|=ws,{ctx:V,deps:null,effects:null,equals:Ss,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:a??$}}function Ne(t){const e=$a(t);return e.equals=xs,e}function ks(t){var e=t.effects;if(e!==null){t.effects=null;for(var a=0;a<e.length;a+=1)je(e[a])}}function jn(t){for(var e=t.parent;e!==null;){if((e.f&ge)===0)return e;e=e.parent}return null}function Ds(t){var e,a=$;ze(jn(t));try{ks(t),e=js(t)}finally{ze(a)}return e}function Ts(t){var e=Ds(t);if(t.equals(e)||(t.v=e,t.wv=Us()),!rt){var a=($e||(t.f&ce)!==0)&&t.deps!==null?Qe:ye;Te(t,a)}}const ut=new Map;function dt(t,e){var a={f:0,v:t,reactions:null,equals:Ss,rv:0,wv:0};return a}function T(t,e){const a=dt(t);return sr(a),a}function zn(t,e=!1,a=!0){var s;const n=dt(t);return e||(n.equals=xs),pt&&a&&V!==null&&V.l!==null&&((s=V.l).s??(s.s=[])).push(n),n}function S(t,e,a=!1){E!==null&&!ke&&ht()&&(E.f&(ge|Wa))!==0&&!(ne!=null&&ne[1].includes(t)&&ne[0]===E)&&Nn();let s=a?G(e):e;return vt(t,s)}function vt(t,e){if(!t.equals(e)){var a=t.v;rt?ut.set(t,e):ut.set(t,a),t.v=e,(t.f&ge)!==0&&((t.f&Ee)!==0&&Ds(t),Te(t,(t.f&ce)===0?ye:Qe)),t.wv=Us(),Is(t,Ee),ht()&&$!==null&&($.f&ye)!==0&&($.f&(Re|st))===0&&(me===null?nr([t]):me.push(t))}return e}function Is(t,e){var a=t.reactions;if(a!==null)for(var s=ht(),n=a.length,r=0;r<n;r++){var l=a[r],c=l.f;(c&Ee)===0&&(!s&&l===$||(Te(l,e),(c&(ye|ce))!==0&&((c&ge)!==0?Is(l,Qe):za(l))))}}function Bn(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let Jn=!1;var ls,Os,Cs,Ms;function Yn(){if(ls===void 0){ls=window,Os=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,a=Text.prototype;Cs=ot(e,"firstChild").get,Ms=ot(e,"nextSibling").get,ns(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),ns(a)&&(a.__t=void 0)}}function da(t=""){return document.createTextNode(t)}function Zt(t){return Cs.call(t)}function va(t){return Ms.call(t)}function p(t,e){return Zt(t)}function Pe(t,e){{var a=Zt(t);return a instanceof Comment&&a.data===""?va(a):a}}function m(t,e=1,a=!1){let s=t;for(;e--;)s=va(s);return s}function Gn(t){t.textContent=""}function As(t){$===null&&E===null&&On(),E!==null&&(E.f&ce)!==0&&$===null&&In(),rt&&Tn()}function Vn(t,e){var a=e.last;a===null?e.last=e.first=t:(a.next=t,t.prev=a,e.last=t)}function nt(t,e,a,s=!0){var n=$,r={ctx:V,deps:null,nodes_start:null,nodes_end:null,f:t|Ee,first:null,fn:e,last:null,next:null,parent:n,prev:null,teardown:null,transitions:null,wv:0};if(a)try{ja(r),r.f|=_s}catch(o){throw je(r),o}else e!==null&&za(r);var l=a&&r.deps===null&&r.first===null&&r.nodes_start===null&&r.teardown===null&&(r.f&(ws|Pa))===0;if(!l&&s&&(n!==null&&Vn(r,n),E!==null&&(E.f&ge)!==0)){var c=E;(c.effects??(c.effects=[])).push(r)}return r}function Hn(t){const e=nt(ua,null,!1);return Te(e,ye),e.teardown=t,e}function ea(t){As();var e=$!==null&&($.f&Re)!==0&&V!==null&&!V.m;if(e){var a=V;(a.e??(a.e=[])).push({fn:t,effect:$,reaction:E})}else{var s=fa(t);return s}}function Kn(t){return As(),Ns(t)}function Qn(t){const e=nt(st,t,!0);return(a={})=>new Promise(s=>{a.outro?ta(e,()=>{je(e),s(void 0)}):(je(e),s(void 0))})}function fa(t){return nt(ys,t,!1)}function Ns(t){return nt(ua,t,!0)}function q(t,e=[],a=$a){const s=e.map(a);return Ua(()=>t(...s.map(i)))}function Ua(t,e=0){return nt(ua|Wa|e,t,!0)}function ft(t,e=!0){return nt(ua|Re,t,!0,e)}function Ws(t){var e=t.teardown;if(e!==null){const a=rt,s=E;os(!0),De(null);try{e.call(null)}finally{os(a),De(s)}}}function Ps(t,e=!1){var a=t.first;for(t.first=t.last=null;a!==null;){var s=a.next;(a.f&st)!==0?a.parent=null:je(a,e),a=s}}function Xn(t){for(var e=t.first;e!==null;){var a=e.next;(e.f&Re)===0&&je(e),e=a}}function je(t,e=!0){var a=!1;(e||(t.f&bn)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(Zn(t.nodes_start,t.nodes_end),a=!0),Ps(t,e&&!a),ia(t,0),Te(t,Ea);var s=t.transitions;if(s!==null)for(const r of s)r.stop();Ws(t);var n=t.parent;n!==null&&n.first!==null&&Es(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function Zn(t,e){for(;t!==null;){var a=t===e?null:va(t);t.remove(),t=a}}function Es(t){var e=t.parent,a=t.prev,s=t.next;a!==null&&(a.next=s),s!==null&&(s.prev=a),e!==null&&(e.first===t&&(e.first=s),e.last===t&&(e.last=a))}function ta(t,e){var a=[];qa(t,a,!0),Rs(a,()=>{je(t),e&&e()})}function Rs(t,e){var a=t.length;if(a>0){var s=()=>--a||e();for(var n of t)n.out(s)}else e()}function qa(t,e,a){if((t.f&We)===0){if(t.f^=We,t.transitions!==null)for(const l of t.transitions)(l.is_global||a)&&e.push(l);for(var s=t.first;s!==null;){var n=s.next,r=(s.f&Ra)!==0||(s.f&Re)!==0;qa(s,e,r?a:!1),s=n}}}function aa(t){Ls(t,!0)}function Ls(t,e){if((t.f&We)!==0){t.f^=We;for(var a=t.first;a!==null;){var s=a.next,n=(a.f&Ra)!==0||(a.f&Re)!==0;Ls(a,n?e:!1),a=s}if(t.transitions!==null)for(const r of t.transitions)(r.is_global||e)&&r.in()}}let sa=[];function er(){var t=sa;sa=[],Ta(t)}function tr(t){sa.length===0&&queueMicrotask(er),sa.push(t)}function ar(t){var e=$;if((e.f&_s)===0){if((e.f&Pa)===0)throw t;e.fn(t)}else Fs(t,e)}function Fs(t,e){for(;e!==null;){if((e.f&Pa)!==0)try{e.fn(t);return}catch{}e=e.parent}throw t}let Oa=!1,na=null,Ke=!1,rt=!1;function os(t){rt=t}let bt=[],E=null,ke=!1;function De(t){E=t}let $=null;function ze(t){$=t}let ne=null;function sr(t){E!==null&&E.f&Ia&&(ne===null?ne=[E,[t]]:ne[1].push(t))}let te=null,oe=0,me=null;function nr(t){me=t}let $s=1,ra=0,$e=!1,Ve=null;function Us(){return++$s}function pa(t){var e,a=t.f;if((a&Ee)!==0)return!0;if((a&Qe)!==0){var s=t.deps,n=(a&ce)!==0;if(s!==null){var r,l,c=(a&Xt)!==0,o=n&&$!==null&&!$e,d=s.length;if(c||o){var u=t,v=u.parent;for(r=0;r<d;r++)l=s[r],(c||!((e=l==null?void 0:l.reactions)!=null&&e.includes(u)))&&(l.reactions??(l.reactions=[])).push(u);c&&(u.f^=Xt),o&&v!==null&&(v.f&ce)===0&&(u.f^=ce)}for(r=0;r<d;r++)if(l=s[r],pa(l)&&Ts(l),l.wv>t.wv)return!0}(!n||$!==null&&!$e)&&Te(t,ye)}return!1}function qs(t,e,a=!0){var s=t.reactions;if(s!==null)for(var n=0;n<s.length;n++){var r=s[n];ne!=null&&ne[1].includes(t)&&ne[0]===E||((r.f&ge)!==0?qs(r,e,!1):e===r&&(a?Te(r,Ee):(r.f&ye)!==0&&Te(r,Qe),za(r)))}}function js(t){var e,a=te,s=oe,n=me,r=E,l=$e,c=ne,o=V,d=ke,u=t.f;te=null,oe=0,me=null,$e=(u&ce)!==0&&(ke||!Ke||E===null),E=(u&(Re|st))===0?t:null,ne=null,rs(t.ctx),ke=!1,ra++,t.f|=Ia;try{var v=(0,t.fn)(),g=t.deps;if(te!==null){var h;if(ia(t,oe),g!==null&&oe>0)for(g.length=oe+te.length,h=0;h<te.length;h++)g[oe+h]=te[h];else t.deps=g=te;if(!$e)for(h=oe;h<g.length;h++)((e=g[h]).reactions??(e.reactions=[])).push(t)}else g!==null&&oe<g.length&&(ia(t,oe),g.length=oe);if(ht()&&me!==null&&!ke&&g!==null&&(t.f&(ge|Qe|Ee))===0)for(h=0;h<me.length;h++)qs(me[h],t);return r!==null&&r!==t&&(ra++,me!==null&&(n===null?n=me:n.push(...me))),v}catch(w){ar(w)}finally{te=a,oe=s,me=n,E=r,$e=l,ne=c,rs(o),ke=d,t.f^=Ia}}function rr(t,e){let a=e.reactions;if(a!==null){var s=gn.call(a,t);if(s!==-1){var n=a.length-1;n===0?a=e.reactions=null:(a[s]=a[n],a.pop())}}a===null&&(e.f&ge)!==0&&(te===null||!te.includes(e))&&(Te(e,Qe),(e.f&(ce|Xt))===0&&(e.f^=Xt),ks(e),ia(e,0))}function ia(t,e){var a=t.deps;if(a!==null)for(var s=e;s<a.length;s++)rr(t,a[s])}function ja(t){var e=t.f;if((e&Ea)===0){Te(t,ye);var a=$,s=Ke;$=t,Ke=!0;try{(e&Wa)!==0?Xn(t):Ps(t),Ws(t);var n=js(t);t.teardown=typeof n=="function"?n:null,t.wv=$s;var r;mn&&Wn&&(t.f&Ee)!==0&&t.deps}finally{Ke=s,$=a}}}function ir(){try{Cn()}catch(t){if(na!==null)Fs(t,na);else throw t}}function lr(){var t=Ke;try{var e=0;for(Ke=!0;bt.length>0;){e++>1e3&&ir();var a=bt,s=a.length;bt=[];for(var n=0;n<s;n++){var r=cr(a[n]);or(r)}ut.clear()}}finally{Oa=!1,Ke=t,na=null}}function or(t){var e=t.length;if(e!==0)for(var a=0;a<e;a++){var s=t[a];(s.f&(Ea|We))===0&&pa(s)&&(ja(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null?Es(s):s.fn=null))}}function za(t){Oa||(Oa=!0,queueMicrotask(lr));for(var e=na=t;e.parent!==null;){e=e.parent;var a=e.f;if((a&(st|Re))!==0){if((a&ye)===0)return;e.f^=ye}}bt.push(e)}function cr(t){for(var e=[],a=t;a!==null;){var s=a.f,n=(s&(Re|st))!==0,r=n&&(s&ye)!==0;if(!r&&(s&We)===0){(s&ys)!==0?e.push(a):n?a.f^=ye:pa(a)&&ja(a);var l=a.first;if(l!==null){a=l;continue}}var c=a.parent;for(a=a.next;a===null&&c!==null;)a=c.next,c=c.parent}return e}function i(t){var e=t.f,a=(e&ge)!==0;if(Ve!==null&&Ve.add(t),E!==null&&!ke){if(!(ne!=null&&ne[1].includes(t))||ne[0]!==E){var s=E.deps;t.rv<ra&&(t.rv=ra,te===null&&s!==null&&s[oe]===t?oe++:te===null?te=[t]:(!$e||!te.includes(t))&&te.push(t))}}else if(a&&t.deps===null&&t.effects===null){var n=t,r=n.parent;r!==null&&(r.f&ce)===0&&(n.f^=ce)}return a&&(n=t,pa(n)&&Ts(n)),rt&&ut.has(t)?ut.get(t):t.v}function ur(t){var e=Ve;Ve=new Set;var a=Ve,s;try{if(_(t),e!==null)for(s of Ve)e.add(s)}finally{Ve=e}return a}function ae(t){var e=ur(()=>_(t));for(var a of e)if((a.f&xn)!==0)for(const s of a.deps||[])(s.f&ge)===0&&vt(s,s.v);else vt(a,a.v)}function _(t){var e=ke;try{return ke=!0,t()}finally{ke=e}}const dr=-7169;function Te(t,e){t.f=t.f&dr|e}function P(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(He in t)Ca(t);else if(!Array.isArray(t))for(let e in t){const a=t[e];typeof a=="object"&&a&&He in a&&Ca(a)}}}function Ca(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let s in t)try{Ca(t[s],e)}catch{}const a=Na(t);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const s=gs(a);for(let n in s){const r=s[n].get;if(r)try{r.call(t)}catch{}}}}}const vr=["touchstart","touchmove"];function fr(t){return vr.includes(t)}let cs=!1;function pr(){cs||(cs=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const a of t.target.elements)(e=a.__on_r)==null||e.call(a)})},{capture:!0}))}function hr(t){var e=E,a=$;De(null),ze(null);try{return t()}finally{De(e),ze(a)}}function zs(t,e,a,s=a){t.addEventListener(e,()=>hr(a));const n=t.__on_r;n?t.__on_r=()=>{n(),s(!0)}:t.__on_r=()=>s(!0),pr()}const Bs=new Set,Ma=new Set;function Be(t){for(var e=0;e<t.length;e++)Bs.add(t[e]);for(var a of Ma)a(t)}function xt(t){var e,a=this,s=a.ownerDocument,n=t.type,r=((e=t.composedPath)==null?void 0:e.call(t))||[],l=r[0]||t.target,c=0,o=t.__root;if(o){var d=r.indexOf(o);if(d!==-1&&(a===document||a===window)){t.__root=a;return}var u=r.indexOf(a);if(u===-1)return;d<=u&&(c=d)}if(l=r[c]||t.target,l!==a){yn(t,"currentTarget",{configurable:!0,get(){return l||s}});var v=E,g=$;De(null),ze(null);try{for(var h,w=[];l!==null;){var D=l.assignedSlot||l.parentNode||l.host||null;try{var y=l["__"+n];if(y!=null&&(!l.disabled||t.target===l))if(ca(y)){var[k,...x]=y;k.apply(l,[t,...x])}else y.call(l,t)}catch(I){h?w.push(I):h=I}if(t.cancelBubble||D===a||D===null)break;l=D}if(h){for(let I of w)queueMicrotask(()=>{throw I});throw h}}finally{t.__root=a,delete t.currentTarget,De(v),ze(g)}}}function mr(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function la(t,e){var a=$;a.nodes_start===null&&(a.nodes_start=t,a.nodes_end=e)}function W(t,e){var a=(e&Ln)!==0,s=(e&Fn)!==0,n,r=!t.startsWith("<!>");return()=>{n===void 0&&(n=mr(r?t:"<!>"+t),a||(n=Zt(n)));var l=s||Os?document.importNode(n,!0):n.cloneNode(!0);if(a){var c=Zt(l),o=l.lastChild;la(c,o)}else la(l,l);return l}}function Js(t=""){{var e=da(t+"");return la(e,e),e}}function gr(){var t=document.createDocumentFragment(),e=document.createComment(""),a=da();return t.append(e,a),la(e,a),t}function C(t,e){t!==null&&t.before(e)}function A(t,e){var a=e==null?"":typeof e=="object"?e+"":e;a!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=a,t.nodeValue=a+"")}function yr(t,e){return _r(t,e)}const at=new Map;function _r(t,{target:e,anchor:a,props:s={},events:n,context:r,intro:l=!0}){Yn();var c=new Set,o=v=>{for(var g=0;g<v.length;g++){var h=v[g];if(!c.has(h)){c.add(h);var w=fr(h);e.addEventListener(h,xt,{passive:w});var D=at.get(h);D===void 0?(document.addEventListener(h,xt,{passive:w}),at.set(h,1)):at.set(h,D+1)}}};o(Aa(Bs)),Ma.add(o);var d=void 0,u=Qn(()=>{var v=a??e.appendChild(da());return ft(()=>{if(r){de({});var g=V;g.c=r}n&&(s.$$events=n),d=t(v,s)||{},r&&ve()}),()=>{var g;for(var h of c){e.removeEventListener(h,xt);var w=at.get(h);--w===0?(document.removeEventListener(h,xt),at.delete(h)):at.set(h,w)}Ma.delete(o),v!==a&&((g=v.parentNode)==null||g.removeChild(v))}});return wr.set(d,u),d}let wr=new WeakMap;function ue(t,e,[a,s]=[0,0]){var n=t,r=null,l=null,c=ie,o=a>0?Ra:0,d=!1;const u=(g,h=!0)=>{d=!0,v(h,g)},v=(g,h)=>{c!==(c=g)&&(c?(r?aa(r):h&&(r=ft(()=>h(n))),l&&ta(l,()=>{l=null})):(l?aa(l):h&&(l=ft(()=>h(n,[a+1,s]))),r&&ta(r,()=>{r=null})))};Ua(()=>{d=!1,e(u),d||v(null,null)},o)}function Ue(t,e){return e}function Sr(t,e,a,s){for(var n=[],r=e.length,l=0;l<r;l++)qa(e[l].e,n,!0);var c=r>0&&n.length===0&&a!==null;if(c){var o=a.parentNode;Gn(o),o.append(a),s.clear(),Fe(t,e[0].prev,e[r-1].next)}Rs(n,()=>{for(var d=0;d<r;d++){var u=e[d];c||(s.delete(u.k),Fe(t,u.prev,u.next)),je(u.e,!c)}})}function se(t,e,a,s,n,r=null){var l=t,c={flags:e,items:new Map,first:null},o=(e&bs)!==0;if(o){var d=t;l=d.appendChild(da())}var u=null,v=!1,g=Ne(()=>{var h=a();return ca(h)?h:h==null?[]:Aa(h)});Ua(()=>{var h=i(g),w=h.length;v&&w===0||(v=w===0,xr(h,c,l,n,e,s,a),r!==null&&(w===0?u?aa(u):u=ft(()=>r(l)):u!==null&&ta(u,()=>{u=null})),i(g))})}function xr(t,e,a,s,n,r,l){var c,o,d,u,v=(n&En)!==0,g=(n&(La|Fa))!==0,h=t.length,w=e.items,D=e.first,y=D,k,x=null,I,N=[],R=[],j,U,M,L;if(v)for(L=0;L<h;L+=1)j=t[L],U=r(j,L),M=w.get(U),M!==void 0&&((c=M.a)==null||c.measure(),(I??(I=new Set)).add(M));for(L=0;L<h;L+=1){if(j=t[L],U=r(j,L),M=w.get(U),M===void 0){var Oe=y?y.e.nodes_start:a;x=kr(Oe,e,x,x===null?e.first:x.next,j,U,L,s,n,l),w.set(U,x),N=[],R=[],y=x.next;continue}if(g&&br(M,j,L,n),(M.e.f&We)!==0&&(aa(M.e),v&&((o=M.a)==null||o.unfix(),(I??(I=new Set)).delete(M))),M!==y){if(k!==void 0&&k.has(M)){if(N.length<R.length){var le=R[0],Q;x=le.prev;var Ce=N[0],fe=N[N.length-1];for(Q=0;Q<N.length;Q+=1)us(N[Q],le,a);for(Q=0;Q<R.length;Q+=1)k.delete(R[Q]);Fe(e,Ce.prev,fe.next),Fe(e,x,Ce),Fe(e,fe,le),y=le,x=fe,L-=1,N=[],R=[]}else k.delete(M),us(M,y,a),Fe(e,M.prev,M.next),Fe(e,M,x===null?e.first:x.next),Fe(e,x,M),x=M;continue}for(N=[],R=[];y!==null&&y.k!==U;)(y.e.f&We)===0&&(k??(k=new Set)).add(y),R.push(y),y=y.next;if(y===null)continue;M=y}N.push(M),x=M,y=M.next}if(y!==null||k!==void 0){for(var re=k===void 0?[]:Aa(k);y!==null;)(y.e.f&We)===0&&re.push(y),y=y.next;var pe=re.length;if(pe>0){var Le=(n&bs)!==0&&h===0?a:null;if(v){for(L=0;L<pe;L+=1)(d=re[L].a)==null||d.measure();for(L=0;L<pe;L+=1)(u=re[L].a)==null||u.fix()}Sr(e,re,Le,w)}}v&&tr(()=>{var Me;if(I!==void 0)for(M of I)(Me=M.a)==null||Me.apply()}),$.first=e.first&&e.first.e,$.last=x&&x.e}function br(t,e,a,s){(s&La)!==0&&vt(t.v,e),(s&Fa)!==0?vt(t.i,a):t.i=a}function kr(t,e,a,s,n,r,l,c,o,d){var u=(o&La)!==0,v=(o&Rn)===0,g=u?v?zn(n,!1,!1):dt(n):n,h=(o&Fa)===0?l:dt(l),w={i:h,v:g,k:r,a:null,e:null,prev:a,next:s};try{return w.e=ft(()=>c(t,g,h,d),Jn),w.e.prev=a&&a.e,w.e.next=s&&s.e,a===null?e.first=w:(a.next=w,a.e.next=w.e),s!==null&&(s.prev=w,s.e.prev=w.e),w}finally{}}function us(t,e,a){for(var s=t.next?t.next.e.nodes_start:a,n=e?e.e.nodes_start:a,r=t.e.nodes_start;r!==s;){var l=va(r);n.before(r),r=l}}function Fe(t,e,a){e===null?t.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}function Ys(t){var e,a,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(a=Ys(t[e]))&&(s&&(s+=" "),s+=a)}else for(a in t)t[a]&&(s&&(s+=" "),s+=a);return s}function Dr(){for(var t,e,a=0,s="",n=arguments.length;a<n;a++)(t=arguments[a])&&(e=Ys(t))&&(s&&(s+=" "),s+=e);return s}function Tr(t){return typeof t=="object"?Dr(t):t??""}const ds=[...` 	
\r\f \v\uFEFF`];function Ir(t,e,a){var s=t==null?"":""+t;if(e&&(s=s?s+" "+e:e),a){for(var n in a)if(a[n])s=s?s+" "+n:n;else if(s.length)for(var r=n.length,l=0;(l=s.indexOf(n,l))>=0;){var c=l+r;(l===0||ds.includes(s[l-1]))&&(c===s.length||ds.includes(s[c]))?s=(l===0?"":s.substring(0,l))+s.substring(c+1):l=c}}return s===""?null:s}function Or(t,e){return t==null?null:String(t)}function X(t,e,a,s,n,r){var l=t.__className;if(l!==a||l===void 0){var c=Ir(a,s,r);c==null?t.removeAttribute("class"):t.className=c,t.__className=a}else if(r&&n!==r)for(var o in r){var d=!!r[o];(n==null||d!==!!n[o])&&t.classList.toggle(o,d)}return r}function oa(t,e,a,s){var n=t.__style;if(n!==e){var r=Or(e);r==null?t.removeAttribute("style"):t.style.cssText=r,t.__style=e}return s}function Gs(t,e,a){if(t.multiple){if(e==null)return;if(!ca(e))return Bn();for(var s of t.options)s.selected=e.includes(ct(s));return}for(s of t.options){var n=ct(s);if(qn(n,e)){s.selected=!0;return}}(!a||e!==void 0)&&(t.selectedIndex=-1)}function Cr(t,e){fa(()=>{var a=new MutationObserver(()=>{var s=t.__value;Gs(t,s)});return a.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{a.disconnect()}})}function vs(t,e,a=e){var s=!0;zs(t,"change",n=>{var r=n?"[selected]":":checked",l;if(t.multiple)l=[].map.call(t.querySelectorAll(r),ct);else{var c=t.querySelector(r)??t.querySelector("option:not([disabled])");l=c&&ct(c)}a(l)}),fa(()=>{var n=e();if(Gs(t,n,s),s&&n===void 0){var r=t.querySelector(":checked");r!==null&&(n=ct(r),a(n))}t.__value=n,s=!1}),Cr(t)}function ct(t){return"__value"in t?t.__value:t.value}const Mr=Symbol("is custom element"),Ar=Symbol("is html");function Vs(t,e){var a=Hs(t);a.value===(a.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function qe(t,e,a,s){var n=Hs(t);n[e]!==(n[e]=a)&&(e==="loading"&&(t[kn]=a),a==null?t.removeAttribute(e):typeof a!="string"&&Nr(t).includes(e)?t[e]=a:t.setAttribute(e,a))}function Hs(t){return t.__attributes??(t.__attributes={[Mr]:t.nodeName.includes("-"),[Ar]:t.namespaceURI===$n})}var fs=new Map;function Nr(t){var e=fs.get(t.nodeName);if(e)return e;fs.set(t.nodeName,e=[]);for(var a,s=t,n=Element.prototype;n!==s;){a=gs(s);for(var r in a)a[r].set&&e.push(r);s=Na(s)}return e}function Z(t,e,a=e){var s=ht();zs(t,"input",n=>{var r=n?t.defaultValue:t.value;if(r=ka(t)?Da(r):r,a(r),s&&r!==(r=e())){var l=t.selectionStart,c=t.selectionEnd;t.value=r??"",c!==null&&(t.selectionStart=l,t.selectionEnd=Math.min(c,t.value.length))}}),_(e)==null&&t.value&&a(ka(t)?Da(t.value):t.value),Ns(()=>{var n=e();ka(t)&&n===Da(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}function ka(t){var e=t.type;return e==="number"||e==="range"}function Da(t){return t===""?null:+t}function Ie(t=!1){const e=V,a=e.l.u;if(!a)return;let s=()=>P(e.s);if(t){let n=0,r={};const l=$a(()=>{let c=!1;const o=e.s;for(const d in o)o[d]!==r[d]&&(r[d]=o[d],c=!0);return c&&n++,n});s=()=>i(l)}a.b.length&&Kn(()=>{ps(e,s),Ta(a.b)}),ea(()=>{const n=_(()=>a.m.map(Sn));return()=>{for(const r of n)typeof r=="function"&&r()}}),a.a.length&&ea(()=>{ps(e,s),Ta(a.a)})}function ps(t,e){if(t.l.s)for(const a of t.l.s)i(a);e()}function Ks(t){V===null&&Un(),pt&&V.l!==null?Wr(V).m.push(t):ea(()=>{const e=_(t);if(typeof e=="function")return e})}function Wr(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const Pr="5";var hs;typeof window<"u"&&((hs=window.__svelte??(window.__svelte={})).v??(hs.v=new Set)).add(Pr);let Er=0;const lt=()=>`id_${Date.now()}_${Er++}`;var kt,Dt,Tt,It,Ot,Ct,Mt,At,Nt,Wt,Pt,Et,Rt,Lt,Ft,$t,Ut,qt,jt,zt,Bt,Jt,Yt,Gt,Vt,Ht,Kt,Qt;class Rr{constructor(){St(this,"pb",null),F(this,kt,T(!0)),St(this,"lastSavedState",null),F(this,Dt,T("")),F(this,Tt,T("")),F(this,It,T("London")),F(this,Ot,T("saved")),St(this,"saveTimeout",null),F(this,Ct,T(!1)),F(this,Mt,T("")),St(this,"notificationTimeout",null),F(this,At,T(G(navigator.onLine))),F(this,Nt,T(G([]))),F(this,Wt,T(!1)),F(this,Pt,T(!1)),F(this,Et,T("")),F(this,Rt,T("")),F(this,Lt,T(G(new Date().getDay()))),F(this,Ft,T("Weekly Planner")),F(this,$t,T(G([]))),F(this,Ut,T(G([]))),F(this,qt,T(G([]))),F(this,jt,T(G([]))),F(this,zt,T(G([]))),F(this,Bt,T(G([]))),F(this,Jt,T(G([]))),F(this,Yt,T(G([]))),F(this,Gt,T(null)),F(this,Vt,T(null)),F(this,Ht,T(G([]))),F(this,Kt,T(G([{name:"London",lat:51.5074,lon:-.1278},{name:"Cairo",lat:30.0444,lon:31.2357},{name:"Cape Town",lat:-33.9249,lon:18.4241},{name:"Amsterdam",lat:52.3676,lon:4.9041},{name:"Current Location",lat:null,lon:null}]))),F(this,Qt,T(!1)),window.PocketBase?(this.pb=new window.PocketBase(window.location.origin),this.pb.autoCancellation(!1)):console.error("PocketBase not available"),this.setupEventListeners()}get isInitializing(){return i(b(this,kt))}set isInitializing(e){S(b(this,kt),e,!0)}get currentWeek(){return i(b(this,Dt))}set currentWeek(e){S(b(this,Dt),e,!0)}get dateRange(){return i(b(this,Tt))}set dateRange(e){S(b(this,Tt),e,!0)}get city(){return i(b(this,It))}set city(e){S(b(this,It),e,!0)}get saveStatus(){return i(b(this,Ot))}set saveStatus(e){S(b(this,Ot),e,!0)}get showNotification(){return i(b(this,Ct))}set showNotification(e){S(b(this,Ct),e,!0)}get notificationMessage(){return i(b(this,Mt))}set notificationMessage(e){S(b(this,Mt),e,!0)}get isOnline(){return i(b(this,At))}set isOnline(e){S(b(this,At),e,!0)}get pendingSync(){return i(b(this,Nt))}set pendingSync(e){S(b(this,Nt),e,!0)}get showCitySelector(){return i(b(this,Wt))}set showCitySelector(e){S(b(this,Wt),e,!0)}get showWeekSelector(){return i(b(this,Pt))}set showWeekSelector(e){S(b(this,Pt),e,!0)}get cityDropdownStyle(){return i(b(this,Et))}set cityDropdownStyle(e){S(b(this,Et),e,!0)}get weekDropdownStyle(){return i(b(this,Rt))}set weekDropdownStyle(e){S(b(this,Rt),e,!0)}get currentDay(){return i(b(this,Lt))}set currentDay(e){S(b(this,Lt),e,!0)}get plannerTitle(){return i(b(this,Ft))}set plannerTitle(e){S(b(this,Ft),e,!0)}get times(){return i(b(this,$t))}set times(e){S(b(this,$t),e,!0)}get schedule(){return i(b(this,Ut))}set schedule(e){S(b(this,Ut),e,!0)}get tasks(){return i(b(this,qt))}set tasks(e){S(b(this,qt),e,!0)}get workoutPlan(){return i(b(this,jt))}set workoutPlan(e){S(b(this,jt),e,!0)}get meals(){return i(b(this,zt))}set meals(e){S(b(this,zt),e,!0)}get groceryList(){return i(b(this,Bt))}set groceryList(e){S(b(this,Bt),e,!0)}get bodyMeasurements(){return i(b(this,Jt))}set bodyMeasurements(e){S(b(this,Jt),e,!0)}get financials(){return i(b(this,Yt))}set financials(e){S(b(this,Yt),e,!0)}get currentTemplate(){return i(b(this,Gt))}set currentTemplate(e){S(b(this,Gt),e,!0)}get currentTemplateId(){return i(b(this,Vt))}set currentTemplateId(e){S(b(this,Vt),e,!0)}get savedWeeks(){return i(b(this,Ht))}set savedWeeks(e){S(b(this,Ht),e,!0)}get cityOptions(){return i(b(this,Kt))}set cityOptions(e){S(b(this,Kt),e,!0)}get showSetupModal(){return i(b(this,Qt))}set showSetupModal(e){S(b(this,Qt),e,!0)}setupEventListeners(){window.addEventListener("online",()=>{this.isOnline=!0,this.syncPendingData()}),window.addEventListener("offline",()=>this.isOnline=!1),document.addEventListener("click",e=>{e.target.closest(".dropdown-portal,.clickable")||(this.showCitySelector=this.showWeekSelector=!1)})}async init(){if(console.log("PlannerStore init() called"),!this.pb&&window.PocketBase&&(this.pb=new window.PocketBase(window.location.origin),this.pb.autoCancellation(!1)),!this.pb){console.error("PocketBase not available in init"),this.showSetupNotification(),this.isInitializing=!1;return}if(!await this.checkDatabaseInitialized()){console.log("Database not initialized, showing setup notification"),this.showSetupNotification(),this.isInitializing=!1;return}this.pendingSync=JSON.parse(localStorage.getItem("planner_pending_sync")||"[]"),this.currentWeek=this.getCurrentIsoWeek(),this.dateRange=this.getWeekDateRange(this.parseISOWeek(this.currentWeek)),await this.loadWeek(this.currentWeek,!0),setInterval(()=>{!this.isInitializing&&this.hasSignificantChanges()&&this.saveData()},3e4),this.isOnline&&this.syncPendingData()}async checkDatabaseInitialized(){try{const e=await this.pb.collection("templates").getFirstListItem("is_default=true");return!0}catch(e){return console.log("Database not initialized:",e.message),!1}}showSetupNotification(){if(console.log("showSetupNotification called"),!document.body){console.error("document.body not ready"),setTimeout(()=>this.showSetupNotification(),100);return}if(document.querySelector(".setup-notification")){console.log("Setup notification already exists");return}const e=document.createElement("div");e.className="setup-notification";const a=document.createElement("span");a.textContent="Database not initialized",e.appendChild(a);const s=document.createElement("button");s.className="setup-notification-button",s.textContent="Setup",e.appendChild(s),document.body.appendChild(e),console.log("Setup notification added to DOM"),s.addEventListener("click",()=>{console.log("Setup button clicked"),console.log("showSetupModal before:",this.showSetupModal),this.showSetupModal=!0,console.log("showSetupModal after:",this.showSetupModal),setTimeout(()=>{const n=document.querySelector(".setup-modal-overlay");console.log("Modal element exists:",n?"YES":"NO")},100)})}async fetchTemplate(e="default"){const a=`template_${e}`;try{const s=localStorage.getItem(a);if(s)return JSON.parse(s)}catch{localStorage.removeItem(a)}if(!this.isOnline)return this.showMessage("Offline: Using fallback template"),this.getFallbackTemplate();try{const s=e==="default"?"is_default=true":`name="${e}"`,n=await this.pb.collection("templates").getFirstListItem(s);return localStorage.setItem(a,JSON.stringify(n)),n}catch{return this.showMessage("Template error: Using fallback"),this.getFallbackTemplate()}}getFallbackTemplate(){return{id:"fallback",name:"fallback",structure:{prayer_times:[{label:"Q",value:""},{label:"F",value:""},{label:"D",value:""},{label:"A",value:""},{label:"M",value:""},{label:"I",value:""}],schedule:[{name:"TOTAL",activities:[{name:"DAILY POINTS",max_per_day:0,max_score:0}]}],tasks:{count:5,fields:["num","priority","tag","description","start_date","expected_date","actual_date","completed"]},workout:[],meals:[],grocery:{categories:[]},measurements:[],financials:[],city_default:"London"}}}applyTemplateStructure(e){var a,s;this.currentTemplate=e,this.currentTemplateId=e.id;const n=e.structure;this.plannerTitle=n.title_default||"Weekly Planner",this.times=[...n.prayer_times||[]],this.schedule=this.buildScheduleFromTemplate(n.schedule||[]),this.tasks=Array(((a=n.tasks)==null?void 0:a.count)||15).fill().map(()=>({id:lt(),priority:"",tag:"",description:"",startDate:"",expectedDate:"",actualDate:"",completed:""})),this.workoutPlan=this.buildWorkoutFromTemplate(n.workout||[]),this.meals=this.ensureIds([...n.meals||[]]),this.groceryList=this.ensureIds([...((s=n.grocery)==null?void 0:s.categories)||[]]),this.bodyMeasurements=this.ensureIds([...n.measurements||[]]),this.financials=this.ensureIds([...n.financials||[]]),this.city=n.city_default||"London"}buildScheduleFromTemplate(e){return e.map(a=>({id:lt(),name:a.name,activities:(a.activities||[]).map(s=>({id:lt(),name:s.name,days:this.createDaysStructure(s.days,s.max_per_day||1),score:0,maxScore:s.max_score||0,streaks:{current:0,longest:0}}))}))}createDaysStructure(e,a){const s=["mon","tue","wed","thu","fri","sat","sun"],n={};return(e&&Array.isArray(e)?e:s).forEach(r=>{n[r]={value:"",max:a}}),n}buildWorkoutFromTemplate(e){return e.map(a=>({id:lt(),name:a.name,exercises:this.ensureIds((a.exercises||[]).map(s=>{var n,r,l;return{prefix:"• ",name:s.name,weight:"",sets:"",reps:"",defaultWeight:((n=s.default_weight)==null?void 0:n.toString())||"",defaultSets:((r=s.default_sets)==null?void 0:r.toString())||"",defaultReps:((l=s.default_reps)==null?void 0:l.toString())||""}}))}))}ensureIds(e){return e.map(a=>({...a,id:a.id||lt()}))}async loadWeek(e,a=!1){if(!/^\\d{4}-W(0[1-9]|[1-4]\\d|5[0-3])$/.test(e)){this.showMessage("Invalid week format");return}this.showWeekSelector=!1,this.currentWeek=e,this.dateRange=this.getWeekDateRange(this.parseISOWeek(e));let s=await this.fetchPlannerRecord(e),n;s!=null&&s.template_id?n=await this.fetchTemplateById(s.template_id):n=await this.fetchTemplate("default"),this.applyTemplateStructure(n),s&&this.overlayUserData(s),this.calculateScores(),a&&!this.times.some(r=>r.value)&&await this.getPrayerTimes(),this.lastSavedState=JSON.stringify(this.getCurrentUserData()),a&&(this.isInitializing=!1)}async fetchPlannerRecord(e){if(this.isOnline)try{return await this.pb.collection("planners").getFirstListItem(`week_id="${e}"`)}catch{}const a=localStorage.getItem(`planner_${e}`);if(a)try{return JSON.parse(a)}catch{}return null}async fetchTemplateById(e){try{return await this.pb.collection("templates").getOne(e)}catch{return await this.fetchTemplate("default")}}overlayUserData(e){var a;e.title&&(this.plannerTitle=e.title),e.city&&(this.city=e.city),e.prayer_times&&this.overlayArray(this.times,e.prayer_times),e.schedule_data&&this.overlayComplexData(this.schedule,e.schedule_data,"name",this.overlayScheduleActivity),e.tasks_data&&this.overlayArray(this.tasks,e.tasks_data),e.workout_data&&this.overlayComplexData(this.workoutPlan,e.workout_data,"name",this.overlayWorkoutExercise),e.meals_data&&this.overlayArray(this.meals,e.meals_data),(a=e.grocery_data)!=null&&a.categories&&this.overlayArray(this.groceryList,e.grocery_data.categories),e.measurements_data&&this.overlayArray(this.bodyMeasurements,e.measurements_data),e.financials_data&&this.overlayArray(this.financials,e.financials_data)}overlayArray(e,a){a.forEach((s,n)=>{e[n]&&Object.assign(e[n],s)})}overlayComplexData(e,a,s,n){a.forEach(r=>{const l=e.find(c=>c[s]===r[s]);l&&n.call(this,l,r)})}overlayScheduleActivity(e,a){var s;(s=a.activities)==null||s.forEach(n=>{const r=e.activities.find(l=>l.name===n.name);r&&(n.days&&Object.keys(r.days).forEach(l=>{n.days[l]&&(r.days[l].value=n.days[l].value||"")}),r.score=n.score||0,r.streaks=n.streaks||{current:0,longest:0})})}overlayWorkoutExercise(e,a){var s;(s=a.exercises)==null||s.forEach(n=>{const r=e.exercises.find(l=>l.name===n.name);r&&(r.weight=n.weight||"",r.sets=n.sets||"",r.reps=n.reps||"")})}getCurrentUserData(){var e,a,s,n;return{week_id:this.currentWeek,template_id:this.currentTemplateId,title:this.plannerTitle!==((a=(e=this.currentTemplate)==null?void 0:e.structure)==null?void 0:a.title_default)?this.plannerTitle:null,city:this.city!==((n=(s=this.currentTemplate)==null?void 0:s.structure)==null?void 0:n.city_default)?this.city:null,date_range:this.dateRange,prayer_times:this.times.some(r=>r.value)?this.times:null,schedule_data:this.extractScheduleData(),tasks_data:this.extractUserTasks(),workout_data:this.extractWorkoutData(),meals_data:this.extractUserItems(this.meals,["name","ingredients"]),grocery_data:this.extractGroceryData(),measurements_data:this.extractUserItems(this.bodyMeasurements,["value"]),financials_data:this.extractUserItems(this.financials,["value"])}}extractScheduleData(){return this.extractComplexData(this.schedule,e=>({name:e.name,activities:e.activities.map(a=>({name:a.name,days:Object.keys(a.days).reduce((s,n)=>(a.days[n].value&&(s[n]={value:a.days[n].value}),s),{}),score:a.score,streaks:a.streaks})).filter(a=>Object.keys(a.days).length>0||a.score>0)}),e=>e.activities.length>0)}extractUserTasks(){return this.tasks.filter(e=>e.priority||e.tag||e.description||e.startDate||e.expectedDate||e.actualDate||e.completed)}extractWorkoutData(){return this.extractComplexData(this.workoutPlan,e=>({name:e.name,exercises:e.exercises.filter(a=>a.weight||a.sets||a.reps).map(a=>({name:a.name,weight:a.weight,sets:a.sets,reps:a.reps}))}),e=>e.exercises.length>0)}extractComplexData(e,a,s=()=>!0){return e.map(a).filter(s)}extractUserItems(e,a){return e.filter(s=>a.some(n=>s[n]))}extractGroceryData(){const e=this.extractUserItems(this.groceryList,["name","items"]);return e.length>0?{categories:e}:null}getTaskDelay(e){if(!e.expectedDate||!e.actualDate)return 0;const a=new Date(e.expectedDate),s=new Date(e.actualDate);return Math.ceil((s-a)/(1e3*60*60*24))}calculateTaskDelay(e){return e._delay=this.getTaskDelay(e),e._delay}formatDelay(e){return e===0?"0d":e>0?`+${e}d`:`${e}d`}toggleTaskCompletion(e){e.completed=e.completed==="✓"?"☐":"✓",e.completed==="✓"&&!e.actualDate&&(e.actualDate=new Date().toISOString().split("T")[0],this.calculateTaskDelay(e)),this.saveData()}toggleSelector(e,a){const s=a==="city"?"showCitySelector":"showWeekSelector",n=a==="city"?"showWeekSelector":"showCitySelector";if(this[n]=!1,this[s])this[s]=!1;else{const r=e.target.getBoundingClientRect();this[`${a}DropdownStyle`]=`position:fixed;top:${r.bottom+4}px;left:${Math.max(10,r.left-100)}px;z-index:9999;min-width:150px;max-width:250px;`,this[s]=!0,a==="week"&&this.fetchSavedWeeks()}}async selectCity(e){this.city=e.name,this.showCitySelector=!1;try{e.lat===null?await this.getPrayerTimes():await this.fetchPrayerTimes(e.lat,e.lon),this.saveData()}catch{this.showMessage("Failed to load prayer times")}}async getPrayerTimes(){var e,a,s;try{const n=await new Promise((c,o)=>navigator.geolocation.getCurrentPosition(c,o,{timeout:5e3,maximumAge:6e4})),{latitude:r,longitude:l}=n.coords;try{const c=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${r}&lon=${l}&zoom=10&accept-language=en`)).json();this.city=((e=c.address)==null?void 0:e.city)||((a=c.address)==null?void 0:a.town)||((s=c.address)==null?void 0:s.village)||"Current Location"}catch{this.city="Current Location"}await this.fetchPrayerTimes(r,l)}catch{this.showMessage("Location access failed. Using London"),this.city="London",await this.fetchPrayerTimes(51.5074,-.1278)}}async fetchPrayerTimes(e,a){var s,n;const r=new Date,l=`prayer_times_${`${r.getFullYear()}_${r.getMonth()+1}_${r.getDate()}`}_${e.toFixed(2)}_${a.toFixed(2)}`,c=localStorage.getItem(l);if(c)try{this.setPrayerTimes(JSON.parse(c));return}catch{localStorage.removeItem(l)}try{const o=await fetch(`https://api.aladhan.com/v1/calendar/${r.getFullYear()}/${r.getMonth()+1}?latitude=${e}&longitude=${a}&method=2`);if(!o.ok)throw new Error(`API error: ${o.status}`);const d=await o.json();if(d.code===200&&(n=(s=d.data)==null?void 0:s[r.getDate()-1])!=null&&n.timings)localStorage.setItem(l,JSON.stringify(d.data[r.getDate()-1].timings)),this.setPrayerTimes(d.data[r.getDate()-1].timings);else throw new Error("Invalid prayer time data")}catch{this.showMessage("Prayer times fetch failed"),this.setPrayerTimes({Fajr:"05:30",Dhuhr:"12:30",Asr:"15:45",Maghrib:"18:30",Isha:"20:00"})}}setPrayerTimes(e){const a={Q:this.calculateQiyamTime(e.Fajr),F:e.Fajr,D:e.Dhuhr,A:e.Asr,M:e.Maghrib,I:e.Isha};this.times.reduce((s,n)=>{const r=this.formatTime(a[n.label]);return n.value!==r?(n.value=r,!0):s},!1)&&!this.isInitializing&&this.saveData()}formatTime(e){if(!e)return"";const[a,s]=e.split(" ")[0].split(":"),n=parseInt(a),r=parseInt(s);return isNaN(n)||isNaN(r)?"":`${n%12||12}:${r.toString().padStart(2,"0")}${n>=12?"PM":"AM"}`}calculateQiyamTime(e){if(!e)return"";const[a,s]=e.split(" ")[0].split(":");let n=parseInt(a),r=parseInt(s);return isNaN(n)||isNaN(r)?"":(n=n-1,n<0&&(n=23),`${n}:${r.toString().padStart(2,"0")}`)}calculateScores(){var e;const a={mon:0,tue:0,wed:0,thu:0,fri:0,sat:0,sun:0},s=Object.keys(a);this.schedule.forEach(r=>{r.name!=="TOTAL"&&r.activities.forEach(l=>{let c=0;Object.entries(l.days||{}).forEach(([u,v])=>{if(!v)return;const g=parseInt(v.value)||0;g>0&&(v.max||0)>0&&(a[u]+=g,c+=g),v.value=g===0?"":g.toString()}),l.score=c,l.streaks=l.streaks||{current:0,longest:0};const o=this.currentDay===0?6:this.currentDay-1;let d=0;for(let u=0;u<7;u++){const v=(o-u+7)%7,g=s[v];if(l.days[g]&&parseInt(l.days[g].value)>0&&(l.days[g].max||0)>0)d++;else break}l.streaks.current=d,l.streaks.longest=Math.max(l.streaks.longest||0,d)})});const n=this.schedule.find(r=>r.name==="TOTAL");if((e=n==null?void 0:n.activities)!=null&&e[0]){const r=n.activities[0];let l=0,c=0;Object.entries(a).forEach(([o,d])=>{var u;(u=r.days)!=null&&u[o]&&(r.days[o].value=d.toString()),l+=d}),this.schedule.forEach(o=>{o.name!=="TOTAL"&&o.activities.forEach(d=>c+=d.maxScore||0)}),r.score=l,r.maxScore=c}}validateAndSave(e){const a=e.target,s=parseFloat(a.min),n=parseFloat(a.max);let r=parseFloat(a.value);isNaN(r)&&(r=0),!isNaN(s)&&r<s&&(r=s),!isNaN(n)&&r>n&&(r=n),a.value=r===0?"":r.toString(),this.calculateScores(),this.saveData()}saveData(){this.isInitializing||(clearTimeout(this.saveTimeout),this.saveStatus="saving",this.saveTimeout=setTimeout(async()=>{try{this.calculateScores();const e=this.getCurrentUserData();localStorage.setItem(`planner_${this.currentWeek}`,JSON.stringify(e)),this.isOnline?(await this.saveToPocketbase(this.currentWeek,e),this.pendingSync=this.pendingSync.filter(a=>!(a.weekId===this.currentWeek&&a.operation!=="delete"))):this.addToPendingSync(this.currentWeek,e),localStorage.setItem("planner_pending_sync",JSON.stringify(this.pendingSync)),this.lastSavedState=JSON.stringify(e),this.saveStatus="saved"}catch(e){this.saveStatus="error",this.showMessage("Save error: "+e.message),setTimeout(()=>this.saveStatus="saved",3e3)}},500))}hasSignificantChanges(){if(!this.lastSavedState)return!0;const e=this.getCurrentUserData();return JSON.stringify(e)!==this.lastSavedState}addToPendingSync(e,a,s="save"){this.pendingSync=this.pendingSync.filter(n=>!(n.weekId===e&&n.operation===s)),this.pendingSync.push({weekId:e,data:a?JSON.parse(JSON.stringify(a)):null,operation:s,timestamp:new Date().toISOString()}),localStorage.setItem("planner_pending_sync",JSON.stringify(this.pendingSync))}async syncPendingData(){if(!this.isOnline||this.pendingSync.length===0)return;const e=[...this.pendingSync];this.pendingSync=[];for(const a of e)try{a.operation==="delete"?await this.deleteFromPocketbase(a.weekId):await this.saveToPocketbase(a.weekId,a.data);const s=JSON.parse(localStorage.getItem("planner_pending_sync")||"[]");localStorage.setItem("planner_pending_sync",JSON.stringify(s.filter(n=>n.timestamp!==a.timestamp)))}catch{this.pendingSync.push(a)}this.pendingSync.length>0&&localStorage.setItem("planner_pending_sync",JSON.stringify(this.pendingSync))}async saveToPocketbase(e,a){try{const s=await this.pb.collection("planners").getFirstListItem(`week_id="${e}"`);await this.pb.collection("planners").update(s.id,a)}catch(s){if(s.status===404)await this.pb.collection("planners").create(a);else throw s}}async deleteFromPocketbase(e){try{const a=await this.pb.collection("planners").getFirstListItem(`week_id="${e}"`);await this.pb.collection("planners").delete(a.id)}catch(a){if(a.status!==404)throw a}}async fetchSavedWeeks(){const e=new Map,a=this.getCurrentIsoWeek(),s=(n,r,l,c)=>{const o=e.get(n),d=r||this.getWeekDateRange(this.parseISOWeek(n));!o||l==="pocketbase"&&o.source!=="pocketbase"||l==="local"&&o.source==="current"?e.set(n,{iso_week:n,dateRange:d,source:l,isCurrent:c}):o&&!o.dateRange&&d&&(o.dateRange=d)};if(s(a,this.getWeekDateRange(this.parseISOWeek(a)),"current",!0),this.isOnline)try{(await this.pb.collection("planners").getFullList({sort:"-week_id",fields:"week_id,date_range"})).forEach(n=>s(n.week_id,n.date_range,"pocketbase",n.week_id===a))}catch{}for(let n=0;n<localStorage.length;n++){const r=localStorage.key(n);if(r.startsWith("planner_")&&!r.includes("pending_sync")&&!r.startsWith("planner_template_")){const l=r.replace("planner_","");try{const c=JSON.parse(localStorage.getItem(r));s(l,c.date_range,"local",l===a)}catch{}}}this.savedWeeks=Array.from(e.values()).sort((n,r)=>n.isCurrent&&!r.isCurrent?-1:!n.isCurrent&&r.isCurrent?1:r.iso_week.localeCompare(n.iso_week))}confirmLoadWeek(e){this.hasSignificantChanges()&&e!==this.currentWeek&&!confirm("Unsaved changes. Load anyway?")||(this.showWeekSelector=!1,this.loadWeek(e))}confirmDeleteWeek(e){confirm(`Delete schedule for ${e}?`)&&this.deleteWeek(e)}async deleteWeek(e){if(localStorage.removeItem(`planner_${e}`),this.isOnline)try{await this.deleteFromPocketbase(e)}catch{this.addToPendingSync(e,null,"delete")}else this.addToPendingSync(e,null,"delete");this.savedWeeks=this.savedWeeks.filter(a=>a.iso_week!==e),this.currentWeek===e&&(this.currentWeek=this.getCurrentIsoWeek(),await this.loadWeek(this.currentWeek))}getCurrentIsoWeek(){const e=new Date,a=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()));a.setUTCDate(a.getUTCDate()+4-(a.getUTCDay()||7));const s=new Date(Date.UTC(a.getUTCFullYear(),0,1)),n=Math.ceil(((a-s)/864e5+1)/7);return`${a.getUTCFullYear()}-W${n.toString().padStart(2,"0")}`}parseISOWeek(e){if(!/^\\d{4}-W(0[1-9]|[1-4]\\d|5[0-3])$/.test(e))return new Date;const[a,s]=e.split("-"),n=parseInt(s.substring(1)),r=new Date(Date.UTC(parseInt(a),0,1+(n-1)*7));return r.setUTCDate(r.getUTCDate()-(r.getUTCDay()||7)+1),r}getWeekDateRange(e){const a=new Date(e),s=new Date(a);return s.setUTCDate(a.getUTCDate()+6),`${this.formatDate(a)}-${this.formatDate(s)}`}formatDate(e){return`${(e.getUTCMonth()+1).toString().padStart(2,"0")}/${e.getUTCDate().toString().padStart(2,"0")}`}showMessage(e){this.notificationMessage=e,this.showNotification=!0,clearTimeout(this.notificationTimeout),this.notificationTimeout=setTimeout(()=>this.showNotification=!1,5e3)}}kt=new WeakMap,Dt=new WeakMap,Tt=new WeakMap,It=new WeakMap,Ot=new WeakMap,Ct=new WeakMap,Mt=new WeakMap,At=new WeakMap,Nt=new WeakMap,Wt=new WeakMap,Pt=new WeakMap,Et=new WeakMap,Rt=new WeakMap,Lt=new WeakMap,Ft=new WeakMap,$t=new WeakMap,Ut=new WeakMap,qt=new WeakMap,jt=new WeakMap,zt=new WeakMap,Bt=new WeakMap,Jt=new WeakMap,Yt=new WeakMap,Gt=new WeakMap,Vt=new WeakMap,Ht=new WeakMap,Kt=new WeakMap,Qt=new WeakMap;const f=new Rr;window.plannerStore=f;Pn();var Lr=()=>f.saveData(),Fr=W('<div class="flex center"><span> </span> <input type="text" class="input input--time"/></div>'),$r=t=>f.toggleSelector(t,"city"),Ur=t=>f.toggleSelector(t,"week"),qr=W('<div class="flex between center mb-1"><h1 class="text-sm bold"> </h1> <div class="flex center text-xs"><!> <span class="ml-1">|</span> <span class="clickable ml-1"> </span></div> <div class="text-sm"><span class="clickable"> </span> <span> </span></div></div>');function jr(t,e){de(e,!1),Ie();var a=qr(),s=p(a),n=p(s),r=m(s,2),l=p(r);se(l,1,()=>(P(f),_(()=>f.times)),Ue,(w,D,y)=>{var k=Fr(),x=p(k),I=p(x),N=m(x,2);N.__change=[Lr],q(()=>A(I,`${i(D),_(()=>i(D).label)??""}:`)),Z(N,()=>i(D).value,R=>(i(D).value=R,ae(()=>f))),C(w,k)});var c=m(l,4);c.__click=[$r];var o=p(c),d=m(r,2),u=p(d);u.__click=[Ur];var v=p(u),g=m(u,2),h=p(g);q(()=>{A(n,(P(f),_(()=>f.plannerTitle))),A(o,(P(f),_(()=>f.city))),A(v,(P(f),_(()=>f.currentWeek))),A(h,(P(f),_(()=>f.dateRange)))}),C(t,a),ve()}Be(["change","click"]);var zr=W("<th> </th> <th>MAX</th>",1),Br=t=>f.validateAndSave(t),Jr=W('<input type="number" class="input" min="0"/>'),Yr=W("<td><!></td> <td> </td>",1),Gr=W("<span> </span>"),Vr=W('<tr><td class="bold"> </td><td class="bold"> </td><td class="ac"><span> </span></td><!><td class="dc"><input type="number" class="input" readonly=""/></td><td class="dc"> </td><td><!></td></tr>'),Hr=W('<tr><td colspan="19" class="progress"><div></div></td></tr>'),Kr=W("<!> <!>",1),Qr=W('<table><thead><tr><th style="width:18mm">T</th><th style="width:20mm">D</th><th class="ac">ACTIVITY</th><!><th class="dc">📊</th><th class="dc">🎯</th><th class="dc">🔥</th></tr></thead><tbody></tbody></table>');function Xr(t,e){de(e,!1);const a=["M","T","W","T","F","S","S"],s=["mon","tue","wed","thu","fri","sat","sun"];Ie();var n=Qr(),r=p(n),l=p(r),c=m(p(l),3);se(c,1,()=>a,Ue,(d,u,v)=>{var g=zr(),h=Pe(g);let w;var D=p(h),y=m(h,2);let k;q((x,I)=>{w=X(h,1,"dc",null,w,x),A(D,i(u)),k=X(y,1,"dc",null,k,I)},[()=>({"current-day":v===(f.currentDay||7)-1}),()=>({"current-day":v===(f.currentDay||7)-1})],Ne),C(d,g)});var o=m(r);se(o,5,()=>(P(f),_(()=>[...f.schedule].reverse())),Ue,(d,u)=>{var v=Kr(),g=Pe(v);se(g,1,()=>(i(u),_(()=>i(u).activities)),Ue,(D,y,k)=>{var x=Vr();let I;var N=p(x),R=p(N),j=m(N),U=p(j),M=m(j),L=p(M),Oe=p(L),le=m(M);se(le,1,()=>s,Ue,(ee,z,_e)=>{var Y=Yr(),Ye=Pe(Y);let Xe;var Ze=p(Ye);{var ha=Ge=>{var Se=Jr();Se.__input=[Br],q(()=>{qe(Se,"max",(i(y),i(z),_(()=>i(y).days[i(z)].max<10?9:99))),Se.readOnly=(i(u),_(()=>i(u).name==="TOTAL"))}),Z(Se,()=>i(y).days[i(z)].value,et=>(i(y).days[i(z)].value=et,ae(()=>(i(u),f)))),C(Ge,Se)};ue(Ze,Ge=>{i(y),i(z),_(()=>i(y).days&&i(y).days[i(z)])&&Ge(ha)})}var mt=m(Ye,2);let gt;var ma=p(mt);q((Ge,Se)=>{Xe=X(Ye,1,"dc",null,Xe,Ge),gt=X(mt,1,"dc",null,gt,Se),A(ma,(i(y),i(z),_(()=>{var et,it;return((it=(et=i(y).days)==null?void 0:et[i(z)])==null?void 0:it.max)||""})))},[()=>({"current-day":_e===(f.currentDay||7)-1}),()=>({"current-day":_e===(f.currentDay||7)-1})],Ne),C(ee,Y)});var Q=m(le),Ce=p(Q),fe=m(Q),re=p(fe),pe=m(fe);let Le;var Me=p(pe);{var Je=ee=>{var z=Gr(),_e=p(z);q(()=>A(_e,(i(y),_(()=>i(y).streaks.current)))),C(ee,z)};ue(Me,ee=>{i(y),_(()=>{var z;return((z=i(y).streaks)==null?void 0:z.current)>0})&&ee(Je)})}q((ee,z,_e,Y)=>{I=X(x,1,"",null,I,ee),A(R,(i(u),_(()=>k===0?i(u).name:""))),A(U,z),A(Oe,_e),Vs(Ce,(i(y),_(()=>i(y).score))),A(re,(i(y),_(()=>i(y).maxScore))),Le=X(pe,1,"dc cell cell--color",null,Le,Y)},[()=>({total:i(u).name==="TOTAL"}),()=>(i(y),_(()=>i(y).name.includes(":")?i(y).name.split(":")[0]:"")),()=>(i(y),_(()=>i(y).name.includes(":")?i(y).name.split(":")[1].trim():i(y).name)),()=>{var ee,z;return{streak:((ee=i(y).streaks)==null?void 0:ee.current)>2,yellow:((z=i(y).streaks)==null?void 0:z.current)>2}}],Ne),C(D,x)});var h=m(g,2);{var w=D=>{var y=Hr();const k=Ne(()=>(i(u),_(()=>i(u).activities[0]))),x=Ne(()=>(P(i(k)),_(()=>i(k).maxScore>0?Math.min(100,i(k).score/i(k).maxScore*100):0))),I=Ne(()=>(P(i(k)),_(()=>i(k).maxScore>0?i(k).score/i(k).maxScore<.33?"progress--low":i(k).score/i(k).maxScore<.66?"progress--medium":"progress--high":"")));var N=p(y),R=p(N);q(()=>{X(R,1,`progress__bar ${i(I)??""}`),oa(R,`width: ${i(x)??""}%`)}),C(D,y)};ue(h,D=>{i(u),_(()=>{var y;return i(u).name==="TOTAL"&&((y=i(u).activities)==null?void 0:y.length)>0&&i(u).activities[0].maxScore>0})&&D(w)})}C(d,v)}),C(t,n),ve()}Be(["input"]);var Zr=()=>f.saveData(),ei=()=>f.saveData(),ti=()=>f.saveData(),ai=W('<tr><td class="dc"> </td><td><select class="input"><option></option><option>A</option><option>B</option><option>C</option><option>D</option></select></td><td><input type="text" class="input input--text"/></td><td><select class="input"><option></option><option>Personal</option><option>Work</option></select></td><td><input type="text" class="input input--date"/></td><td><input type="text" class="input input--date"/></td><td><span> </span></td><td><input type="text" class="input input--date"/></td><td><input type="text" placeholder="☐" readonly=""/></td></tr>'),si=W('<div class="section"><h3 class="title">TASKS & PROJECT MANAGEMENT</h3> <table><thead><tr><th>#</th><th>⭐</th><th>Task</th><th>🏷️</th><th class="icon-header">Start</th><th class="icon-header">Due</th><th class="icon-header">Delay</th><th class="icon-header">Done</th><th>✓</th></tr></thead><tbody></tbody></table></div>');function ni(t,e){de(e,!1);function a(c){const o=[];c.completed==="✓"&&o.push("green");const d=f.getTaskDelay(c);return d>0?o.push("red"):d<0&&o.push("blue"),o.join(" ")}function s(c){return c<0?"green":c>0?"red":"yellow"}Ie();var n=si(),r=m(p(n),2),l=m(p(r));se(l,7,()=>(P(f),_(()=>f.tasks)),(c,o)=>c.id||o,(c,o,d)=>{var u=ai(),v=p(u),g=p(v),h=m(v),w=p(h);q(()=>{i(o),ae(()=>{})}),w.__change=[Zr];var D=p(w);D.value=D.__value="";var y=m(D);y.value=y.__value="A";var k=m(y);k.value=k.__value="B";var x=m(k);x.value=x.__value="C";var I=m(x);I.value=I.__value="D";var N=m(h),R=p(N);R.__change=[ei];var j=m(N),U=p(j);q(()=>{i(o),ae(()=>{})}),U.__change=[ti];var M=p(U);M.value=M.__value="";var L=m(M);L.value=L.__value="P";var Oe=m(L);Oe.value=Oe.__value="W";var le=m(j),Q=p(le);Q.__change=()=>{f.calculateTaskDelay(i(o)),f.saveData()};var Ce=m(le),fe=p(Ce);fe.__change=()=>{f.calculateTaskDelay(i(o)),f.saveData()};var re=m(Ce),pe=p(re),Le=p(pe),Me=m(re),Je=p(Me);Je.__change=()=>{f.calculateTaskDelay(i(o)),f.saveData()};var ee=m(Me),z=p(ee);let _e;z.__click=Y=>{Y.preventDefault(),f.toggleTaskCompletion(i(o))},q((Y,Ye,Xe,Ze)=>{X(u,1,Y),A(g,i(d)+1),X(re,1,`dc cell cell--bold ${Ye??""}`),A(Le,Xe),_e=X(z,1,"input",null,_e,Ze),Vs(z,(i(o),_(()=>i(o).completed)))},[()=>Tr((i(o),_(()=>a(i(o))))),()=>(P(f),i(o),_(()=>s(f.getTaskDelay(i(o))))),()=>(P(f),i(o),_(()=>f.formatDelay(f.getTaskDelay(i(o))))),()=>({"task-done":i(o).completed==="✓"})],Ne),vs(w,()=>i(o).priority,Y=>(i(o).priority=Y,ae(()=>f))),Z(R,()=>i(o).description,Y=>(i(o).description=Y,ae(()=>f))),vs(U,()=>i(o).tag,Y=>(i(o).tag=Y,ae(()=>f))),Z(Q,()=>i(o).startDate,Y=>(i(o).startDate=Y,ae(()=>f))),Z(fe,()=>i(o).expectedDate,Y=>(i(o).expectedDate=Y,ae(()=>f))),Z(Je,()=>i(o).actualDate,Y=>(i(o).actualDate=Y,ae(()=>f))),C(c,u)}),C(t,n),ve()}Be(["change","click"]);var ri=()=>f.saveData(),ii=()=>f.saveData(),li=()=>f.saveData(),oi=W('<div class="exercise"><div class="exercise-name"><span> </span> <span> </span>:</div> <div class="exercise-inputs"><input type="number" class="input"/> <span class="exercise-unit">kg,</span> <input type="number" class="input sets"/> <span class="exercise-unit">×</span> <input type="number" class="input reps"/></div></div>'),ci=W('<div class="p-1 workout-day-card"><p class="bold text-center mb-1 workout-day-name"> </p> <!></div>'),ui=W('<div class="section"><h3 class="title">WORKOUT</h3> <div class="grid"></div></div>');function di(t,e){de(e,!1),Ie();var a=ui(),s=m(p(a),2);se(s,5,()=>(P(f),_(()=>f.workoutPlan)),n=>n.id,(n,r)=>{var l=ci(),c=p(l),o=p(c),d=m(c,2);se(d,1,()=>(i(r),_(()=>i(r).exercises)),u=>u.id,(u,v,g)=>{var h=oi(),w=p(h),D=p(w),y=p(D),k=m(D,2),x=p(k),I=m(w,2),N=p(I);N.__input=[ri];var R=m(N,4);R.__input=[ii];var j=m(R,4);j.__input=[li],q(()=>{qe(w,"title",`${i(v),_(()=>i(v).prefix)??""}${i(v),_(()=>i(v).name)??""}`),A(y,(i(v),_(()=>i(v).prefix))),A(x,(i(v),_(()=>i(v).name))),qe(N,"placeholder",(i(v),_(()=>i(v).defaultWeight))),qe(R,"placeholder",(i(v),_(()=>i(v).defaultSets))),qe(j,"placeholder",(i(v),_(()=>i(v).defaultReps)))}),Z(N,()=>i(v).weight,U=>(i(v).weight=U,ae(()=>(i(r),f)))),Z(R,()=>i(v).sets,U=>(i(v).sets=U,ae(()=>(i(r),f)))),Z(j,()=>i(v).reps,U=>(i(v).reps=U,ae(()=>(i(r),f)))),C(u,h)}),q(()=>A(o,(i(r),_(()=>i(r).name)))),C(n,l)}),C(t,a),ve()}Be(["input"]);var vi=W('<div class="mb-05"><span class="bold"> </span> <span> </span></div>'),fi=W('<div class="section"><h3 class="title">MEALS</h3> <div class="text-xs"></div></div>');function pi(t,e){de(e,!1),Ie();var a=fi(),s=m(p(a),2);se(s,5,()=>(P(f),_(()=>f.meals)),n=>n.id,(n,r)=>{var l=vi(),c=p(l),o=p(c),d=m(c,2),u=p(d);q(()=>{A(o,`${i(r),_(()=>i(r).name)??""}:`),A(u,(i(r),_(()=>i(r).ingredients)))}),C(n,l)}),C(t,a),ve()}var hi=W('<div class="mb-05"><span class="bold"> </span> <span> </span></div>'),mi=W('<div class="section"><h3 class="title">GROCERY</h3> <div class="text-xs"></div></div>');function gi(t,e){de(e,!1),Ie();var a=mi(),s=m(p(a),2);se(s,5,()=>(P(f),_(()=>f.groceryList)),n=>n.id,(n,r)=>{var l=hi(),c=p(l),o=p(c),d=m(c,2),u=p(d);q(()=>{A(o,`${i(r),_(()=>i(r).name)??""}:`),A(u,(i(r),_(()=>i(r).items)))}),C(n,l)}),C(t,a),ve()}var yi=()=>f.saveData(),_i=W('<span><span> </span> <input type="text" class="input input--inline"/> <!></span>'),wi=W('<div class="section"><h3 class="title">BODY</h3> <div class="text-xs"></div></div>');function Si(t,e){de(e,!1),Ie();var a=wi(),s=m(p(a),2);se(s,7,()=>(P(f),_(()=>f.bodyMeasurements)),n=>n.id,(n,r,l)=>{var c=_i(),o=p(c),d=p(o),u=m(o,2);u.__change=[yi];var v=m(u,2);{var g=h=>{var w=Js(",");C(h,w)};ue(v,h=>{P(i(l)),P(f),_(()=>i(l)<f.bodyMeasurements.length-1)&&h(g)})}q(()=>{A(d,`${i(r),_(()=>i(r).name)??""}:`),qe(u,"placeholder",(i(r),_(()=>i(r).placeholder)))}),Z(u,()=>i(r).value,h=>(i(r).value=h,ae(()=>f))),C(n,c)}),C(t,a),ve()}Be(["change"]);var xi=()=>f.saveData(),bi=W('<span><span> </span> £<input type="text" class="input input--inline"/> <span> </span> <!></span>'),ki=W('<div class="section"><h3 class="title">FINANCIAL</h3> <div class="text-xs"></div></div>');function Di(t,e){de(e,!1),Ie();var a=ki(),s=m(p(a),2);se(s,7,()=>(P(f),_(()=>f.financials)),n=>n.id,(n,r,l)=>{var c=bi(),o=p(c),d=p(o),u=m(o,2);u.__change=[xi];var v=m(u,2),g=p(v),h=m(v,2);{var w=D=>{var y=Js(",");C(D,y)};ue(h,D=>{P(i(l)),P(f),_(()=>i(l)<f.financials.length-1)&&D(w)})}q(()=>{A(d,`${i(r),_(()=>i(r).name)??""}:`),qe(u,"placeholder",(i(r),_(()=>i(r).placeholder))),A(g,(i(r),_(()=>i(r).account)))}),Z(u,()=>i(r).value,D=>(i(r).value=D,ae(()=>f))),C(n,c)}),C(t,a),ve()}Be(["change"]);var Ti=W('<div id="sync-status"><span> </span></div>'),Ii=W('<div id="notification" class="notification notification--show"> </div>'),Oi=W('<div id="save-status"> </div> <!> <!>',1);function Ci(t,e){de(e,!1),Ie();var a=Oi(),s=Pe(a),n=p(s),r=m(s,2);{var l=d=>{var u=Ti(),v=p(u),g=p(v);q(()=>{X(u,1,`status status--sync ${P(f),_(()=>f.pendingSync.length>0?"status-pending":"status-synced")??""}`),A(g,(P(f),_(()=>f.isOnline?f.pendingSync.length>0?"Pending: "+f.pendingSync.length:"":"Offline")))}),C(d,u)};ue(r,d=>{P(f),_(()=>f.pendingSync.length>0||!f.isOnline)&&d(l)})}var c=m(r,2);{var o=d=>{var u=Ii(),v=p(u);q(()=>A(v,(P(f),_(()=>f.notificationMessage)))),C(d,u)};ue(c,d=>{P(f),_(()=>f.showNotification)&&d(o)})}q(()=>{X(s,1,`status status--save status-${P(f),_(()=>f.saveStatus)??""}`),A(n,(P(f),_(()=>f.saveStatus==="saving"?"Saving...":f.saveStatus==="error"?"Error!":"Saved")))}),C(t,a),ve()}var Mi=(t,e)=>f.selectCity(i(e)),Ai=W('<div class="dropdown__item"> </div>'),Ni=W('<div class="dropdown-portal"><div class="dropdown__content"></div></div>'),Wi=(t,e)=>f.confirmLoadWeek(i(e).iso_week),Pi=(t,e)=>f.confirmDeleteWeek(i(e).iso_week),Ei=W('<div><span> </span> <span class="dropdown__delete">×</span></div>'),Ri=W('<div class="dropdown__item--empty">No saved schedules</div>'),Li=W('<div class="dropdown-portal"><div class="dropdown__content"><!></div></div>'),Fi=W("<!> <!>",1);function $i(t,e){de(e,!1),Ie();var a=Fi(),s=Pe(a);{var n=c=>{var o=Ni(),d=p(o);se(d,5,()=>(P(f),_(()=>f.cityOptions)),Ue,(u,v)=>{var g=Ai();g.__click=[Mi,v];var h=p(g);q(()=>A(h,(i(v),_(()=>i(v).name)))),C(u,g)}),q(()=>oa(o,(P(f),_(()=>f.cityDropdownStyle)))),C(c,o)};ue(s,c=>{P(f),_(()=>f.showCitySelector)&&c(n)})}var r=m(s,2);{var l=c=>{var o=Li(),d=p(o),u=p(d);{var v=h=>{var w=gr(),D=Pe(w);se(D,1,()=>(P(f),_(()=>f.savedWeeks)),Ue,(y,k)=>{var x=Ei();let I;var N=p(x);N.__click=[Wi,k];var R=p(N),j=m(N,2);j.__click=[Pi,k],q(U=>{I=X(x,1,"flex between center dropdown__item",null,I,U),A(R,`${i(k),_(()=>i(k).iso_week)??""} ${i(k),_(()=>i(k).dateRange)??""}`)},[()=>({"dropdown__item--current":i(k).isCurrent})],Ne),C(y,x)}),C(h,w)},g=h=>{var w=Ri();C(h,w)};ue(u,h=>{P(f),_(()=>f.savedWeeks.length>0)?h(v):h(g,!1)})}q(()=>oa(o,(P(f),_(()=>f.weekDropdownStyle)))),C(c,o)};ue(r,c=>{P(f),_(()=>f.showWeekSelector)&&c(l)})}C(t,a),ve()}Be(["click"]);async function Ui(t,e,a,s){return e("Validating configuration...","i"),a()?s()?(e("✅ Validation passed","s"),!0):(e("❌ Seed validation failed","e"),!1):(e("❌ Collection validation failed","e"),!1)}async function qi(t,e,a,s,n){S(e,!0),S(a,"");try{(await fetch(`${i(s)}/api/health`)).ok?(S(a,"success"),n("✅ Connection successful","s")):(S(a,"error"),n("❌ Connection failed","e"))}catch(r){S(a,"error"),n(`❌ Connection error: ${r.message}`,"e")}finally{S(e,!1)}}async function ji(t,e,a,s){e(),S(a,!0);try{await s()}finally{S(a,!1)}}async function zi(t,e,a,s){e(),S(a,!0);try{await s()}finally{S(a,!1)}}function Bi(t,e,a,s,n,r,l){confirm("Reset all setup fields to defaults?")&&(e(),S(a,window.location.origin,!0),S(s,"admin@example.com"),S(n,"unifiedpassword"),r(),l("🔄 Reset to defaults","i"))}var Ji=(t,e)=>t.target===t.currentTarget&&e(),Yi=(t,e)=>S(e,!i(e)),Gi=(t,e)=>S(e,!0),Vi=W("<div> </div>"),Hi=(t,e)=>t.target===t.currentTarget&&S(e,!1),Ki=(t,e)=>S(e,!1),Qi=W(`<div class="setup-modal-overlay svelte-1vc718t" style="z-index: 11000;"><div class="setup-help-content svelte-1vc718t"><button class="setup-help-close svelte-1vc718t">✕ Close</button> <h1 class="svelte-1vc718t">📚 PocketBase Schema Reference</h1> <h2 class="svelte-1vc718t">🔧 Field Types & Properties</h2> <h3 class="svelte-1vc718t">Text Fields</h3> <pre class="svelte-1vc718t"></pre> <h3 class="svelte-1vc718t">Number Fields</h3> <pre class="svelte-1vc718t"></pre> <h3 class="svelte-1vc718t">Boolean Fields</h3> <pre class="svelte-1vc718t"></pre> <h3 class="svelte-1vc718t">JSON Fields</h3> <pre class="svelte-1vc718t"></pre> <h3 class="svelte-1vc718t">Relation Fields</h3> <pre class="svelte-1vc718t"></pre> <h2 class="svelte-1vc718t">📋 Collection Properties</h2> <pre class="svelte-1vc718t"></pre> <h2 class="svelte-1vc718t">🔒 API Rules</h2> <p class="svelte-1vc718t">Rules control who can access records via API. Common patterns:</p> <h3 class="svelte-1vc718t">Public Access</h3> <pre class="svelte-1vc718t"></pre> <h3 class="svelte-1vc718t">Authenticated Users</h3> <pre class="svelte-1vc718t"></pre> <h3 class="svelte-1vc718t">Owner Only Access</h3> <pre class="svelte-1vc718t"></pre> <h2 class="svelte-1vc718t">❌ CRITICAL ERRORS TO AVOID</h2> <h3 class="svelte-1vc718t">🚫 NEVER Use These Patterns (DEPRECATED)</h3> <pre class="error-example svelte-1vc718t"></pre> <h3 class="svelte-1vc718t">✅ CORRECT Patterns (Current PocketBase)</h3> <pre class="success-example svelte-1vc718t"></pre> <h2 class="svelte-1vc718t">💡 Pro Tips</h2> <ul class="svelte-1vc718t"><li class="svelte-1vc718t">Always include <code class="svelte-1vc718t">type</code>, <code class="svelte-1vc718t">required</code>, and <code class="svelte-1vc718t">presentable</code> for every field</li> <li class="svelte-1vc718t">Use <code class="svelte-1vc718t">indexes</code> for fields you'll search/filter frequently</li> <li class="svelte-1vc718t">JSON fields are powerful but can't be indexed - use wisely</li> <li class="svelte-1vc718t">Test your API rules thoroughly before production</li> <li class="svelte-1vc718t">Keep field names simple: lowercase, no spaces, underscores OK</li> <li class="svelte-1vc718t">Set reasonable <code class="svelte-1vc718t">maxSize</code> limits on JSON fields</li> <li class="svelte-1vc718t">Use <code class="svelte-1vc718t">pattern</code> for email, phone, or custom validation</li> <li class="svelte-1vc718t">Remember: empty string "" = public access, null = admin only</li></ul> <h2 class="svelte-1vc718t">🔍 Quick Validation Checklist</h2> <ol class="svelte-1vc718t"><li class="svelte-1vc718t">✓ Every field has: name, type, required, presentable</li> <li class="svelte-1vc718t">✓ Collection has: name, type, fields array</li> <li class="svelte-1vc718t">✓ No "options" wrapper on field properties</li> <li class="svelte-1vc718t">✓ No spaces or hyphens in field names</li> <li class="svelte-1vc718t">✓ API rules are either "", null, or valid expressions</li> <li class="svelte-1vc718t">✓ JSON is valid (no trailing commas, proper quotes)</li></ol></div></div>`),Xi=W('<div class="setup-modal-overlay svelte-1vc718t"><div class="setup-modal-content svelte-1vc718t"><div class="setup-container svelte-1vc718t"><div class="setup-stats svelte-1vc718t"><div class="setup-stat svelte-1vc718t"><span class="setup-stat-val svelte-1vc718t"> </span> Collections</div> <div class="setup-stat svelte-1vc718t"><span class="setup-stat-val svelte-1vc718t"> </span> Fields</div> <div class="setup-stat svelte-1vc718t"><span class="setup-stat-val svelte-1vc718t"> </span> Seeds</div> <div class="setup-stat svelte-1vc718t"><span class="setup-stat-val svelte-1vc718t"> </span> Health</div></div> <div class="setup-progress svelte-1vc718t"><div class="setup-progress-fill svelte-1vc718t"></div></div> <div class="setup-row svelte-1vc718t"><div class="setup-col svelte-1vc718t"><label for="setup-url" class="svelte-1vc718t">PocketBase URL:</label> <input id="setup-url" placeholder="http://localhost:8090" class="svelte-1vc718t"/></div> <div class="setup-col svelte-1vc718t"><label for="setup-email" class="svelte-1vc718t">Admin Email:</label> <input id="setup-email" placeholder="admin@example.com" class="svelte-1vc718t"/></div> <div class="setup-col svelte-1vc718t"><label for="setup-pass" class="svelte-1vc718t">Password:</label> <div style="position:relative;"><input id="setup-pass" style="padding-right: 30px;" class="svelte-1vc718t"/> <button type="button" class="setup-pass-toggle svelte-1vc718t"> </button></div></div></div> <div class="setup-row svelte-1vc718t"><button class="svelte-1vc718t"> </button> <button class="svelte-1vc718t">✅ Validate</button> <button class="svelte-1vc718t">🚀 Full Setup</button> <button class="svelte-1vc718t">📋 Schema Only</button> <button class="svelte-1vc718t">🌱 Seed Only</button> <button class="svelte-1vc718t">📚 Help & Docs</button></div> <div class="setup-row svelte-1vc718t"><button class="setup-danger svelte-1vc718t">🗑️ Reset</button> <button class="svelte-1vc718t">❌ Close</button></div> <div class="setup-row svelte-1vc718t"><div class="setup-col svelte-1vc718t"><h2 class="svelte-1vc718t">📋 Collections Schema</h2> <textarea class="setup-editor svelte-1vc718t" placeholder="Collections JSON..."></textarea> <div> </div></div> <div class="setup-col svelte-1vc718t"><h2 class="svelte-1vc718t">🌱 Seed Data</h2> <textarea class="setup-editor svelte-1vc718t" placeholder="Seed data JSON..."></textarea> <div> </div></div></div> <div id="setup-output" class="setup-output svelte-1vc718t"></div></div></div></div> <!>',1);function Zi(t,e){de(e,!0);let a=T(G(window.location.origin)),s=T("admin@example.com"),n=T("unifiedpassword"),r=T(!1),l=T(!1),c=T(0),o=G({collections:0,fields:0,seeds:0,health:"❓"}),d=G({validate:!0,setup:!0,schema:!0,seed:!0}),u=G({collections:{valid:!0,message:"Ready"},seeds:{valid:!0,message:"Ready"}}),v=T(""),g=T(""),h=T(G([])),w=T(""),D=T(!1),y=T(!1);function k(){f.showSetupModal=!1;const O=document.querySelector(".setup-notification");O&&O.remove()}function x(O,J="i"){const B=new Date().toLocaleTimeString(),H={e:"error",s:"success",w:"warning",i:"info"};S(h,[...i(h),{time:B,msg:O,type:H[J]||"info"}],!0),setTimeout(()=>{const K=document.getElementById("setup-output");K&&(K.scrollTop=K.scrollHeight)},10)}function I(O,J){S(c,O,!0),J&&x(J,"i")}function N(){try{const O=JSON.parse(i(v)),J=JSON.parse(i(g));o.collections=O.length,o.fields=O.reduce((B,H)=>{var K;return B+(((K=H.fields)==null?void 0:K.length)||0)},0),o.seeds=J.reduce((B,H)=>{var K;return B+(((K=H.records)==null?void 0:K.length)||0)},0)}catch{}}function R(O,J){try{return{valid:!0,message:"Valid JSON",data:JSON.parse(O)}}catch(B){const H=B.message.match(/position (\d+)/);return{valid:!1,message:`Invalid JSON${H?` at position ${H[1]}`:""}`}}}function j(){const O=R(i(v));return u.collections=O,N(),O.valid}function U(){const O=R(i(g));return u.seeds=O,N(),O.valid}function M(){S(h,[],!0)}async function L(){M(),S(y,!0);try{await Oe()&&await le()&&(x("🎉 Full setup complete!","s"),o.health="✅",setTimeout(()=>{k(),f.init()},2e3))}finally{S(y,!1)}}async function Oe(){var O;if(!j())return x("❌ Collection validation failed","e"),!1;I(20,"Setting up schema...");try{const J=window.PocketBase,B=new J(i(a));await B.admins.authWithPassword(i(s),i(n));const H=JSON.parse(i(v));I(40,"Importing collections..."),await B.collections.import(H,!1);const K=H.find(he=>he.name==="templates"),xe=H.find(he=>he.name==="planners");if(K&&xe){I(70,"Adding relations...");try{const he=await B.collections.getOne("templates"),Ae=await B.collections.getOne("planners"),we=Ae.fields.findIndex(be=>be.name==="template_id");if(we!==-1){const be=[...Ae.fields];be[we]={name:"template_id",type:"relation",required:!1,presentable:!0,collectionId:he.id,cascadeDelete:!1,minSelect:0,maxSelect:1,displayFields:["name","description"]},await B.collections.update(Ae.id,{fields:be}),x("✅ Updated template_id to relation field","s")}else x("⚠️ template_id field not found","w")}catch(he){x(`⚠️ Relation setup warning: ${he.message}`,"w")}}return I(100,"✅ Schema setup complete"),(O=B==null?void 0:B.authStore)!=null&&O.isValid&&B.authStore.clear(),!0}catch(J){return x(`❌ Schema error: ${J.message}`,"e"),o.health="❌",!1}}async function le(){var O,J,B,H;if(!U())return x("❌ Seed validation failed","e"),!1;I(10,"Seeding data...");try{const K=window.PocketBase,xe=new K(i(a));await xe.admins.authWithPassword(i(s),i(n));const he=JSON.parse(i(g));let Ae=0;for(const we of he){if(!we.collection||!we.records){x("⚠️ Invalid seed format","w");continue}I(30,`Seeding ${we.collection}...`);for(const be of we.records)try{await xe.collection(we.collection).create(be),Ae++}catch(tt){tt.status===400&&((B=(J=(O=tt.data)==null?void 0:O.data)==null?void 0:J.name)==null?void 0:B.code)==="validation_not_unique"?x(`ℹ️ Skipping duplicate: ${be.name||"record"}`,"i"):x(`⚠️ Seed error: ${tt.message}`,"w")}}return I(100,`✅ Seeded ${Ae} records`),(H=xe==null?void 0:xe.authStore)!=null&&H.isValid&&xe.authStore.clear(),!0}catch(K){return x(`❌ Seed error: ${K.message}`,"e"),!1}}function Q(){return[{name:"templates",type:"base",fields:[{name:"name",type:"text",required:!0,presentable:!0,min:1,max:50},{name:"description",type:"text",required:!1,presentable:!1,max:200},{name:"is_default",type:"bool",required:!1,presentable:!1},{name:"version",type:"number",required:!1,presentable:!1,min:1,noDecimal:!0},{name:"structure",type:"json",required:!0,presentable:!1,maxSize:5242880}],indexes:["CREATE UNIQUE INDEX idx_templates_name ON templates (name)"],listRule:"",viewRule:"",createRule:null,updateRule:null,deleteRule:null},{name:"planners",type:"base",fields:[{name:"week_id",type:"text",required:!0,presentable:!0,pattern:"^\\d{4}-W(0[1-9]|[1-4]\\d|5[0-3])$",min:8,max:8},{name:"template_id",type:"text",required:!1,presentable:!0,max:50},{name:"title",type:"text",required:!1,presentable:!1,max:100},{name:"city",type:"text",required:!1,presentable:!1,max:50},{name:"date_range",type:"text",required:!1,presentable:!1,max:20},{name:"prayer_times",type:"json",required:!1,presentable:!1,maxSize:2048},{name:"schedule_data",type:"json",required:!1,presentable:!1,maxSize:1048576},{name:"tasks_data",type:"json",required:!1,presentable:!1,maxSize:524288},{name:"workout_data",type:"json",required:!1,presentable:!1,maxSize:262144},{name:"meals_data",type:"json",required:!1,presentable:!1,maxSize:131072},{name:"grocery_data",type:"json",required:!1,presentable:!1,maxSize:131072},{name:"measurements_data",type:"json",required:!1,presentable:!1,maxSize:65536},{name:"financials_data",type:"json",required:!1,presentable:!1,maxSize:65536}],indexes:["CREATE UNIQUE INDEX idx_planners_week_id ON planners (week_id)"],listRule:"",viewRule:"",createRule:"",updateRule:"",deleteRule:""}]}function Ce(){return[{collection:"templates",records:[{name:"default",description:"Default weekly planner template with all sections",is_default:!0,version:5,structure:{prayer_times:[{label:"Q",value:"4:30AM"},{label:"F",value:"5:30AM"},{label:"D",value:"12:30PM"},{label:"A",value:"3:45PM"},{label:"M",value:"6:30PM"},{label:"I",value:"8:00PM"}],schedule:[{name:"QIYAM",activities:[{name:"DAILY: Wakeup early",max_per_day:1,max_score:7},{name:"DAILY: Qiyam/Tahajjud",max_per_day:1,max_score:7},{name:"DAILY: Nutty Pudding",max_per_day:1,max_score:7}]},{name:"FAJR",activities:[{name:"DAILY: Fajr prayer",max_per_day:1,max_score:7},{name:"DAILY: Quran - 1 Juz",max_per_day:1,max_score:7},{name:"DAILY: 5min Cold Shower",max_per_day:1,max_score:7}]},{name:"7AM - 9AM",activities:[{name:"MON/THU: COMMUTE",days:["mon","thu"],max_per_day:1,max_score:2},{name:"TUE/WED/FRI: Reading/Study (book/course/skill)",days:["tue","wed","fri"],max_per_day:1,max_score:3},{name:"SAT: Errands, Grocery shopping, Meal prep",days:["sat"],max_per_day:3,max_score:3},{name:"SUN: House cleaning, laundry",days:["sun"],max_per_day:2,max_score:2}]},{name:"9AM - 5PM",activities:[{name:"MON-FRI: Work",days:["mon","tue","wed","thu","fri"],max_per_day:1,max_score:5},{name:"DAILY: ZeroInbox (E1, E2, E3, E4, LI, Slack)",max_per_day:1,max_score:30},{name:"SAT/SUN: Nature time / Outdoor Activity / Adventure",days:["sat","sun"],max_per_day:1,max_score:2}]},{name:"DHUHR",activities:[{name:"DAILY: Dhuhr prayer",max_per_day:1,max_score:7},{name:"TUE/WED/FRI: Sun walk (30-45 minutes)",days:["tue","wed","fri"],max_per_day:1,max_score:3},{name:"FRI: £10 Sadaqa",days:["fri"],max_per_day:1,max_score:1}]},{name:"ASR",activities:[{name:"DAILY: Asr prayer",max_per_day:1,max_score:7}]},{name:"5PM - 6:30PM",activities:[{name:"MON/THU: COMMUTE",days:["mon","thu"],max_per_day:1,max_score:2},{name:"TUE/WED/FRI: Workout",days:["tue","wed","fri"],max_per_day:1,max_score:3},{name:"TUE/WED/FRI: Third Meal",days:["tue","wed","fri"],max_per_day:1,max_score:3}]},{name:"6:30PM - ISHA",activities:[{name:"MON/TUE/WED/THU: Personal",days:["mon","tue","wed","thu"],max_per_day:1,max_score:4},{name:"DAILY: Family/Friends/Date calls(M, WA, Phone)",max_per_day:1,max_score:12},{name:"FRI/SAT/SUN: Family/Friends/Date visits/outings/activities",days:["fri","sat","sun"],max_per_day:1,max_score:9}]},{name:"MAGHRIB",activities:[{name:"DAILY: Maghrib prayer",max_per_day:1,max_score:7},{name:"DAILY: Super Veggie",max_per_day:1,max_score:7}]},{name:"ISHA",activities:[{name:"DAILY: Isha prayer",max_per_day:1,max_score:7},{name:"DAILY: Sleep early",max_per_day:1,max_score:7}]},{name:"ALLDAY",activities:[{name:"DAILY: No Doomscrolling; (FB, YTB, LKDN, & IG)",max_per_day:4,max_score:28},{name:"DAILY: No Fap; (P, & M)",max_per_day:2,max_score:14},{name:"DAILY: No Processed; (Sugar, RefinedFlour, SeedOils, Soda, FastFood)",max_per_day:5,max_score:35},{name:"MON/THU: Fasting",days:["mon","thu"],max_per_day:1,max_score:2},{name:"DAILY: Expense Tracker <25",max_per_day:0,max_score:0}]},{name:"TOTAL",activities:[{name:"DAILY POINTS",max_per_day:0,max_score:247}]}],tasks:{count:15,fields:["priority","description","tag","start_date","expected_date","actual_date","completed"]},workout:[{name:"TUESDAY",exercises:[{name:"Incline Dumbbell Press",default_weight:30,default_sets:3,default_reps:12},{name:"Barbell Squats",default_weight:80,default_sets:3,default_reps:8},{name:"DB Chest-Supported Row",default_weight:25,default_sets:3,default_reps:12},{name:"Leg Curls",default_weight:40,default_sets:3,default_reps:12},{name:"SS: Incline DB Curls",default_weight:15,default_sets:3,default_reps:12},{name:"SS: Tricep Extensions",default_weight:20,default_sets:3,default_reps:12}]},{name:"WEDNESDAY",exercises:[{name:"Barbell Bench Press",default_weight:70,default_sets:3,default_reps:6},{name:"Romanian Deadlift",default_weight:90,default_sets:3,default_reps:8},{name:"Lat Pulldown",default_weight:60,default_sets:3,default_reps:12},{name:"Walking Lunges",default_weight:20,default_sets:3,default_reps:12},{name:"SS: Cable Lateral Raises",default_weight:10,default_sets:3,default_reps:15},{name:"SS: Reverse Crunches",default_weight:0,default_sets:3,default_reps:15}]},{name:"FRIDAY",exercises:[{name:"Seated DB Shoulder Press",default_weight:20,default_sets:3,default_reps:12},{name:"Dumbbell Row",default_weight:25,default_sets:3,default_reps:12},{name:"Barbell Hip Thrust",default_weight:100,default_sets:3,default_reps:15},{name:"Leg Extensions",default_weight:50,default_sets:3,default_reps:12},{name:"Seated Chest Flyes",default_weight:15,default_sets:3,default_reps:12},{name:"SS: Standing Calf Raises",default_weight:30,default_sets:3,default_reps:20},{name:"SS: Reverse Cable Flyes",default_weight:10,default_sets:3,default_reps:15}]}],meals:[{name:"Nutty Pudding",ingredients:"Berries ½c, Cherries 3, Pomegranate Juice 2oz, Macadamia nuts (raw) 45g, Walnuts (raw) 5g, Cocoa 1t, Brazil Nuts ¼, Milk 50-100ml, Chia Seeds 2T, Flax (ground, refr) 1t, Lecithin 1t, Ceylon Cinnamon ½t"},{name:"Super Veggie",ingredients:"Broccoli 250g, Cauliflower 150g, Mushrooms 50g, Garlic 1 clove, Ginger 3g, Cumin 1T, Black Lentils 45g, Hemp Seeds 1T, Apple Cider Vinegar 1T"},{name:"Third Meal",ingredients:"Sweet Potato 350-400g, Protein 100-150g, Grape Tomatoes 12, Avocado ½, Radishes 4, Cilantro ¼c, Lemon 1, Jalapeño (lg) 1, Chili Powder 1t"}],grocery:{categories:[{name:"Produce",items:"Broccoli 1.75kg, Cauliflower 1.05kg, Mushrooms 350g, Garlic 1 bulb, Ginger 1pc, Sweet Potato 2.8kg, Grape Tomatoes 84, Avocados (ripe) 4, Radishes 28, Cilantro 2-3 bunch"},{name:"Fruits & Protein",items:"Lemons 7, Jalapeños (lg) 7, Berries 3.5c, Cherries 21, Black Lentils 315g, Protein 1.05kg, Milk (fortified) 1L"}]},measurements:[{name:"Weight",placeholder:"75kg"},{name:"Chest",placeholder:"42in"},{name:"Waist",placeholder:"34in"},{name:"Hips",placeholder:"36in"},{name:"Arms",placeholder:"15in"},{name:"Thighs",placeholder:"24in"}],financials:[{name:"Rent",placeholder:"850",account:"Cash"},{name:"Allowance",placeholder:"850",account:"Revolut"},{name:"Savings",placeholder:"3800",account:"HSBCUK"}],city_default:"London"}}]}]}function fe(){S(v,JSON.stringify(Q(),null,2),!0),S(g,JSON.stringify(Ce(),null,2),!0),N(),j(),U()}Ks(()=>{fe()});var re=Xi(),pe=Pe(re);pe.__click=[Ji,k];var Le=p(pe),Me=p(Le),Je=p(Me),ee=p(Je),z=p(ee),_e=p(z),Y=m(ee,2),Ye=p(Y),Xe=p(Ye),Ze=m(Y,2),ha=p(Ze),mt=p(ha),gt=m(Ze,2),ma=p(gt),Ge=p(ma),Se=m(Je,2),et=p(Se),it=m(Se,2),Ba=p(it),Qs=m(p(Ba),2),Ja=m(Ba,2),Xs=m(p(Ja),2),Zs=m(Ja,2),en=m(p(Zs),2),ga=p(en),Ya=m(ga,2);Ya.__click=[Yi,r];var tn=p(Ya),Ga=m(it,2),yt=p(Ga);yt.__click=[qi,D,w,a,x];var an=p(yt),ya=m(yt,2);ya.__click=[Ui,x,j,U];var _a=m(ya,2);_a.__click=L;var wa=m(_a,2);wa.__click=[ji,M,y,Oe];var Sa=m(wa,2);Sa.__click=[zi,M,y,le];var sn=m(Sa,2);sn.__click=[Gi,l];var Va=m(Ga,2),xa=p(Va);xa.__click=[Bi,M,a,s,n,fe,x];var nn=m(xa,2);nn.__click=k;var Ha=m(Va,2),Ka=p(Ha),_t=m(p(Ka),2);_t.__input=j;var Qa=m(_t,2);let Xa;var rn=p(Qa),ln=m(Ka,2),wt=m(p(ln),2);wt.__input=U;var Za=m(wt,2);let es;var on=p(Za),cn=m(Ha,2);se(cn,21,()=>i(h),Ue,(O,J)=>{var B=Vi(),H=p(B);q(()=>{X(B,1,`log-${i(J).type??""}`,"svelte-1vc718t"),A(H,`[${i(J).time??""}] ${i(J).msg??""}`)}),C(O,B)});var un=m(pe,2);{var dn=O=>{var J=Qi();J.__click=[Hi,l];var B=p(J),H=p(B);H.__click=[Ki,l];var K=m(H,8);K.textContent=`{
  "name": "title",
  "type": "text",
  "required": true,
  "presentable": true,
  "min": 1,                // Minimum length
  "max": 100,              // Maximum length
  "pattern": "^[A-Z].*"    // Regex pattern
}`;var xe=m(K,4);xe.textContent=`{
  "name": "age",
  "type": "number",
  "required": false,
  "presentable": false,
  "min": 0,                // Minimum value
  "max": 150,              // Maximum value
  "noDecimal": true        // Integer only
}`;var he=m(xe,4);he.textContent=`{
  "name": "is_active",
  "type": "bool",
  "required": false,
  "presentable": false
}`;var Ae=m(he,4);Ae.textContent=`{
  "name": "metadata",
  "type": "json",
  "required": false,
  "presentable": false,
  "maxSize": 2097152       // Max size in bytes (2MB)
}`;var we=m(Ae,4);we.textContent=`{
  "name": "template_id",
  "type": "relation",
  "required": true,
  "presentable": true,
  "collectionId": "xyz123",     // Target collection ID
  "cascadeDelete": false,       // Delete this when related deleted
  "minSelect": 1,               // Minimum selections
  "maxSelect": 1,               // Maximum selections (1 = single)
  "displayFields": ["name"]     // Fields to show in UI
}`;var be=m(we,4);be.textContent=`{
  "name": "planners",              // Collection name (a-z, 0-9, _)
  "type": "base",                  // "base" or "auth"
  "listRule": "",                  // API rules (see below)
  "viewRule": "",
  "createRule": "",
  "updateRule": "",
  "deleteRule": "",
  "indexes": [                     // SQL indexes for performance
    "CREATE INDEX idx_week ON planners (week_id)"
  ],
  "fields": [...]                  // Array of field definitions
}`;var tt=m(be,8);tt.textContent=`{
  "listRule": "",          // Empty string = public access
  "viewRule": "",          // Anyone can read
  "createRule": null,      // null = admin only
  "updateRule": null,      // No public updates
  "deleteRule": null       // No public deletes
}`;var ts=m(tt,4);ts.textContent=`{
  "listRule": "@request.auth.id != ''",    // Any logged in user
  "viewRule": "@request.auth.id != ''",    
  "createRule": "@request.auth.id != ''",  
  "updateRule": "@request.auth.id != ''",  
  "deleteRule": "@request.auth.id != ''"   
}`;var as=m(ts,4);as.textContent=`{
  "listRule": "user = @request.auth.id",     // List own records only
  "viewRule": "user = @request.auth.id",     // View own records only
  "createRule": "@request.auth.id != ''",    // Any auth user can create
  "updateRule": "user = @request.auth.id",   // Update own records only
  "deleteRule": "user = @request.auth.id"    // Delete own records only
}`;var ss=m(as,6);ss.textContent=`// ❌ WRONG: Nested options structure (old PocketBase version)
{
  "name": "title",
  "type": "text",
  "required": true,
  "options": {              // ❌ DON'T USE "options" wrapper
    "max": 100,
    "min": 1
  }
}

// ❌ WRONG: Schema key instead of fields
{
  "name": "posts",
  "schema": [...]           // ❌ DON'T USE "schema" key
}

// ❌ WRONG: Invalid field names
{
  "name": "field name",     // ❌ No spaces
  "name": "field-name",     // ❌ No hyphens
  "name": "123field",       // ❌ Can't start with number
  "name": "id",             // ❌ Reserved name
}`;var vn=m(ss,4);vn.textContent=`// ✅ CORRECT: Direct properties
{
  "name": "title",
  "type": "text",
  "required": true,
  "presentable": true,
  "max": 100,               // ✅ Direct property
  "min": 1                  // ✅ Direct property
}

// ✅ CORRECT: Fields key
{
  "name": "posts",
  "fields": [...]           // ✅ Use "fields" key
}

// ✅ CORRECT: Valid field names
{
  "name": "field_name",     // ✅ Underscores OK
  "name": "fieldName",      // ✅ camelCase OK
  "name": "field123"        // ✅ Numbers at end OK
}`,C(O,J)};ue(un,O=>{i(l)&&O(dn)})}q((O,J)=>{A(_e,o.collections),A(Xe,o.fields),A(mt,o.seeds),A(Ge,o.health),oa(et,`width: ${i(c)??""}%`),qe(ga,"type",i(r)?"text":"password"),A(tn,i(r)?"🙈":"👁️"),yt.disabled=i(D)||i(y),A(an,`${i(D)?"⏳":"🔌"} Test Connection`),ya.disabled=i(y)||!d.validate,_a.disabled=i(y)||!d.setup,wa.disabled=i(y)||!d.schema,Sa.disabled=i(y)||!d.seed,xa.disabled=i(y),_t.disabled=i(y),Xa=X(Qa,1,"setup-status svelte-1vc718t",null,Xa,O),A(rn,u.collections.message),wt.disabled=i(y),es=X(Za,1,"setup-status svelte-1vc718t",null,es,J),A(on,u.seeds.message)},[()=>({"setup-valid":u.collections.valid,"setup-invalid":!u.collections.valid}),()=>({"setup-valid":u.seeds.valid,"setup-invalid":!u.seeds.valid})]),Z(Qs,()=>i(a),O=>S(a,O)),Z(Xs,()=>i(s),O=>S(s,O)),Z(ga,()=>i(n),O=>S(n,O)),Z(_t,()=>i(v),O=>S(v,O)),Z(wt,()=>i(g),O=>S(g,O)),C(t,re),ve()}Be(["click","input"]);var el=W('<div class="viewport-container"><div class="card"><!> <!> <!> <!> <!> <!> <!> <!></div></div> <!>',1),tl=W("<!> <!> <!>",1);function al(t,e){de(e,!0);let a=T(!1);ea(()=>{S(a,f.showSetupModal,!0),console.log("App.svelte: showSetupModal changed to",i(a))}),Ks(()=>{f.init()});var s=tl(),n=Pe(s);Ci(n,{});var r=m(n,2);{var l=u=>{var v=el(),g=Pe(v),h=p(g),w=p(h);jr(w,{});var D=m(w,2);Xr(D,{});var y=m(D,2);ni(y,{});var k=m(y,2);di(k,{});var x=m(k,2);pi(x,{});var I=m(x,2);gi(I,{});var N=m(I,2);Si(N,{});var R=m(N,2);Di(R,{});var j=m(g,2);$i(j,{}),C(u,v)};ue(r,u=>{f.isInitializing||u(l)})}var c=m(r,2);{var o=u=>{Zi(u,{})},d=u=>{};ue(c,u=>{i(a)?u(o):u(d,!1)})}C(t,s),ve()}yr(al,{target:document.getElementById("app")});
