var Sn=Object.defineProperty;var Ca=t=>{throw TypeError(t)};var xn=(t,e,a)=>e in t?Sn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var nt=(t,e,a)=>xn(t,typeof e!="symbol"?e+"":e,a),kn=(t,e,a)=>e.has(t)||Ca("Cannot "+a);var S=(t,e,a)=>(kn(t,e,"read from private field"),a?a.call(t):e.get(t)),W=(t,e,a)=>e.has(t)?Ca("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,a);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function a(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=a(r);fetch(r.href,s)}})();const Oa=!1;var ta=Array.isArray,Dn=Array.prototype.indexOf,ha=Array.from,Tn=Object.defineProperty,st=Object.getOwnPropertyDescriptor,Ba=Object.getOwnPropertyDescriptors,En=Object.prototype,In=Array.prototype,ma=Object.getPrototypeOf,Pa=Object.isExtensible;function Cn(t){return t()}function ca(t){for(var e=0;e<t.length;e++)t[e]()}const we=2,za=4,aa=8,ga=16,Re=32,Ze=64,ya=128,pe=256,zt=512,be=1024,We=2048,Ge=4096,Me=8192,wa=16384,Ja=32768,ba=65536,On=1<<17,Pn=1<<19,Ya=1<<20,fa=1<<21,Ve=Symbol("$state"),An=Symbol("");function Ha(t){return t===this.v}function $n(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Va(t){return!$n(t,this.v)}function Nn(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Ln(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Mn(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Wn(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Rn(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Fn(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Un(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Ft=!1,jn=!1;function qn(){Ft=!0}const Sa=1,xa=2,Ka=4,Bn=8,zn=16,Jn=1,Yn=2,le=Symbol(),Hn="http://www.w3.org/1999/xhtml";function Vn(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let z=null;function Aa(t){z=t}function _e(t,e=!1,a){var n=z={p:z,c:null,d:!1,e:null,m:!1,s:t,x:null,l:null};Ft&&!e&&(z.l={s:null,u:null,r1:[],r2:ot(!1)}),nr(()=>{n.d=!0})}function he(t){const e=z;if(e!==null){const o=e.e;if(o!==null){var a=R,n=L;e.e=null;try{for(var r=0;r<o.length;r++){var s=o[r];Je(s.effect),Ae(s.reaction),sa(s.fn)}}finally{Je(a),Ae(n)}}z=e.p,e.m=!0}return{}}function Ut(){return!Ft||z!==null&&z.l===null}function V(t){if(typeof t!="object"||t===null||Ve in t)return t;const e=ma(t);if(e!==En&&e!==In)return t;var a=new Map,n=ta(t),r=E(0),s=L,o=u=>{var l=L;Ae(s);var c=u();return Ae(l),c};return n&&a.set("length",E(t.length)),new Proxy(t,{defineProperty(u,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Rn();var f=a.get(l);return f===void 0?f=o(()=>{var d=E(c.value);return a.set(l,d),d}):b(f,c.value,!0),!0},deleteProperty(u,l){var c=a.get(l);if(c===void 0){if(l in u){const v=o(()=>E(le));a.set(l,v),la(r)}}else{if(n&&typeof l=="string"){var f=a.get("length"),d=Number(l);Number.isInteger(d)&&d<f.v&&b(f,d)}b(c,le),la(r)}return!0},get(u,l,c){var h;if(l===Ve)return t;var f=a.get(l),d=l in u;if(f===void 0&&(!d||(h=st(u,l))!=null&&h.writable)&&(f=o(()=>{var g=V(d?u[l]:le),x=E(g);return x}),a.set(l,f)),f!==void 0){var v=i(f);return v===le?void 0:v}return Reflect.get(u,l,c)},getOwnPropertyDescriptor(u,l){var c=Reflect.getOwnPropertyDescriptor(u,l);if(c&&"value"in c){var f=a.get(l);f&&(c.value=i(f))}else if(c===void 0){var d=a.get(l),v=d==null?void 0:d.v;if(d!==void 0&&v!==le)return{enumerable:!0,configurable:!0,value:v,writable:!0}}return c},has(u,l){var v;if(l===Ve)return!0;var c=a.get(l),f=c!==void 0&&c.v!==le||Reflect.has(u,l);if(c!==void 0||R!==null&&(!f||(v=st(u,l))!=null&&v.writable)){c===void 0&&(c=o(()=>{var h=f?V(u[l]):le,g=E(h);return g}),a.set(l,c));var d=i(c);if(d===le)return!1}return f},set(u,l,c,f){var $;var d=a.get(l),v=l in u;if(n&&l==="length")for(var h=c;h<d.v;h+=1){var g=a.get(h+"");g!==void 0?b(g,le):h in u&&(g=o(()=>E(le)),a.set(h+"",g))}if(d===void 0)(!v||($=st(u,l))!=null&&$.writable)&&(d=o(()=>E(void 0)),b(d,V(c)),a.set(l,d));else{v=d.v!==le;var x=o(()=>V(c));b(d,x)}var w=Reflect.getOwnPropertyDescriptor(u,l);if(w!=null&&w.set&&w.set.call(f,c),!v){if(n&&typeof l=="string"){var k=a.get("length"),P=Number(l);Number.isInteger(P)&&P>=k.v&&b(k,P+1)}la(r)}return!0},ownKeys(u){i(r);var l=Reflect.ownKeys(u).filter(d=>{var v=a.get(d);return v===void 0||v.v!==le});for(var[c,f]of a)f.v!==le&&!(c in u)&&l.push(c);return l},setPrototypeOf(){Fn()}})}function la(t,e=1){b(t,t.v+e)}function $a(t){try{if(t!==null&&typeof t=="object"&&Ve in t)return t[Ve]}catch{}return t}function Kn(t,e){return Object.is($a(t),$a(e))}function ka(t){var e=we|We,a=L!==null&&(L.f&we)!==0?L:null;return R===null||a!==null&&(a.f&pe)!==0?e|=pe:R.f|=Ya,{ctx:z,deps:null,effects:null,equals:Ha,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:a??R}}function Le(t){const e=ka(t);return e.equals=Va,e}function Ga(t){var e=t.effects;if(e!==null){t.effects=null;for(var a=0;a<e.length;a+=1)ze(e[a])}}function Gn(t){for(var e=t.parent;e!==null;){if((e.f&we)===0)return e;e=e.parent}return null}function Qa(t){var e,a=R;Je(Gn(t));try{Ga(t),e=_n(t)}finally{Je(a)}return e}function Xa(t){var e=Qa(t);if(t.equals(e)||(t.v=e,t.wv=vn()),!tt){var a=(je||(t.f&pe)!==0)&&t.deps!==null?Ge:be;$e(t,a)}}const lt=new Map;function ot(t,e){var a={f:0,v:t,reactions:null,equals:Ha,rv:0,wv:0};return a}function E(t,e){const a=ot(t);return fr(a),a}function Qn(t,e=!1,a=!0){var r;const n=ot(t);return e||(n.equals=Va),Ft&&a&&z!==null&&z.l!==null&&((r=z.l).s??(r.s=[])).push(n),n}function b(t,e,a=!1){L!==null&&!Oe&&Ut()&&(L.f&(we|ga))!==0&&!(X!=null&&X[1].includes(t)&&X[0]===L)&&Un();let n=a?V(e):e;return ut(t,n)}function ut(t,e){if(!t.equals(e)){var a=t.v;tt?lt.set(t,e):lt.set(t,a),t.v=e,(t.f&we)!==0&&((t.f&We)!==0&&Qa(t),$e(t,(t.f&pe)===0?be:Ge)),t.wv=vn(),Za(t,We),Ut()&&R!==null&&(R.f&be)!==0&&(R.f&(Re|Ze))===0&&(ye===null?dr([t]):ye.push(t))}return e}function Za(t,e){var a=t.reactions;if(a!==null)for(var n=Ut(),r=a.length,s=0;s<r;s++){var o=a[s],u=o.f;(u&We)===0&&(!n&&o===R||($e(o,e),(u&(be|pe))!==0&&((u&we)!==0?Za(o,Ge):Ia(o))))}}function Xn(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let Zn=!1;var Na,en,tn,an;function er(){if(Na===void 0){Na=window,en=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,a=Text.prototype;tn=st(e,"firstChild").get,an=st(e,"nextSibling").get,Pa(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Pa(a)&&(a.__t=void 0)}}function na(t=""){return document.createTextNode(t)}function Jt(t){return tn.call(t)}function ra(t){return an.call(t)}function _(t,e){return Jt(t)}function Pe(t,e){{var a=Jt(t);return a instanceof Comment&&a.data===""?ra(a):a}}function m(t,e=1,a=!1){let n=t;for(;e--;)n=ra(n);return n}function tr(t){t.textContent=""}function nn(t){R===null&&L===null&&Mn(),L!==null&&(L.f&pe)!==0&&R===null&&Ln(),tt&&Nn()}function ar(t,e){var a=e.last;a===null?e.last=e.first=t:(a.next=t,t.prev=a,e.last=t)}function et(t,e,a,n=!0){var r=R,s={ctx:z,deps:null,nodes_start:null,nodes_end:null,f:t|We,first:null,fn:e,last:null,next:null,parent:r,prev:null,teardown:null,transitions:null,wv:0};if(a)try{Ea(s),s.f|=Ja}catch(l){throw ze(s),l}else e!==null&&Ia(s);var o=a&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(Ya|ya))===0;if(!o&&n&&(r!==null&&ar(s,r),L!==null&&(L.f&we)!==0)){var u=L;(u.effects??(u.effects=[])).push(s)}return s}function nr(t){const e=et(aa,null,!1);return $e(e,be),e.teardown=t,e}function da(t){nn();var e=R!==null&&(R.f&Re)!==0&&z!==null&&!z.m;if(e){var a=z;(a.e??(a.e=[])).push({fn:t,effect:R,reaction:L})}else{var n=sa(t);return n}}function rr(t){return nn(),rn(t)}function sr(t){const e=et(Ze,t,!0);return(a={})=>new Promise(n=>{a.outro?Yt(e,()=>{ze(e),n(void 0)}):(ze(e),n(void 0))})}function sa(t){return et(za,t,!1)}function rn(t){return et(aa,t,!0)}function M(t,e=[],a=ka){const n=e.map(a);return Da(()=>t(...n.map(i)))}function Da(t,e=0){return et(aa|ga|e,t,!0)}function ct(t,e=!0){return et(aa|Re,t,!0,e)}function sn(t){var e=t.teardown;if(e!==null){const a=tt,n=L;La(!0),Ae(null);try{e.call(null)}finally{La(a),Ae(n)}}}function ln(t,e=!1){var a=t.first;for(t.first=t.last=null;a!==null;){var n=a.next;(a.f&Ze)!==0?a.parent=null:ze(a,e),a=n}}function ir(t){for(var e=t.first;e!==null;){var a=e.next;(e.f&Re)===0&&ze(e),e=a}}function ze(t,e=!0){var a=!1;(e||(t.f&Pn)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(lr(t.nodes_start,t.nodes_end),a=!0),ln(t,e&&!a),Qt(t,0),$e(t,wa);var n=t.transitions;if(n!==null)for(const s of n)s.stop();sn(t);var r=t.parent;r!==null&&r.first!==null&&on(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function lr(t,e){for(;t!==null;){var a=t===e?null:ra(t);t.remove(),t=a}}function on(t){var e=t.parent,a=t.prev,n=t.next;a!==null&&(a.next=n),n!==null&&(n.prev=a),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=a))}function Yt(t,e){var a=[];Ta(t,a,!0),un(a,()=>{ze(t),e&&e()})}function un(t,e){var a=t.length;if(a>0){var n=()=>--a||e();for(var r of t)r.out(n)}else e()}function Ta(t,e,a){if((t.f&Me)===0){if(t.f^=Me,t.transitions!==null)for(const o of t.transitions)(o.is_global||a)&&e.push(o);for(var n=t.first;n!==null;){var r=n.next,s=(n.f&ba)!==0||(n.f&Re)!==0;Ta(n,e,s?a:!1),n=r}}}function Ht(t){cn(t,!0)}function cn(t,e){if((t.f&Me)!==0){t.f^=Me;for(var a=t.first;a!==null;){var n=a.next,r=(a.f&ba)!==0||(a.f&Re)!==0;cn(a,r?e:!1),a=n}if(t.transitions!==null)for(const s of t.transitions)(s.is_global||e)&&s.in()}}let Vt=[];function or(){var t=Vt;Vt=[],ca(t)}function ur(t){Vt.length===0&&queueMicrotask(or),Vt.push(t)}function cr(t){var e=R;if((e.f&Ja)===0){if((e.f&ya)===0)throw t;e.fn(t)}else fn(t,e)}function fn(t,e){for(;e!==null;){if((e.f&ya)!==0)try{e.fn(t);return}catch{}e=e.parent}throw t}let va=!1,Kt=null,Ke=!1,tt=!1;function La(t){tt=t}let Bt=[];let L=null,Oe=!1;function Ae(t){L=t}let R=null;function Je(t){R=t}let X=null;function fr(t){L!==null&&L.f&fa&&(X===null?X=[L,[t]]:X[1].push(t))}let ne=null,ve=0,ye=null;function dr(t){ye=t}let dn=1,Gt=0,je=!1,He=null;function vn(){return++dn}function ia(t){var d;var e=t.f;if((e&We)!==0)return!0;if((e&Ge)!==0){var a=t.deps,n=(e&pe)!==0;if(a!==null){var r,s,o=(e&zt)!==0,u=n&&R!==null&&!je,l=a.length;if(o||u){var c=t,f=c.parent;for(r=0;r<l;r++)s=a[r],(o||!((d=s==null?void 0:s.reactions)!=null&&d.includes(c)))&&(s.reactions??(s.reactions=[])).push(c);o&&(c.f^=zt),u&&f!==null&&(f.f&pe)===0&&(c.f^=pe)}for(r=0;r<l;r++)if(s=a[r],ia(s)&&Xa(s),s.wv>t.wv)return!0}(!n||R!==null&&!je)&&$e(t,be)}return!1}function pn(t,e,a=!0){var n=t.reactions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];X!=null&&X[1].includes(t)&&X[0]===L||((s.f&we)!==0?pn(s,e,!1):e===s&&(a?$e(s,We):(s.f&be)!==0&&$e(s,Ge),Ia(s)))}}function _n(t){var h;var e=ne,a=ve,n=ye,r=L,s=je,o=X,u=z,l=Oe,c=t.f;ne=null,ve=0,ye=null,je=(c&pe)!==0&&(Oe||!Ke||L===null),L=(c&(Re|Ze))===0?t:null,X=null,Aa(t.ctx),Oe=!1,Gt++,t.f|=fa;try{var f=(0,t.fn)(),d=t.deps;if(ne!==null){var v;if(Qt(t,ve),d!==null&&ve>0)for(d.length=ve+ne.length,v=0;v<ne.length;v++)d[ve+v]=ne[v];else t.deps=d=ne;if(!je)for(v=ve;v<d.length;v++)((h=d[v]).reactions??(h.reactions=[])).push(t)}else d!==null&&ve<d.length&&(Qt(t,ve),d.length=ve);if(Ut()&&ye!==null&&!Oe&&d!==null&&(t.f&(we|Ge|We))===0)for(v=0;v<ye.length;v++)pn(ye[v],t);return r!==null&&r!==t&&(Gt++,ye!==null&&(n===null?n=ye:n.push(...ye))),f}catch(g){cr(g)}finally{ne=e,ve=a,ye=n,L=r,je=s,X=o,Aa(u),Oe=l,t.f^=fa}}function vr(t,e){let a=e.reactions;if(a!==null){var n=Dn.call(a,t);if(n!==-1){var r=a.length-1;r===0?a=e.reactions=null:(a[n]=a[r],a.pop())}}a===null&&(e.f&we)!==0&&(ne===null||!ne.includes(e))&&($e(e,Ge),(e.f&(pe|zt))===0&&(e.f^=zt),Ga(e),Qt(e,0))}function Qt(t,e){var a=t.deps;if(a!==null)for(var n=e;n<a.length;n++)vr(t,a[n])}function Ea(t){var e=t.f;if((e&wa)===0){$e(t,be);var a=R,n=Ke;R=t,Ke=!0;try{(e&ga)!==0?ir(t):ln(t),sn(t);var r=_n(t);t.teardown=typeof r=="function"?r:null,t.wv=dn;var s;Oa&&jn&&(t.f&We)!==0&&t.deps}finally{Ke=n,R=a}}}function pr(){try{Wn()}catch(t){if(Kt!==null)fn(t,Kt);else throw t}}function _r(){var t=Ke;try{var e=0;for(Ke=!0;Bt.length>0;){e++>1e3&&pr();var a=Bt,n=a.length;Bt=[];for(var r=0;r<n;r++){var s=mr(a[r]);hr(s)}lt.clear()}}finally{va=!1,Ke=t,Kt=null}}function hr(t){var e=t.length;if(e!==0)for(var a=0;a<e;a++){var n=t[a];(n.f&(wa|Me))===0&&ia(n)&&(Ea(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null?on(n):n.fn=null))}}function Ia(t){va||(va=!0,queueMicrotask(_r));for(var e=Kt=t;e.parent!==null;){e=e.parent;var a=e.f;if((a&(Ze|Re))!==0){if((a&be)===0)return;e.f^=be}}Bt.push(e)}function mr(t){for(var e=[],a=t;a!==null;){var n=a.f,r=(n&(Re|Ze))!==0,s=r&&(n&be)!==0;if(!s&&(n&Me)===0){(n&za)!==0?e.push(a):r?a.f^=be:ia(a)&&Ea(a);var o=a.first;if(o!==null){a=o;continue}}var u=a.parent;for(a=a.next;a===null&&u!==null;)a=u.next,u=u.parent}return e}function i(t){var e=t.f,a=(e&we)!==0;if(He!==null&&He.add(t),L!==null&&!Oe){if(!(X!=null&&X[1].includes(t))||X[0]!==L){var n=L.deps;t.rv<Gt&&(t.rv=Gt,ne===null&&n!==null&&n[ve]===t?ve++:ne===null?ne=[t]:(!je||!ne.includes(t))&&ne.push(t))}}else if(a&&t.deps===null&&t.effects===null){var r=t,s=r.parent;s!==null&&(s.f&pe)===0&&(r.f^=pe)}return a&&(r=t,ia(r)&&Xa(r)),tt&&lt.has(t)?lt.get(t):t.v}function gr(t){var e=He;He=new Set;var a=He,n;try{if(y(t),e!==null)for(n of He)e.add(n)}finally{He=e}return a}function re(t){var e=gr(()=>y(t));for(var a of e)if((a.f&On)!==0)for(const n of a.deps||[])(n.f&we)===0&&ut(n,n.v);else ut(a,a.v)}function y(t){var e=Oe;try{return Oe=!0,t()}finally{Oe=e}}const yr=-7169;function $e(t,e){t.f=t.f&yr|e}function A(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(Ve in t)pa(t);else if(!Array.isArray(t))for(let e in t){const a=t[e];typeof a=="object"&&a&&Ve in a&&pa(a)}}}function pa(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let n in t)try{pa(t[n],e)}catch{}const a=ma(t);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const n=Ba(a);for(let r in n){const s=n[r].get;if(s)try{s.call(t)}catch{}}}}}const wr=["touchstart","touchmove"];function br(t){return wr.includes(t)}let Ma=!1;function Sr(){Ma||(Ma=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const a of t.target.elements)(e=a.__on_r)==null||e.call(a)})},{capture:!0}))}function xr(t){var e=L,a=R;Ae(null),Je(null);try{return t()}finally{Ae(e),Je(a)}}function hn(t,e,a,n=a){t.addEventListener(e,()=>xr(a));const r=t.__on_r;r?t.__on_r=()=>{r(),n(!0)}:t.__on_r=()=>n(!0),Sr()}const mn=new Set,_a=new Set;function Ye(t){for(var e=0;e<t.length;e++)mn.add(t[e]);for(var a of _a)a(t)}function qt(t){var P;var e=this,a=e.ownerDocument,n=t.type,r=((P=t.composedPath)==null?void 0:P.call(t))||[],s=r[0]||t.target,o=0,u=t.__root;if(u){var l=r.indexOf(u);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var c=r.indexOf(e);if(c===-1)return;l<=c&&(o=l)}if(s=r[o]||t.target,s!==e){Tn(t,"currentTarget",{configurable:!0,get(){return s||a}});var f=L,d=R;Ae(null),Je(null);try{for(var v,h=[];s!==null;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var x=s["__"+n];if(x!=null&&(!s.disabled||t.target===s))if(ta(x)){var[w,...k]=x;w.apply(s,[t,...k])}else x.call(s,t)}catch($){v?h.push($):v=$}if(t.cancelBubble||g===e||g===null)break;s=g}if(v){for(let $ of h)queueMicrotask(()=>{throw $});throw v}}finally{t.__root=e,delete t.currentTarget,Ae(f),Je(d)}}}function kr(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function Xt(t,e){var a=R;a.nodes_start===null&&(a.nodes_start=t,a.nodes_end=e)}function I(t,e){var a=(e&Jn)!==0,n=(e&Yn)!==0,r,s=!t.startsWith("<!>");return()=>{r===void 0&&(r=kr(s?t:"<!>"+t),a||(r=Jt(r)));var o=n||en?document.importNode(r,!0):r.cloneNode(!0);if(a){var u=Jt(o),l=o.lastChild;Xt(u,l)}else Xt(o,o);return o}}function Zt(t=""){{var e=na(t+"");return Xt(e,e),e}}function Dr(){var t=document.createDocumentFragment(),e=document.createComment(""),a=na();return t.append(e,a),Xt(e,a),t}function T(t,e){t!==null&&t.before(e)}function N(t,e){var a=e==null?"":typeof e=="object"?e+"":e;a!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=a,t.nodeValue=a+"")}function Tr(t,e){return Er(t,e)}const Xe=new Map;function Er(t,{target:e,anchor:a,props:n={},events:r,context:s,intro:o=!0}){er();var u=new Set,l=d=>{for(var v=0;v<d.length;v++){var h=d[v];if(!u.has(h)){u.add(h);var g=br(h);e.addEventListener(h,qt,{passive:g});var x=Xe.get(h);x===void 0?(document.addEventListener(h,qt,{passive:g}),Xe.set(h,1)):Xe.set(h,x+1)}}};l(ha(mn)),_a.add(l);var c=void 0,f=sr(()=>{var d=a??e.appendChild(na());return ct(()=>{if(s){_e({});var v=z;v.c=s}r&&(n.$$events=r),c=t(d,n)||{},s&&he()}),()=>{var g;for(var v of u){e.removeEventListener(v,qt);var h=Xe.get(v);--h===0?(document.removeEventListener(v,qt),Xe.delete(v)):Xe.set(v,h)}_a.delete(l),d!==a&&((g=d.parentNode)==null||g.removeChild(d))}});return Ir.set(c,f),c}let Ir=new WeakMap;function J(t,e,[a,n]=[0,0]){var r=t,s=null,o=null,u=le,l=a>0?ba:0,c=!1;const f=(v,h=!0)=>{c=!0,d(h,v)},d=(v,h)=>{u!==(u=v)&&(u?(s?Ht(s):h&&(s=ct(()=>h(r))),o&&Yt(o,()=>{o=null})):(o?Ht(o):h&&(o=ct(()=>h(r,[a+1,n]))),s&&Yt(s,()=>{s=null})))};Da(()=>{c=!1,e(f),c||d(null,null)},l)}function qe(t,e){return e}function Cr(t,e,a,n){for(var r=[],s=e.length,o=0;o<s;o++)Ta(e[o].e,r,!0);var u=s>0&&r.length===0&&a!==null;if(u){var l=a.parentNode;tr(l),l.append(a),n.clear(),Ue(t,e[0].prev,e[s-1].next)}un(r,()=>{for(var c=0;c<s;c++){var f=e[c];u||(n.delete(f.k),Ue(t,f.prev,f.next)),ze(f.e,!u)}})}function se(t,e,a,n,r,s=null){var o=t,u={flags:e,items:new Map,first:null},l=(e&Ka)!==0;if(l){var c=t;o=c.appendChild(na())}var f=null,d=!1,v=Le(()=>{var h=a();return ta(h)?h:h==null?[]:ha(h)});Da(()=>{var h=i(v),g=h.length;d&&g===0||(d=g===0,Or(h,u,o,r,e,n,a),s!==null&&(g===0?f?Ht(f):f=ct(()=>s(o)):f!==null&&Yt(f,()=>{f=null})),i(v))})}function Or(t,e,a,n,r,s,o){var xe,Ee,Ie,Ne;var u=(r&Bn)!==0,l=(r&(Sa|xa))!==0,c=t.length,f=e.items,d=e.first,v=d,h,g=null,x,w=[],k=[],P,$,D,O;if(u)for(O=0;O<c;O+=1)P=t[O],$=s(P,O),D=f.get($),D!==void 0&&((xe=D.a)==null||xe.measure(),(x??(x=new Set)).add(D));for(O=0;O<c;O+=1){if(P=t[O],$=s(P,O),D=f.get($),D===void 0){var te=v?v.e.nodes_start:a;g=Ar(te,e,g,g===null?e.first:g.next,P,$,O,n,r,o),f.set($,g),w=[],k=[],v=g.next;continue}if(l&&Pr(D,P,O,r),(D.e.f&Me)!==0&&(Ht(D.e),u&&((Ee=D.a)==null||Ee.unfix(),(x??(x=new Set)).delete(D))),D!==v){if(h!==void 0&&h.has(D)){if(w.length<k.length){var j=k[0],Z;g=j.prev;var Te=w[0],Se=w[w.length-1];for(Z=0;Z<w.length;Z+=1)Wa(w[Z],j,a);for(Z=0;Z<k.length;Z+=1)h.delete(k[Z]);Ue(e,Te.prev,Se.next),Ue(e,g,Te),Ue(e,Se,j),v=j,g=Se,O-=1,w=[],k=[]}else h.delete(D),Wa(D,v,a),Ue(e,D.prev,D.next),Ue(e,D,g===null?e.first:g.next),Ue(e,g,D),g=D;continue}for(w=[],k=[];v!==null&&v.k!==$;)(v.e.f&Me)===0&&(h??(h=new Set)).add(v),k.push(v),v=v.next;if(v===null)continue;D=v}w.push(D),g=D,v=D.next}if(v!==null||h!==void 0){for(var ue=h===void 0?[]:ha(h);v!==null;)(v.e.f&Me)===0&&ue.push(v),v=v.next;var me=ue.length;if(me>0){var Fe=(r&Ka)!==0&&c===0?a:null;if(u){for(O=0;O<me;O+=1)(Ie=ue[O].a)==null||Ie.measure();for(O=0;O<me;O+=1)(Ne=ue[O].a)==null||Ne.fix()}Cr(e,ue,Fe,f)}}u&&ur(()=>{var Ce;if(x!==void 0)for(D of x)(Ce=D.a)==null||Ce.apply()}),R.first=e.first&&e.first.e,R.last=g&&g.e}function Pr(t,e,a,n){(n&Sa)!==0&&ut(t.v,e),(n&xa)!==0?ut(t.i,a):t.i=a}function Ar(t,e,a,n,r,s,o,u,l,c){var f=(l&Sa)!==0,d=(l&zn)===0,v=f?d?Qn(r,!1,!1):ot(r):r,h=(l&xa)===0?o:ot(o),g={i:h,v,k:s,a:null,e:null,prev:a,next:n};try{return g.e=ct(()=>u(t,v,h,c),Zn),g.e.prev=a&&a.e,g.e.next=n&&n.e,a===null?e.first=g:(a.next=g,a.e.next=g.e),n!==null&&(n.prev=g,n.e.prev=g.e),g}finally{}}function Wa(t,e,a){for(var n=t.next?t.next.e.nodes_start:a,r=e?e.e.nodes_start:a,s=t.e.nodes_start;s!==n;){var o=ra(s);r.before(s),s=o}}function Ue(t,e,a){e===null?t.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}function gn(t){var e,a,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(a=gn(t[e]))&&(n&&(n+=" "),n+=a)}else for(a in t)t[a]&&(n&&(n+=" "),n+=a);return n}function $r(){for(var t,e,a=0,n="",r=arguments.length;a<r;a++)(t=arguments[a])&&(e=gn(t))&&(n&&(n+=" "),n+=e);return n}function Nr(t){return typeof t=="object"?$r(t):t??""}const Ra=[...` 	
\r\fÂ \v\uFEFF`];function Lr(t,e,a){var n=t==null?"":""+t;if(e&&(n=n?n+" "+e:e),a){for(var r in a)if(a[r])n=n?n+" "+r:r;else if(n.length)for(var s=r.length,o=0;(o=n.indexOf(r,o))>=0;){var u=o+s;(o===0||Ra.includes(n[o-1]))&&(u===n.length||Ra.includes(n[u]))?n=(o===0?"":n.substring(0,o))+n.substring(u+1):o=u}}return n===""?null:n}function Mr(t,e){return t==null?null:String(t)}function Q(t,e,a,n,r,s){var o=t.__className;if(o!==a||o===void 0){var u=Lr(a,n,s);u==null?t.removeAttribute("class"):t.className=u,t.__className=a}else if(s&&r!==s)for(var l in s){var c=!!s[l];(r==null||c!==!!r[l])&&t.classList.toggle(l,c)}return s}function ea(t,e,a,n){var r=t.__style;if(r!==e){var s=Mr(e);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}return n}function yn(t,e,a){if(t.multiple){if(e==null)return;if(!ta(e))return Xn();for(var n of t.options)n.selected=e.includes(it(n));return}for(n of t.options){var r=it(n);if(Kn(r,e)){n.selected=!0;return}}(!a||e!==void 0)&&(t.selectedIndex=-1)}function Wr(t,e){sa(()=>{var a=new MutationObserver(()=>{var n=t.__value;yn(t,n)});return a.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{a.disconnect()}})}function Fa(t,e,a=e){var n=!0;hn(t,"change",r=>{var s=r?"[selected]":":checked",o;if(t.multiple)o=[].map.call(t.querySelectorAll(s),it);else{var u=t.querySelector(s)??t.querySelector("option:not([disabled])");o=u&&it(u)}a(o)}),sa(()=>{var r=e();if(yn(t,r,n),n&&r===void 0){var s=t.querySelector(":checked");s!==null&&(r=it(s),a(r))}t.__value=r,n=!1}),Wr(t)}function it(t){return"__value"in t?t.__value:t.value}const Rr=Symbol("is custom element"),Fr=Symbol("is html");function wn(t,e){var a=bn(t);a.value===(a.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Be(t,e,a,n){var r=bn(t);r[e]!==(r[e]=a)&&(e==="loading"&&(t[An]=a),a==null?t.removeAttribute(e):typeof a!="string"&&Ur(t).includes(e)?t[e]=a:t.setAttribute(e,a))}function bn(t){return t.__attributes??(t.__attributes={[Rr]:t.nodeName.includes("-"),[Fr]:t.namespaceURI===Hn})}var Ua=new Map;function Ur(t){var e=Ua.get(t.nodeName);if(e)return e;Ua.set(t.nodeName,e=[]);for(var a,n=t,r=Element.prototype;r!==n;){a=Ba(n);for(var s in a)a[s].set&&e.push(s);n=ma(n)}return e}function oe(t,e,a=e){var n=Ut();hn(t,"input",r=>{var s=r?t.defaultValue:t.value;if(s=oa(t)?ua(s):s,a(s),n&&s!==(s=e())){var o=t.selectionStart,u=t.selectionEnd;t.value=s??"",u!==null&&(t.selectionStart=o,t.selectionEnd=Math.min(u,t.value.length))}}),y(e)==null&&t.value&&a(oa(t)?ua(t.value):t.value),rn(()=>{var r=e();oa(t)&&r===ua(t.value)||t.type==="date"&&!r&&!t.value||r!==t.value&&(t.value=r??"")})}function oa(t){var e=t.type;return e==="number"||e==="range"}function ua(t){return t===""?null:+t}function De(t=!1){const e=z,a=e.l.u;if(!a)return;let n=()=>A(e.s);if(t){let r=0,s={};const o=ka(()=>{let u=!1;const l=e.s;for(const c in l)l[c]!==s[c]&&(s[c]=l[c],u=!0);return u&&r++,r});n=()=>i(o)}a.b.length&&rr(()=>{ja(e,n),ca(a.b)}),da(()=>{const r=y(()=>a.m.map(Cn));return()=>{for(const s of r)typeof s=="function"&&s()}}),a.a.length&&da(()=>{ja(e,n),ca(a.a)})}function ja(t,e){if(t.l.s)for(const a of t.l.s)i(a);e()}function jr(t){z===null&&Vn(),Ft&&z.l!==null?qr(z).m.push(t):da(()=>{const e=y(t);if(typeof e=="function")return e})}function qr(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const Br="5";var qa;typeof window<"u"&&((qa=window.__svelte??(window.__svelte={})).v??(qa.v=new Set)).add(Br);qn();const zr=window.PocketBase;let Jr=0;const rt=()=>`id_${Date.now()}_${Jr++}`;var ft,dt,vt,pt,_t,ht,mt,gt,yt,wt,bt,St,xt,kt,Dt,Tt,Et,It,Ct,Ot,Pt,At,$t,Nt,Lt,Mt,Wt,Rt;class Yr{constructor(){nt(this,"pb",new zr(window.location.origin));W(this,ft,E(!0));nt(this,"lastSavedState",null);W(this,dt,E(""));W(this,vt,E(""));W(this,pt,E("London"));W(this,_t,E("saved"));nt(this,"saveTimeout",null);W(this,ht,E(!1));W(this,mt,E(""));nt(this,"notificationTimeout",null);W(this,gt,E(V(navigator.onLine)));W(this,yt,E(V([])));W(this,wt,E(!1));W(this,bt,E(!1));W(this,St,E(""));W(this,xt,E(""));W(this,kt,E(V(new Date().getDay())));W(this,Dt,E("Weekly Planner"));W(this,Tt,E(V([])));W(this,Et,E(V([])));W(this,It,E(V([])));W(this,Ct,E(V([])));W(this,Ot,E(V([])));W(this,Pt,E(V([])));W(this,At,E(V([])));W(this,$t,E(V([])));W(this,Nt,E(null));W(this,Lt,E(null));W(this,Mt,E(V([])));W(this,Wt,E(V([{name:"London",lat:51.5074,lon:-.1278},{name:"Cairo",lat:30.0444,lon:31.2357},{name:"Cape Town",lat:-33.9249,lon:18.4241},{name:"Amsterdam",lat:52.3676,lon:4.9041},{name:"Current Location",lat:null,lon:null}])));W(this,Rt,E(!1));this.pb.autoCancellation(!1),this.setupEventListeners()}get isInitializing(){return i(S(this,ft))}set isInitializing(e){b(S(this,ft),e,!0)}get currentWeek(){return i(S(this,dt))}set currentWeek(e){b(S(this,dt),e,!0)}get dateRange(){return i(S(this,vt))}set dateRange(e){b(S(this,vt),e,!0)}get city(){return i(S(this,pt))}set city(e){b(S(this,pt),e,!0)}get saveStatus(){return i(S(this,_t))}set saveStatus(e){b(S(this,_t),e,!0)}get showNotification(){return i(S(this,ht))}set showNotification(e){b(S(this,ht),e,!0)}get notificationMessage(){return i(S(this,mt))}set notificationMessage(e){b(S(this,mt),e,!0)}get isOnline(){return i(S(this,gt))}set isOnline(e){b(S(this,gt),e,!0)}get pendingSync(){return i(S(this,yt))}set pendingSync(e){b(S(this,yt),e,!0)}get showCitySelector(){return i(S(this,wt))}set showCitySelector(e){b(S(this,wt),e,!0)}get showWeekSelector(){return i(S(this,bt))}set showWeekSelector(e){b(S(this,bt),e,!0)}get cityDropdownStyle(){return i(S(this,St))}set cityDropdownStyle(e){b(S(this,St),e,!0)}get weekDropdownStyle(){return i(S(this,xt))}set weekDropdownStyle(e){b(S(this,xt),e,!0)}get currentDay(){return i(S(this,kt))}set currentDay(e){b(S(this,kt),e,!0)}get plannerTitle(){return i(S(this,Dt))}set plannerTitle(e){b(S(this,Dt),e,!0)}get times(){return i(S(this,Tt))}set times(e){b(S(this,Tt),e,!0)}get schedule(){return i(S(this,Et))}set schedule(e){b(S(this,Et),e,!0)}get tasks(){return i(S(this,It))}set tasks(e){b(S(this,It),e,!0)}get workoutPlan(){return i(S(this,Ct))}set workoutPlan(e){b(S(this,Ct),e,!0)}get meals(){return i(S(this,Ot))}set meals(e){b(S(this,Ot),e,!0)}get groceryList(){return i(S(this,Pt))}set groceryList(e){b(S(this,Pt),e,!0)}get bodyMeasurements(){return i(S(this,At))}set bodyMeasurements(e){b(S(this,At),e,!0)}get financials(){return i(S(this,$t))}set financials(e){b(S(this,$t),e,!0)}get currentTemplate(){return i(S(this,Nt))}set currentTemplate(e){b(S(this,Nt),e,!0)}get currentTemplateId(){return i(S(this,Lt))}set currentTemplateId(e){b(S(this,Lt),e,!0)}get savedWeeks(){return i(S(this,Mt))}set savedWeeks(e){b(S(this,Mt),e,!0)}get cityOptions(){return i(S(this,Wt))}set cityOptions(e){b(S(this,Wt),e,!0)}get showSetupModal(){return i(S(this,Rt))}set showSetupModal(e){b(S(this,Rt),e,!0)}setupEventListeners(){window.addEventListener("online",()=>{this.isOnline=!0,this.syncPendingData()}),window.addEventListener("offline",()=>this.isOnline=!1),document.addEventListener("click",e=>{e.target.closest(".dropdown-portal,.clickable")||(this.showCitySelector=this.showWeekSelector=!1)})}async init(){if(console.log("PlannerStore init() called"),!await this.checkDatabaseInitialized()){console.log("Database not initialized, showing setup notification"),this.showSetupNotification(),this.isInitializing=!1;return}this.pendingSync=JSON.parse(localStorage.getItem("planner_pending_sync")||"[]"),this.currentWeek=this.getCurrentIsoWeek(),this.dateRange=this.getWeekDateRange(this.parseISOWeek(this.currentWeek)),await this.loadWeek(this.currentWeek,!0),setInterval(()=>{!this.isInitializing&&this.hasSignificantChanges()&&this.saveData()},3e4),this.isOnline&&this.syncPendingData()}async checkDatabaseInitialized(){try{const e=await this.pb.collection("templates").getFirstListItem("is_default=true");return!0}catch(e){return console.log("Database not initialized:",e.message),!1}}showSetupNotification(){const e=document.createElement("div");e.className="setup-notification",e.innerHTML=`
      <span>Database not initialized</span>
      <button class="setup-notification-button">Setup</button>
    `,document.body.appendChild(e);const a=e.querySelector(".setup-notification-button");a&&a.addEventListener("click",()=>{this.showSetupModal=!0})}async fetchTemplate(e="default"){const a=`template_${e}`;try{const n=localStorage.getItem(a);if(n)return JSON.parse(n)}catch{localStorage.removeItem(a)}if(!this.isOnline)return this.showMessage("Offline: Using fallback template"),this.getFallbackTemplate();try{const n=e==="default"?"is_default=true":`name="${e}"`,r=await this.pb.collection("templates").getFirstListItem(n);return localStorage.setItem(a,JSON.stringify(r)),r}catch{return this.showMessage("Template error: Using fallback"),this.getFallbackTemplate()}}getFallbackTemplate(){return{id:"fallback",name:"fallback",structure:{prayer_times:[{label:"Q",value:""},{label:"F",value:""},{label:"D",value:""},{label:"A",value:""},{label:"M",value:""},{label:"I",value:""}],schedule:[{name:"TOTAL",activities:[{name:"DAILY POINTS",max_per_day:0,max_score:0}]}],tasks:{count:5,fields:["num","priority","tag","description","start_date","expected_date","actual_date","completed"]},workout:[],meals:[],grocery:{categories:[]},measurements:[],financials:[],city_default:"London"}}}applyTemplateStructure(e){var n,r;this.currentTemplate=e,this.currentTemplateId=e.id;const a=e.structure;this.plannerTitle=a.title_default||"Weekly Planner",this.times=[...a.prayer_times||[]],this.schedule=this.buildScheduleFromTemplate(a.schedule||[]),this.tasks=Array(((n=a.tasks)==null?void 0:n.count)||15).fill().map(()=>({id:rt(),priority:"",tag:"",description:"",startDate:"",expectedDate:"",actualDate:"",completed:""})),this.workoutPlan=this.buildWorkoutFromTemplate(a.workout||[]),this.meals=this.ensureIds([...a.meals||[]]),this.groceryList=this.ensureIds([...((r=a.grocery)==null?void 0:r.categories)||[]]),this.bodyMeasurements=this.ensureIds([...a.measurements||[]]),this.financials=this.ensureIds([...a.financials||[]]),this.city=a.city_default||"London"}buildScheduleFromTemplate(e){return e.map(a=>({id:rt(),name:a.name,activities:(a.activities||[]).map(n=>({id:rt(),name:n.name,days:this.createDaysStructure(n.days,n.max_per_day||1),score:0,maxScore:n.max_score||0,streaks:{current:0,longest:0}}))}))}createDaysStructure(e,a){const n=["mon","tue","wed","thu","fri","sat","sun"],r={};return(e&&Array.isArray(e)?e:n).forEach(o=>{r[o]={value:"",max:a}}),r}buildWorkoutFromTemplate(e){return e.map(a=>({id:rt(),name:a.name,exercises:this.ensureIds((a.exercises||[]).map(n=>{var r,s,o;return{prefix:"â€¢ ",name:n.name,weight:"",sets:"",reps:"",defaultWeight:((r=n.default_weight)==null?void 0:r.toString())||"",defaultSets:((s=n.default_sets)==null?void 0:s.toString())||"",defaultReps:((o=n.default_reps)==null?void 0:o.toString())||""}}))}))}ensureIds(e){return e.map(a=>({...a,id:a.id||rt()}))}async loadWeek(e,a=!1){if(!/^\\d{4}-W(0[1-9]|[1-4]\\d|5[0-3])$/.test(e)){this.showMessage("Invalid week format");return}this.showWeekSelector=!1,this.currentWeek=e,this.dateRange=this.getWeekDateRange(this.parseISOWeek(e));let n=await this.fetchPlannerRecord(e),r;n!=null&&n.template_id?r=await this.fetchTemplateById(n.template_id):r=await this.fetchTemplate("default"),this.applyTemplateStructure(r),n&&this.overlayUserData(n),this.calculateScores(),a&&!this.times.some(s=>s.value)&&await this.getPrayerTimes(),this.lastSavedState=JSON.stringify(this.getCurrentUserData()),a&&(this.isInitializing=!1)}async fetchPlannerRecord(e){if(this.isOnline)try{return await this.pb.collection("planners").getFirstListItem(`week_id="${e}"`)}catch{}const a=localStorage.getItem(`planner_${e}`);if(a)try{return JSON.parse(a)}catch{}return null}async fetchTemplateById(e){try{return await this.pb.collection("templates").getOne(e)}catch{return await this.fetchTemplate("default")}}overlayUserData(e){var a;e.title&&(this.plannerTitle=e.title),e.city&&(this.city=e.city),e.prayer_times&&this.overlayArray(this.times,e.prayer_times),e.schedule_data&&this.overlayComplexData(this.schedule,e.schedule_data,"name",this.overlayScheduleActivity),e.tasks_data&&this.overlayArray(this.tasks,e.tasks_data),e.workout_data&&this.overlayComplexData(this.workoutPlan,e.workout_data,"name",this.overlayWorkoutExercise),e.meals_data&&this.overlayArray(this.meals,e.meals_data),(a=e.grocery_data)!=null&&a.categories&&this.overlayArray(this.groceryList,e.grocery_data.categories),e.measurements_data&&this.overlayArray(this.bodyMeasurements,e.measurements_data),e.financials_data&&this.overlayArray(this.financials,e.financials_data)}overlayArray(e,a){a.forEach((n,r)=>{e[r]&&Object.assign(e[r],n)})}overlayComplexData(e,a,n,r){a.forEach(s=>{const o=e.find(u=>u[n]===s[n]);o&&r.call(this,o,s)})}overlayScheduleActivity(e,a){var n;(n=a.activities)==null||n.forEach(r=>{const s=e.activities.find(o=>o.name===r.name);s&&(r.days&&Object.keys(s.days).forEach(o=>{r.days[o]&&(s.days[o].value=r.days[o].value||"")}),s.score=r.score||0,s.streaks=r.streaks||{current:0,longest:0})})}overlayWorkoutExercise(e,a){var n;(n=a.exercises)==null||n.forEach(r=>{const s=e.exercises.find(o=>o.name===r.name);s&&(s.weight=r.weight||"",s.sets=r.sets||"",s.reps=r.reps||"")})}getCurrentUserData(){var e,a,n,r;return{week_id:this.currentWeek,template_id:this.currentTemplateId,title:this.plannerTitle!==((a=(e=this.currentTemplate)==null?void 0:e.structure)==null?void 0:a.title_default)?this.plannerTitle:null,city:this.city!==((r=(n=this.currentTemplate)==null?void 0:n.structure)==null?void 0:r.city_default)?this.city:null,date_range:this.dateRange,prayer_times:this.times.some(s=>s.value)?this.times:null,schedule_data:this.extractScheduleData(),tasks_data:this.extractUserTasks(),workout_data:this.extractWorkoutData(),meals_data:this.extractUserItems(this.meals,["name","ingredients"]),grocery_data:this.extractGroceryData(),measurements_data:this.extractUserItems(this.bodyMeasurements,["value"]),financials_data:this.extractUserItems(this.financials,["value"])}}extractScheduleData(){return this.extractComplexData(this.schedule,e=>({name:e.name,activities:e.activities.map(a=>({name:a.name,days:Object.keys(a.days).reduce((n,r)=>(a.days[r].value&&(n[r]={value:a.days[r].value}),n),{}),score:a.score,streaks:a.streaks})).filter(a=>Object.keys(a.days).length>0||a.score>0)}),e=>e.activities.length>0)}extractUserTasks(){return this.tasks.filter(e=>e.priority||e.tag||e.description||e.startDate||e.expectedDate||e.actualDate||e.completed)}extractWorkoutData(){return this.extractComplexData(this.workoutPlan,e=>({name:e.name,exercises:e.exercises.filter(a=>a.weight||a.sets||a.reps).map(a=>({name:a.name,weight:a.weight,sets:a.sets,reps:a.reps}))}),e=>e.exercises.length>0)}extractComplexData(e,a,n=()=>!0){return e.map(a).filter(n)}extractUserItems(e,a){return e.filter(n=>a.some(r=>n[r]))}extractGroceryData(){const e=this.extractUserItems(this.groceryList,["name","items"]);return e.length>0?{categories:e}:null}getTaskDelay(e){if(!e.expectedDate||!e.actualDate)return 0;const a=new Date(e.expectedDate),n=new Date(e.actualDate);return Math.ceil((n-a)/(1e3*60*60*24))}calculateTaskDelay(e){return e._delay=this.getTaskDelay(e),e._delay}formatDelay(e){return e===0?"0d":e>0?`+${e}d`:`${e}d`}toggleTaskCompletion(e){e.completed=e.completed==="âœ“"?"â˜":"âœ“",e.completed==="âœ“"&&!e.actualDate&&(e.actualDate=new Date().toISOString().split("T")[0],this.calculateTaskDelay(e)),this.saveData()}toggleSelector(e,a){const n=a==="city"?"showCitySelector":"showWeekSelector",r=a==="city"?"showWeekSelector":"showCitySelector";if(this[r]=!1,this[n])this[n]=!1;else{const s=e.target.getBoundingClientRect();this[`${a}DropdownStyle`]=`position:fixed;top:${s.bottom+4}px;left:${Math.max(10,s.left-100)}px;z-index:9999;min-width:150px;max-width:250px;`,this[n]=!0,a==="week"&&this.fetchSavedWeeks()}}async selectCity(e){this.city=e.name,this.showCitySelector=!1;try{e.lat===null?await this.getPrayerTimes():await this.fetchPrayerTimes(e.lat,e.lon),this.saveData()}catch{this.showMessage("Failed to load prayer times")}}async getPrayerTimes(){var e,a,n;try{const r=await new Promise((u,l)=>navigator.geolocation.getCurrentPosition(u,l,{timeout:5e3,maximumAge:6e4})),{latitude:s,longitude:o}=r.coords;try{const l=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${o}&zoom=10&accept-language=en`)).json();this.city=((e=l.address)==null?void 0:e.city)||((a=l.address)==null?void 0:a.town)||((n=l.address)==null?void 0:n.village)||"Current Location"}catch{this.city="Current Location"}await this.fetchPrayerTimes(s,o)}catch{this.showMessage("Location access failed. Using London"),this.city="London",await this.fetchPrayerTimes(51.5074,-.1278)}}async fetchPrayerTimes(e,a){var u,l;const n=new Date,s=`prayer_times_${`${n.getFullYear()}_${n.getMonth()+1}_${n.getDate()}`}_${e.toFixed(2)}_${a.toFixed(2)}`,o=localStorage.getItem(s);if(o)try{this.setPrayerTimes(JSON.parse(o));return}catch{localStorage.removeItem(s)}try{const c=await fetch(`https://api.aladhan.com/v1/calendar/${n.getFullYear()}/${n.getMonth()+1}?latitude=${e}&longitude=${a}&method=2`);if(!c.ok)throw new Error(`API error: ${c.status}`);const f=await c.json();if(f.code===200&&((l=(u=f.data)==null?void 0:u[n.getDate()-1])!=null&&l.timings))localStorage.setItem(s,JSON.stringify(f.data[n.getDate()-1].timings)),this.setPrayerTimes(f.data[n.getDate()-1].timings);else throw new Error("Invalid prayer time data")}catch{this.showMessage("Prayer times fetch failed"),this.setPrayerTimes({Fajr:"05:30",Dhuhr:"12:30",Asr:"15:45",Maghrib:"18:30",Isha:"20:00"})}}setPrayerTimes(e){const a={Q:this.calculateQiyamTime(e.Fajr),F:e.Fajr,D:e.Dhuhr,A:e.Asr,M:e.Maghrib,I:e.Isha};this.times.reduce((r,s)=>{const o=this.formatTime(a[s.label]);return s.value!==o?(s.value=o,!0):r},!1)&&!this.isInitializing&&this.saveData()}formatTime(e){if(!e)return"";const[a,n]=e.split(" ")[0].split(":"),r=parseInt(a),s=parseInt(n);return isNaN(r)||isNaN(s)?"":`${r%12||12}:${s.toString().padStart(2,"0")}${r>=12?"PM":"AM"}`}calculateQiyamTime(e){if(!e)return"";const[a,n]=e.split(" ")[0].split(":");let r=parseInt(a),s=parseInt(n);return isNaN(r)||isNaN(s)?"":(r=r-1,r<0&&(r=23),`${r}:${s.toString().padStart(2,"0")}`)}calculateScores(){var r;const e={mon:0,tue:0,wed:0,thu:0,fri:0,sat:0,sun:0},a=Object.keys(e);this.schedule.forEach(s=>{s.name!=="TOTAL"&&s.activities.forEach(o=>{let u=0;Object.entries(o.days||{}).forEach(([f,d])=>{if(!d)return;const v=parseInt(d.value)||0;v>0&&(d.max||0)>0&&(e[f]+=v,u+=v),d.value=v===0?"":v.toString()}),o.score=u,o.streaks=o.streaks||{current:0,longest:0};const l=this.currentDay===0?6:this.currentDay-1;let c=0;for(let f=0;f<7;f++){const d=(l-f+7)%7,v=a[d];if(o.days[v]&&parseInt(o.days[v].value)>0&&(o.days[v].max||0)>0)c++;else break}o.streaks.current=c,o.streaks.longest=Math.max(o.streaks.longest||0,c)})});const n=this.schedule.find(s=>s.name==="TOTAL");if((r=n==null?void 0:n.activities)!=null&&r[0]){const s=n.activities[0];let o=0,u=0;Object.entries(e).forEach(([l,c])=>{var f;(f=s.days)!=null&&f[l]&&(s.days[l].value=c.toString()),o+=c}),this.schedule.forEach(l=>{l.name!=="TOTAL"&&l.activities.forEach(c=>u+=c.maxScore||0)}),s.score=o,s.maxScore=u}}validateAndSave(e){const a=e.target,n=parseFloat(a.min),r=parseFloat(a.max);let s=parseFloat(a.value);isNaN(s)&&(s=0),!isNaN(n)&&s<n&&(s=n),!isNaN(r)&&s>r&&(s=r),a.value=s===0?"":s.toString(),this.calculateScores(),this.saveData()}saveData(){this.isInitializing||(clearTimeout(this.saveTimeout),this.saveStatus="saving",this.saveTimeout=setTimeout(async()=>{try{this.calculateScores();const e=this.getCurrentUserData();localStorage.setItem(`planner_${this.currentWeek}`,JSON.stringify(e)),this.isOnline?(await this.saveToPocketbase(this.currentWeek,e),this.pendingSync=this.pendingSync.filter(a=>!(a.weekId===this.currentWeek&&a.operation!=="delete"))):this.addToPendingSync(this.currentWeek,e),localStorage.setItem("planner_pending_sync",JSON.stringify(this.pendingSync)),this.lastSavedState=JSON.stringify(e),this.saveStatus="saved"}catch(e){this.saveStatus="error",this.showMessage("Save error: "+e.message),setTimeout(()=>this.saveStatus="saved",3e3)}},500))}hasSignificantChanges(){if(!this.lastSavedState)return!0;const e=this.getCurrentUserData();return JSON.stringify(e)!==this.lastSavedState}addToPendingSync(e,a,n="save"){this.pendingSync=this.pendingSync.filter(r=>!(r.weekId===e&&r.operation===n)),this.pendingSync.push({weekId:e,data:a?JSON.parse(JSON.stringify(a)):null,operation:n,timestamp:new Date().toISOString()}),localStorage.setItem("planner_pending_sync",JSON.stringify(this.pendingSync))}async syncPendingData(){if(!this.isOnline||this.pendingSync.length===0)return;const e=[...this.pendingSync];this.pendingSync=[];for(const a of e)try{a.operation==="delete"?await this.deleteFromPocketbase(a.weekId):await this.saveToPocketbase(a.weekId,a.data);const n=JSON.parse(localStorage.getItem("planner_pending_sync")||"[]");localStorage.setItem("planner_pending_sync",JSON.stringify(n.filter(r=>r.timestamp!==a.timestamp)))}catch{this.pendingSync.push(a)}this.pendingSync.length>0&&localStorage.setItem("planner_pending_sync",JSON.stringify(this.pendingSync))}async saveToPocketbase(e,a){try{const n=await this.pb.collection("planners").getFirstListItem(`week_id="${e}"`);await this.pb.collection("planners").update(n.id,a)}catch(n){if(n.status===404)await this.pb.collection("planners").create(a);else throw n}}async deleteFromPocketbase(e){try{const a=await this.pb.collection("planners").getFirstListItem(`week_id="${e}"`);await this.pb.collection("planners").delete(a.id)}catch(a){if(a.status!==404)throw a}}async fetchSavedWeeks(){const e=new Map,a=this.getCurrentIsoWeek(),n=(r,s,o,u)=>{const l=e.get(r),c=s||this.getWeekDateRange(this.parseISOWeek(r));!l||o==="pocketbase"&&l.source!=="pocketbase"||o==="local"&&l.source==="current"?e.set(r,{iso_week:r,dateRange:c,source:o,isCurrent:u}):l&&!l.dateRange&&c&&(l.dateRange=c)};if(n(a,this.getWeekDateRange(this.parseISOWeek(a)),"current",!0),this.isOnline)try{(await this.pb.collection("planners").getFullList({sort:"-week_id",fields:"week_id,date_range"})).forEach(s=>n(s.week_id,s.date_range,"pocketbase",s.week_id===a))}catch{}for(let r=0;r<localStorage.length;r++){const s=localStorage.key(r);if(s.startsWith("planner_")&&!s.includes("pending_sync")&&!s.startsWith("planner_template_")){const o=s.replace("planner_","");try{const u=JSON.parse(localStorage.getItem(s));n(o,u.date_range,"local",o===a)}catch{}}}this.savedWeeks=Array.from(e.values()).sort((r,s)=>r.isCurrent&&!s.isCurrent?-1:!r.isCurrent&&s.isCurrent?1:s.iso_week.localeCompare(r.iso_week))}confirmLoadWeek(e){this.hasSignificantChanges()&&e!==this.currentWeek&&!confirm("Unsaved changes. Load anyway?")||(this.showWeekSelector=!1,this.loadWeek(e))}confirmDeleteWeek(e){confirm(`Delete schedule for ${e}?`)&&this.deleteWeek(e)}async deleteWeek(e){if(localStorage.removeItem(`planner_${e}`),this.isOnline)try{await this.deleteFromPocketbase(e)}catch{this.addToPendingSync(e,null,"delete")}else this.addToPendingSync(e,null,"delete");this.savedWeeks=this.savedWeeks.filter(a=>a.iso_week!==e),this.currentWeek===e&&(this.currentWeek=this.getCurrentIsoWeek(),await this.loadWeek(this.currentWeek))}getCurrentIsoWeek(){const e=new Date,a=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()));a.setUTCDate(a.getUTCDate()+4-(a.getUTCDay()||7));const n=new Date(Date.UTC(a.getUTCFullYear(),0,1)),r=Math.ceil(((a-n)/864e5+1)/7);return`${a.getUTCFullYear()}-W${r.toString().padStart(2,"0")}`}parseISOWeek(e){if(!/^\\d{4}-W(0[1-9]|[1-4]\\d|5[0-3])$/.test(e))return new Date;const[a,n]=e.split("-"),r=parseInt(n.substring(1)),s=new Date(Date.UTC(parseInt(a),0,1+(r-1)*7));return s.setUTCDate(s.getUTCDate()-(s.getUTCDay()||7)+1),s}getWeekDateRange(e){const a=new Date(e),n=new Date(a);return n.setUTCDate(a.getUTCDate()+6),`${this.formatDate(a)}-${this.formatDate(n)}`}formatDate(e){return`${(e.getUTCMonth()+1).toString().padStart(2,"0")}/${e.getUTCDate().toString().padStart(2,"0")}`}showMessage(e){this.notificationMessage=e,this.showNotification=!0,clearTimeout(this.notificationTimeout),this.notificationTimeout=setTimeout(()=>this.showNotification=!1,5e3)}}ft=new WeakMap,dt=new WeakMap,vt=new WeakMap,pt=new WeakMap,_t=new WeakMap,ht=new WeakMap,mt=new WeakMap,gt=new WeakMap,yt=new WeakMap,wt=new WeakMap,bt=new WeakMap,St=new WeakMap,xt=new WeakMap,kt=new WeakMap,Dt=new WeakMap,Tt=new WeakMap,Et=new WeakMap,It=new WeakMap,Ct=new WeakMap,Ot=new WeakMap,Pt=new WeakMap,At=new WeakMap,$t=new WeakMap,Nt=new WeakMap,Lt=new WeakMap,Mt=new WeakMap,Wt=new WeakMap,Rt=new WeakMap;const p=new Yr;window.plannerStore=p;var Hr=()=>p.saveData(),Vr=I('<div class="flex center"><span> </span> <input type="text" class="input input--time"/></div>'),Kr=t=>p.toggleSelector(t,"city"),Gr=t=>p.toggleSelector(t,"week"),Qr=I('<div class="flex between center mb-1"><h1 class="text-sm bold"> </h1> <div class="flex center text-xs"><!> <span class="ml-1">|</span> <span class="clickable ml-1"> </span></div> <div class="text-sm"><span class="clickable"> </span> <span> </span></div></div>');function Xr(t,e){_e(e,!1),De();var a=Qr(),n=_(a),r=_(n),s=m(n,2),o=_(s);se(o,1,()=>(A(p),y(()=>p.times)),qe,(g,x,w)=>{var k=Vr(),P=_(k),$=_(P),D=m(P,2);D.__change=[Hr],M(()=>N($,`${i(x),y(()=>i(x).label)??""}:`)),oe(D,()=>i(x).value,O=>(i(x).value=O,re(()=>p))),T(g,k)});var u=m(o,4);u.__click=[Kr];var l=_(u),c=m(s,2),f=_(c);f.__click=[Gr];var d=_(f),v=m(f,2),h=_(v);M(()=>{N(r,(A(p),y(()=>p.plannerTitle))),N(l,(A(p),y(()=>p.city))),N(d,(A(p),y(()=>p.currentWeek))),N(h,(A(p),y(()=>p.dateRange)))}),T(t,a),he()}Ye(["change","click"]);var Zr=I("<th> </th> <th>MAX</th>",1),es=t=>p.validateAndSave(t),ts=I('<input type="number" class="input" min="0"/>'),as=I("<td><!></td> <td> </td>",1),ns=I("<span> </span>"),rs=I('<tr><td class="bold"> </td><td class="bold"> </td><td class="ac"><span> </span></td><!><td class="dc"><input type="number" class="input" readonly=""/></td><td class="dc"> </td><td><!></td></tr>'),ss=I('<tr><td colspan="19" class="progress"><div></div></td></tr>'),is=I("<!> <!>",1),ls=I('<table><thead><tr><th style="width:18mm">T</th><th style="width:20mm">D</th><th class="ac">ACTIVITY</th><!><th class="dc">ðŸ“Š</th><th class="dc">ðŸŽ¯</th><th class="dc">ðŸ”¥</th></tr></thead><tbody></tbody></table>');function os(t,e){_e(e,!1);const a=["M","T","W","T","F","S","S"],n=["mon","tue","wed","thu","fri","sat","sun"];De();var r=ls(),s=_(r),o=_(s),u=m(_(o),3);se(u,1,()=>a,qe,(c,f,d)=>{var v=Zr(),h=Pe(v);let g;var x=_(h),w=m(h,2);let k;M((P,$)=>{g=Q(h,1,"dc",null,g,P),N(x,i(f)),k=Q(w,1,"dc",null,k,$)},[()=>({"current-day":d===(p.currentDay||7)-1}),()=>({"current-day":d===(p.currentDay||7)-1})],Le),T(c,v)});var l=m(s);se(l,5,()=>(A(p),y(()=>[...p.schedule].reverse())),qe,(c,f)=>{var d=is(),v=Pe(d);se(v,1,()=>(i(f),y(()=>i(f).activities)),qe,(x,w,k)=>{var P=rs();let $;var D=_(P),O=_(D),te=m(D),j=_(te),Z=m(te),Te=_(Z),Se=_(Te),ue=m(Z);se(ue,1,()=>n,qe,(ae,F,ke)=>{var q=as(),C=Pe(q);let U;var B=_(C);{var ce=ee=>{var H=ts();H.__input=[es],M(()=>{Be(H,"max",(i(w),i(F),y(()=>i(w).days[i(F)].max<10?9:99))),H.readOnly=(i(f),y(()=>i(f).name==="TOTAL"))}),oe(H,()=>i(w).days[i(F)].value,fe=>(i(w).days[i(F)].value=fe,re(()=>(i(f),p)))),T(ee,H)};J(B,ee=>{i(w),i(F),y(()=>i(w).days&&i(w).days[i(F)])&&ee(ce)})}var G=m(C,2);let Y;var ie=_(G);M((ee,H)=>{U=Q(C,1,"dc",null,U,ee),Y=Q(G,1,"dc",null,Y,H),N(ie,(i(w),i(F),y(()=>{var fe,K;return((K=(fe=i(w).days)==null?void 0:fe[i(F)])==null?void 0:K.max)||""})))},[()=>({"current-day":ke===(p.currentDay||7)-1}),()=>({"current-day":ke===(p.currentDay||7)-1})],Le),T(ae,q)});var me=m(ue),Fe=_(me),xe=m(me),Ee=_(xe),Ie=m(xe);let Ne;var Ce=_(Ie);{var Qe=ae=>{var F=ns(),ke=_(F);M(()=>N(ke,(i(w),y(()=>i(w).streaks.current)))),T(ae,F)};J(Ce,ae=>{i(w),y(()=>{var F;return((F=i(w).streaks)==null?void 0:F.current)>0})&&ae(Qe)})}M((ae,F,ke,q)=>{$=Q(P,1,"",null,$,ae),N(O,(i(f),y(()=>k===0?i(f).name:""))),N(j,F),N(Se,ke),wn(Fe,(i(w),y(()=>i(w).score))),N(Ee,(i(w),y(()=>i(w).maxScore))),Ne=Q(Ie,1,"dc cell cell--color",null,Ne,q)},[()=>({total:i(f).name==="TOTAL"}),()=>(i(w),y(()=>i(w).name.includes(":")?i(w).name.split(":")[0]:"")),()=>(i(w),y(()=>i(w).name.includes(":")?i(w).name.split(":")[1].trim():i(w).name)),()=>{var ae,F;return{streak:((ae=i(w).streaks)==null?void 0:ae.current)>2,yellow:((F=i(w).streaks)==null?void 0:F.current)>2}}],Le),T(x,P)});var h=m(v,2);{var g=x=>{var w=ss();const k=Le(()=>(i(f),y(()=>i(f).activities[0]))),P=Le(()=>(A(i(k)),y(()=>i(k).maxScore>0?Math.min(100,i(k).score/i(k).maxScore*100):0))),$=Le(()=>(A(i(k)),y(()=>i(k).maxScore>0?i(k).score/i(k).maxScore<.33?"progress--low":i(k).score/i(k).maxScore<.66?"progress--medium":"progress--high":"")));var D=_(w),O=_(D);M(()=>{Q(O,1,`progress__bar ${i($)??""}`),ea(O,`width: ${i(P)??""}%`)}),T(x,w)};J(h,x=>{i(f),y(()=>{var w;return i(f).name==="TOTAL"&&((w=i(f).activities)==null?void 0:w.length)>0&&i(f).activities[0].maxScore>0})&&x(g)})}T(c,d)}),T(t,r),he()}Ye(["input"]);var us=()=>p.saveData(),cs=()=>p.saveData(),fs=()=>p.saveData(),ds=I('<tr><td class="dc"> </td><td><select class="input"><option></option><option>A</option><option>B</option><option>C</option><option>D</option></select></td><td><input type="text" class="input input--text"/></td><td><select class="input"><option></option><option>Personal</option><option>Work</option></select></td><td><input type="text" class="input input--date"/></td><td><input type="text" class="input input--date"/></td><td><span> </span></td><td><input type="text" class="input input--date"/></td><td><input type="text" placeholder="â˜" readonly=""/></td></tr>'),vs=I('<div class="section"><h3 class="title">TASKS & PROJECT MANAGEMENT</h3> <table><thead><tr><th>#</th><th>â­</th><th>Task</th><th>ðŸ·ï¸</th><th class="icon-header">Start</th><th class="icon-header">Due</th><th class="icon-header">Delay</th><th class="icon-header">Done</th><th>âœ“</th></tr></thead><tbody></tbody></table></div>');function ps(t,e){_e(e,!1);function a(u){const l=[];u.completed==="âœ“"&&l.push("green");const c=p.getTaskDelay(u);return c>0?l.push("red"):c<0&&l.push("blue"),l.join(" ")}function n(u){return u<0?"green":u>0?"red":"yellow"}De();var r=vs(),s=m(_(r),2),o=m(_(s));se(o,7,()=>(A(p),y(()=>p.tasks)),(u,l)=>u.id||l,(u,l,c)=>{var f=ds(),d=_(f),v=_(d),h=m(d),g=_(h);M(()=>{i(l),re(()=>{})}),g.__change=[us];var x=_(g);x.value=x.__value="";var w=m(x);w.value=w.__value="A";var k=m(w);k.value=k.__value="B";var P=m(k);P.value=P.__value="C";var $=m(P);$.value=$.__value="D";var D=m(h),O=_(D);O.__change=[cs];var te=m(D),j=_(te);M(()=>{i(l),re(()=>{})}),j.__change=[fs];var Z=_(j);Z.value=Z.__value="";var Te=m(Z);Te.value=Te.__value="P";var Se=m(Te);Se.value=Se.__value="W";var ue=m(te),me=_(ue);me.__change=()=>{p.calculateTaskDelay(i(l)),p.saveData()};var Fe=m(ue),xe=_(Fe);xe.__change=()=>{p.calculateTaskDelay(i(l)),p.saveData()};var Ee=m(Fe),Ie=_(Ee),Ne=_(Ie),Ce=m(Ee),Qe=_(Ce);Qe.__change=()=>{p.calculateTaskDelay(i(l)),p.saveData()};var ae=m(Ce),F=_(ae);let ke;F.__click=q=>{q.preventDefault(),p.toggleTaskCompletion(i(l))},M((q,C,U,B)=>{Q(f,1,q),N(v,i(c)+1),Q(Ee,1,`dc cell cell--bold ${C??""}`),N(Ne,U),ke=Q(F,1,"input",null,ke,B),wn(F,(i(l),y(()=>i(l).completed)))},[()=>Nr((i(l),y(()=>a(i(l))))),()=>(A(p),i(l),y(()=>n(p.getTaskDelay(i(l))))),()=>(A(p),i(l),y(()=>p.formatDelay(p.getTaskDelay(i(l))))),()=>({"task-done":i(l).completed==="âœ“"})],Le),Fa(g,()=>i(l).priority,q=>(i(l).priority=q,re(()=>p))),oe(O,()=>i(l).description,q=>(i(l).description=q,re(()=>p))),Fa(j,()=>i(l).tag,q=>(i(l).tag=q,re(()=>p))),oe(me,()=>i(l).startDate,q=>(i(l).startDate=q,re(()=>p))),oe(xe,()=>i(l).expectedDate,q=>(i(l).expectedDate=q,re(()=>p))),oe(Qe,()=>i(l).actualDate,q=>(i(l).actualDate=q,re(()=>p))),T(u,f)}),T(t,r),he()}Ye(["change","click"]);var _s=()=>p.saveData(),hs=()=>p.saveData(),ms=()=>p.saveData(),gs=I('<div class="exercise"><div class="exercise-name"><span> </span> <span> </span>:</div> <div class="exercise-inputs"><input type="number" class="input"/> <span class="exercise-unit">kg,</span> <input type="number" class="input sets"/> <span class="exercise-unit">Ã—</span> <input type="number" class="input reps"/></div></div>'),ys=I('<div class="p-1 workout-day-card"><p class="bold text-center mb-1 workout-day-name"> </p> <!></div>'),ws=I('<div class="section"><h3 class="title">WORKOUT</h3> <div class="grid"></div></div>');function bs(t,e){_e(e,!1),De();var a=ws(),n=m(_(a),2);se(n,5,()=>(A(p),y(()=>p.workoutPlan)),r=>r.id,(r,s)=>{var o=ys(),u=_(o),l=_(u),c=m(u,2);se(c,1,()=>(i(s),y(()=>i(s).exercises)),f=>f.id,(f,d,v)=>{var h=gs(),g=_(h),x=_(g),w=_(x),k=m(x,2),P=_(k),$=m(g,2),D=_($);D.__input=[_s];var O=m(D,4);O.__input=[hs];var te=m(O,4);te.__input=[ms],M(()=>{Be(g,"title",`${i(d),y(()=>i(d).prefix)??""}${i(d),y(()=>i(d).name)??""}`),N(w,(i(d),y(()=>i(d).prefix))),N(P,(i(d),y(()=>i(d).name))),Be(D,"placeholder",(i(d),y(()=>i(d).defaultWeight))),Be(O,"placeholder",(i(d),y(()=>i(d).defaultSets))),Be(te,"placeholder",(i(d),y(()=>i(d).defaultReps)))}),oe(D,()=>i(d).weight,j=>(i(d).weight=j,re(()=>(i(s),p)))),oe(O,()=>i(d).sets,j=>(i(d).sets=j,re(()=>(i(s),p)))),oe(te,()=>i(d).reps,j=>(i(d).reps=j,re(()=>(i(s),p)))),T(f,h)}),M(()=>N(l,(i(s),y(()=>i(s).name)))),T(r,o)}),T(t,a),he()}Ye(["input"]);var Ss=I('<div class="mb-05"><span class="bold"> </span> <span> </span></div>'),xs=I('<div class="section"><h3 class="title">MEALS</h3> <div class="text-xs"></div></div>');function ks(t,e){_e(e,!1),De();var a=xs(),n=m(_(a),2);se(n,5,()=>(A(p),y(()=>p.meals)),r=>r.id,(r,s)=>{var o=Ss(),u=_(o),l=_(u),c=m(u,2),f=_(c);M(()=>{N(l,`${i(s),y(()=>i(s).name)??""}:`),N(f,(i(s),y(()=>i(s).ingredients)))}),T(r,o)}),T(t,a),he()}var Ds=I('<div class="mb-05"><span class="bold"> </span> <span> </span></div>'),Ts=I('<div class="section"><h3 class="title">GROCERY</h3> <div class="text-xs"></div></div>');function Es(t,e){_e(e,!1),De();var a=Ts(),n=m(_(a),2);se(n,5,()=>(A(p),y(()=>p.groceryList)),r=>r.id,(r,s)=>{var o=Ds(),u=_(o),l=_(u),c=m(u,2),f=_(c);M(()=>{N(l,`${i(s),y(()=>i(s).name)??""}:`),N(f,(i(s),y(()=>i(s).items)))}),T(r,o)}),T(t,a),he()}var Is=()=>p.saveData(),Cs=I('<span><span> </span> <input type="text" class="input input--inline"/> <!></span>'),Os=I('<div class="section"><h3 class="title">BODY</h3> <div class="text-xs"></div></div>');function Ps(t,e){_e(e,!1),De();var a=Os(),n=m(_(a),2);se(n,7,()=>(A(p),y(()=>p.bodyMeasurements)),r=>r.id,(r,s,o)=>{var u=Cs(),l=_(u),c=_(l),f=m(l,2);f.__change=[Is];var d=m(f,2);{var v=h=>{var g=Zt(",");T(h,g)};J(d,h=>{A(i(o)),A(p),y(()=>i(o)<p.bodyMeasurements.length-1)&&h(v)})}M(()=>{N(c,`${i(s),y(()=>i(s).name)??""}:`),Be(f,"placeholder",(i(s),y(()=>i(s).placeholder)))}),oe(f,()=>i(s).value,h=>(i(s).value=h,re(()=>p))),T(r,u)}),T(t,a),he()}Ye(["change"]);var As=()=>p.saveData(),$s=I('<span><span> </span> Â£<input type="text" class="input input--inline"/> <span> </span> <!></span>'),Ns=I('<div class="section"><h3 class="title">FINANCIAL</h3> <div class="text-xs"></div></div>');function Ls(t,e){_e(e,!1),De();var a=Ns(),n=m(_(a),2);se(n,7,()=>(A(p),y(()=>p.financials)),r=>r.id,(r,s,o)=>{var u=$s(),l=_(u),c=_(l),f=m(l,2);f.__change=[As];var d=m(f,2),v=_(d),h=m(d,2);{var g=x=>{var w=Zt(",");T(x,w)};J(h,x=>{A(i(o)),A(p),y(()=>i(o)<p.financials.length-1)&&x(g)})}M(()=>{N(c,`${i(s),y(()=>i(s).name)??""}:`),Be(f,"placeholder",(i(s),y(()=>i(s).placeholder))),N(v,(i(s),y(()=>i(s).account)))}),oe(f,()=>i(s).value,x=>(i(s).value=x,re(()=>p))),T(r,u)}),T(t,a),he()}Ye(["change"]);var Ms=I('<div id="sync-status"><span> </span></div>'),Ws=I('<div id="notification" class="notification notification--show"> </div>'),Rs=I('<div id="save-status"> </div> <!> <!>',1);function Fs(t,e){_e(e,!1),De();var a=Rs(),n=Pe(a),r=_(n),s=m(n,2);{var o=c=>{var f=Ms(),d=_(f),v=_(d);M(()=>{Q(f,1,`status status--sync ${A(p),y(()=>p.pendingSync.length>0?"status-pending":"status-synced")??""}`),N(v,(A(p),y(()=>p.isOnline?p.pendingSync.length>0?"Pending: "+p.pendingSync.length:"":"Offline")))}),T(c,f)};J(s,c=>{A(p),y(()=>p.pendingSync.length>0||!p.isOnline)&&c(o)})}var u=m(s,2);{var l=c=>{var f=Ws(),d=_(f);M(()=>N(d,(A(p),y(()=>p.notificationMessage)))),T(c,f)};J(u,c=>{A(p),y(()=>p.showNotification)&&c(l)})}M(()=>{Q(n,1,`status status--save status-${A(p),y(()=>p.saveStatus)??""}`),N(r,(A(p),y(()=>p.saveStatus==="saving"?"Saving...":p.saveStatus==="error"?"Error!":"Saved")))}),T(t,a),he()}var Us=(t,e)=>p.selectCity(i(e)),js=I('<div class="dropdown__item"> </div>'),qs=I('<div class="dropdown-portal"><div class="dropdown__content"></div></div>'),Bs=(t,e)=>p.confirmLoadWeek(i(e).iso_week),zs=(t,e)=>p.confirmDeleteWeek(i(e).iso_week),Js=I('<div><span> </span> <span class="dropdown__delete">Ã—</span></div>'),Ys=I('<div class="dropdown__item--empty">No saved schedules</div>'),Hs=I('<div class="dropdown-portal"><div class="dropdown__content"><!></div></div>'),Vs=I("<!> <!>",1);function Ks(t,e){_e(e,!1),De();var a=Vs(),n=Pe(a);{var r=u=>{var l=qs(),c=_(l);se(c,5,()=>(A(p),y(()=>p.cityOptions)),qe,(f,d)=>{var v=js();v.__click=[Us,d];var h=_(v);M(()=>N(h,(i(d),y(()=>i(d).name)))),T(f,v)}),M(()=>ea(l,(A(p),y(()=>p.cityDropdownStyle)))),T(u,l)};J(n,u=>{A(p),y(()=>p.showCitySelector)&&u(r)})}var s=m(n,2);{var o=u=>{var l=Hs(),c=_(l),f=_(c);{var d=h=>{var g=Dr(),x=Pe(g);se(x,1,()=>(A(p),y(()=>p.savedWeeks)),qe,(w,k)=>{var P=Js();let $;var D=_(P);D.__click=[Bs,k];var O=_(D),te=m(D,2);te.__click=[zs,k],M(j=>{$=Q(P,1,"flex between center dropdown__item",null,$,j),N(O,`${i(k),y(()=>i(k).iso_week)??""} ${i(k),y(()=>i(k).dateRange)??""}`)},[()=>({"dropdown__item--current":i(k).isCurrent})],Le),T(w,P)}),T(h,g)},v=h=>{var g=Ys();T(h,g)};J(f,h=>{A(p),y(()=>p.savedWeeks.length>0)?h(d):h(v,!1)})}M(()=>ea(l,(A(p),y(()=>p.weekDropdownStyle)))),T(u,l)};J(s,u=>{A(p),y(()=>p.showWeekSelector)&&u(o)})}T(t,a),he()}Ye(["click"]);async function Gs(t,e,a,n,r){b(e,!0),b(a,"");try{(await fetch(`${i(n)}/api/health`)).ok?(b(a,"success"),b(r,2)):b(a,"error")}catch{b(a,"error")}finally{b(e,!1)}}var Qs=(t,e)=>t.target===t.currentTarget&&e(),Xs=I('<div><span class="setup-step-num svelte-1gw615y"> </span> <span class="setup-step-name text-xs svelte-1gw615y"> </span></div>'),Zs=I('<span class="text-xs ml-1 green svelte-1gw615y">âœ“ Connected</span>'),ei=I('<span class="text-xs ml-1 red svelte-1gw615y">âœ— Connection failed</span>'),ti=I('<div class="setup-section svelte-1gw615y"><h2 class="svelte-1gw615y">Step 1: PocketBase URL</h2> <p class="text-xs mb-05 svelte-1gw615y">Enter your PocketBase server URL</p> <input type="url" class="input input--text" placeholder="http://localhost:8090"/> <div class="flex center mt-1 svelte-1gw615y"><button> </button> <!></div></div>'),ai=(t,e)=>b(e,!i(e)),ni=I('<div class="setup-section svelte-1gw615y"><h2 class="svelte-1gw615y">Step 2: Admin Credentials</h2> <p class="text-xs mb-05 svelte-1gw615y">Enter your PocketBase admin credentials</p> <div class="mb-05 svelte-1gw615y"><input type="email" class="input input--text" placeholder="admin@example.com"/></div> <div class="mb-05 svelte-1gw615y" style="position: relative;"><input class="input input--text" placeholder="Password"/> <button class="setup-pass-toggle svelte-1gw615y"> </button></div> <button> </button></div>'),ri=I('<div class="setup-section svelte-1gw615y"><h2 class="svelte-1gw615y">Step 3: Create Collections</h2> <p class="text-xs mb-05 svelte-1gw615y">Create required database collections</p> <div class="setup-collections svelte-1gw615y"><div class="text-xs mb-05 svelte-1gw615y">â€¢ templates - Store planner templates</div> <div class="text-xs mb-05 svelte-1gw615y">â€¢ planners - Store weekly planner data</div></div> <button> </button></div>'),si=I('<div class="progress mb-05 svelte-1gw615y"><div class="progress__bar progress--high"></div></div> <p class="text-xs"> </p>',1),ii=I('<div class="text-xs mb-05 svelte-1gw615y"><!> Default template</div> <button>Seed Database</button>',1),li=I('<div class="setup-section svelte-1gw615y"><h2 class="svelte-1gw615y">Step 4: Seed Database</h2> <p class="text-xs mb-05 svelte-1gw615y">Initialize database with default template</p> <!></div>'),oi=I('<div class="setup-section svelte-1gw615y"><h2 class="svelte-1gw615y">âœ“ Setup Complete!</h2> <p class="text-xs mb-05 svelte-1gw615y">Your A4 Planner database is ready to use.</p> <button class="svelte-1gw615y">Start Using Planner</button></div>'),ui=I('<div class="setup-modal-overlay svelte-1gw615y"><div class="setup-modal-content svelte-1gw615y"><div class="setup-container svelte-1gw615y"><div class="flex between center mb-1 svelte-1gw615y"><h1 class="text-sm bold">A4 Planner - Database Setup</h1> <button class="clickable svelte-1gw615y">Ã—</button></div> <div class="setup-steps svelte-1gw615y"><div class="flex center mb-1 svelte-1gw615y"></div></div> <!> <!> <!> <!> <!> <div class="setup-help mt-1 svelte-1gw615y"><details class="svelte-1gw615y"><summary class="text-xs bold svelte-1gw615y">Help & Documentation</summary> <div class="text-xs mt-05 svelte-1gw615y"><h3 class="bold mb-05 svelte-1gw615y">Prerequisites:</h3> <p class="mb-05 svelte-1gw615y">1. PocketBase server running and accessible</p> <p class="mb-05 svelte-1gw615y">2. Admin account created in PocketBase</p> <h3 class="bold mb-05 mt-1 svelte-1gw615y">Setup Steps:</h3> <p class="mb-05 svelte-1gw615y">1. <b>PocketBase URL:</b> Enter the URL where your PocketBase is running (e.g., http://localhost:8090)</p> <p class="mb-05 svelte-1gw615y">2. <b>Admin Credentials:</b> Use your PocketBase admin email and password</p> <p class="mb-05 svelte-1gw615y">3. <b>Create Collections:</b> This creates the database structure</p> <p class="mb-05 svelte-1gw615y">4. <b>Seed Database:</b> Adds the default template</p> <h3 class="bold mb-05 mt-1 svelte-1gw615y">Troubleshooting:</h3> <p class="mb-05 svelte-1gw615y">â€¢ <b>Connection failed:</b> Check if PocketBase is running and the URL is correct</p> <p class="mb-05 svelte-1gw615y">â€¢ <b>Authentication failed:</b> Verify your admin credentials</p> <p class="mb-05 svelte-1gw615y">â€¢ <b>Collection exists:</b> Collections may already be created</p></div></details></div></div></div></div>');function ci(t,e){_e(e,!0);let a=E(V(window.location.origin)),n=E("admin@example.com"),r=E(""),s=E(!1),o=E(1),u=E(""),l=E(!1),c=E(!1),f=E(!1),d=E(0),v=E(""),h=V({templates:!1,planners:!1});const g=[{num:1,name:"PocketBase URL"},{num:2,name:"Admin Credentials"},{num:3,name:"Create Collections"},{num:4,name:"Seed Database"},{num:5,name:"Complete"}];function x(){p.showSetupModal=!1;const C=document.querySelector(".setup-notification");C&&C.remove()}async function w(){b(l,!0);try{p.pb.baseURL=i(a),await p.pb.admins.authWithPassword(i(n),i(r)),b(o,3)}catch(C){alert("Authentication failed: "+C.message)}finally{b(l,!1)}}async function k(){b(l,!0);try{try{await p.pb.collections.getOne("templates")}catch(C){C.status===404&&await p.pb.collections.create(D())}try{await p.pb.collections.getOne("planners")}catch(C){C.status===404&&await p.pb.collections.create(O())}b(o,4)}catch(C){alert("Failed to create collections: "+C.message)}finally{b(l,!1)}}async function P(){b(f,!0),b(d,0);try{b(v,"Seeding templates..."),b(d,33),(await p.pb.collection("templates").getFullList()).length===0&&(await p.pb.collection("templates").create(te()),h.templates=!0),b(d,66),b(v,"Database seeded successfully"),b(o,5),b(d,100)}catch(C){alert("Failed to seed database: "+C.message),b(v,"Error: "+C.message)}finally{b(f,!1)}}async function $(){x(),await p.init()}function D(){return{name:"templates",type:"base",schema:[{name:"name",type:"text",required:!0,options:{min:1,max:50}},{name:"is_default",type:"bool"},{name:"structure",type:"json",required:!0}],indexes:["CREATE UNIQUE INDEX idx_templates_name ON templates (name)"]}}function O(){return{name:"planners",type:"base",schema:[{name:"week_id",type:"text",required:!0,options:{min:8,max:8,pattern:"^\\d{4}-W(0[1-9]|[1-4]\\d|5[0-3])$"}},{name:"template_id",type:"relation",required:!0,options:{collectionId:"templates",cascadeDelete:!1,maxSelect:1}},{name:"title",type:"text",options:{max:100}},{name:"city",type:"text",options:{max:50}},{name:"date_range",type:"text",options:{max:20}},{name:"prayer_times",type:"json"},{name:"schedule_data",type:"json"},{name:"tasks_data",type:"json"},{name:"workout_data",type:"json"},{name:"meals_data",type:"json"},{name:"grocery_data",type:"json"},{name:"measurements_data",type:"json"},{name:"financials_data",type:"json"}],indexes:["CREATE UNIQUE INDEX idx_planners_week ON planners (week_id)"]}}function te(){return{name:"default",is_default:!0,structure:{title_default:"Weekly Planner",city_default:"London",prayer_times:[{label:"Q",value:""},{label:"F",value:""},{label:"D",value:""},{label:"A",value:""},{label:"M",value:""},{label:"I",value:""}],schedule:[{name:"HABITS",activities:[{name:"Q: Quran",max_per_day:5,max_score:35},{name:"P: Prayer",max_per_day:5,max_score:35},{name:"E: Exercise",max_per_day:1,max_score:7},{name:"R: Read",max_per_day:1,max_score:7},{name:"L: Learn",max_per_day:1,max_score:7}]},{name:"TOTAL",activities:[{name:"DAILY POINTS",max_per_day:0,max_score:0}]}],tasks:{count:15,fields:["num","priority","tag","description","start_date","expected_date","actual_date","completed"]},workout:[{name:"PUSH",exercises:[{name:"Bench Press",default_weight:60,default_sets:4,default_reps:8},{name:"Shoulder Press",default_weight:40,default_sets:3,default_reps:10},{name:"Dips",default_weight:0,default_sets:3,default_reps:12}]},{name:"PULL",exercises:[{name:"Deadlift",default_weight:80,default_sets:4,default_reps:6},{name:"Pull-ups",default_weight:0,default_sets:3,default_reps:10},{name:"Rows",default_weight:50,default_sets:3,default_reps:12}]},{name:"LEGS",exercises:[{name:"Squats",default_weight:70,default_sets:4,default_reps:8},{name:"Lunges",default_weight:30,default_sets:3,default_reps:12},{name:"Calf Raises",default_weight:40,default_sets:3,default_reps:15}]}],meals:[{name:"Breakfast",ingredients:""},{name:"Lunch",ingredients:""},{name:"Dinner",ingredients:""},{name:"Snacks",ingredients:""}],grocery:{categories:[{name:"Proteins",items:""},{name:"Vegetables",items:""},{name:"Fruits",items:""},{name:"Dairy",items:""},{name:"Grains",items:""},{name:"Others",items:""}]},measurements:[{name:"Weight",placeholder:"kg"},{name:"Waist",placeholder:"cm"},{name:"Chest",placeholder:"cm"},{name:"Arms",placeholder:"cm"}],financials:[{name:"Income",placeholder:"0",account:""},{name:"Expenses",placeholder:"0",account:""},{name:"Savings",placeholder:"0",account:""},{name:"Investments",placeholder:"0",account:""}]}}}var j=ui();j.__click=[Qs,x];var Z=_(j),Te=_(Z),Se=_(Te),ue=m(_(Se),2);ue.__click=x;var me=m(Se,2),Fe=_(me);se(Fe,21,()=>g,qe,(C,U)=>{var B=Xs();let ce;var G=_(B),Y=_(G),ie=m(G,2),ee=_(ie);M(H=>{ce=Q(B,1,"setup-step svelte-1gw615y",null,ce,H),N(Y,i(U).num),N(ee,i(U).name)},[()=>({active:i(o)>=i(U).num})]),T(C,B)});var xe=m(me,2);{var Ee=C=>{var U=ti(),B=m(_(U),4),ce=m(B,2),G=_(ce);G.__click=[Gs,c,u,a,o];let Y;var ie=_(G),ee=m(G,2);{var H=K=>{var de=Zs();T(K,de)},fe=(K,de)=>{{var jt=ge=>{var at=ei();T(ge,at)};J(K,ge=>{i(u)==="error"&&ge(jt)},de)}};J(ee,K=>{i(u)==="success"?K(H):K(fe,!1)})}M(K=>{G.disabled=i(c)||!i(a),Y=Q(G,1,"svelte-1gw615y",null,Y,K),N(ie,i(c)?"Testing...":"Test Connection")},[()=>({"setup-disabled":i(c)||!i(a)})]),oe(B,()=>i(a),K=>b(a,K)),T(C,U)};J(xe,C=>{i(o)===1&&C(Ee)})}var Ie=m(xe,2);{var Ne=C=>{var U=ni(),B=m(_(U),4),ce=_(B),G=m(B,2),Y=_(G),ie=m(Y,2);ie.__click=[ai,s];var ee=_(ie),H=m(G,2);H.__click=w;let fe;var K=_(H);M(de=>{Be(Y,"type",i(s)?"text":"password"),N(ee,i(s)?"Hide":"Show"),H.disabled=i(l)||!i(n)||!i(r),fe=Q(H,1,"svelte-1gw615y",null,fe,de),N(K,i(l)?"Authenticating...":"Authenticate")},[()=>({"setup-disabled":i(l)||!i(n)||!i(r)})]),oe(ce,()=>i(n),de=>b(n,de)),oe(Y,()=>i(r),de=>b(r,de)),T(C,U)};J(Ie,C=>{i(o)===2&&C(Ne)})}var Ce=m(Ie,2);{var Qe=C=>{var U=ri(),B=m(_(U),6);B.__click=k;let ce;var G=_(B);M(Y=>{B.disabled=i(l),ce=Q(B,1,"svelte-1gw615y",null,ce,Y),N(G,i(l)?"Creating...":"Create Collections")},[()=>({"setup-disabled":i(l)})]),T(C,U)};J(Ce,C=>{i(o)===3&&C(Qe)})}var ae=m(Ce,2);{var F=C=>{var U=li(),B=m(_(U),4);{var ce=Y=>{var ie=si(),ee=Pe(ie),H=_(ee),fe=m(ee,2),K=_(fe);M(()=>{ea(H,`width: ${i(d)??""}%`),N(K,i(v))}),T(Y,ie)},G=Y=>{var ie=ii(),ee=Pe(ie),H=_(ee);{var fe=ge=>{var at=Zt("âœ“");T(ge,at)},K=ge=>{var at=Zt("â€¢");T(ge,at)};J(H,ge=>{h.templates?ge(fe):ge(K,!1)})}var de=m(ee,2);de.__click=P;let jt;M(ge=>{de.disabled=i(f),jt=Q(de,1,"svelte-1gw615y",null,jt,ge)},[()=>({"setup-disabled":i(f)})]),T(Y,ie)};J(B,Y=>{i(f)?Y(ce):Y(G,!1)})}T(C,U)};J(ae,C=>{i(o)===4&&C(F)})}var ke=m(ae,2);{var q=C=>{var U=oi(),B=m(_(U),4);B.__click=$,T(C,U)};J(ke,C=>{i(o)===5&&C(q)})}T(t,j),he()}Ye(["click"]);var fi=I('<div class="viewport-container"><div class="card"><!> <!> <!> <!> <!> <!> <!> <!></div></div> <!>',1),di=I("<!> <!> <!>",1);function vi(t,e){_e(e,!1),jr(()=>{p.init()}),De();var a=di(),n=Pe(a);Fs(n,{});var r=m(n,2);{var s=l=>{var c=fi(),f=Pe(c),d=_(f),v=_(d);Xr(v,{});var h=m(v,2);os(h,{});var g=m(h,2);ps(g,{});var x=m(g,2);bs(x,{});var w=m(x,2);ks(w,{});var k=m(w,2);Es(k,{});var P=m(k,2);Ps(P,{});var $=m(P,2);Ls($,{});var D=m(f,2);Ks(D,{}),T(l,c)};J(r,l=>{A(p),y(()=>!p.isInitializing)&&l(s)})}var o=m(r,2);{var u=l=>{ci(l,{})};J(o,l=>{A(p),y(()=>p.showSetupModal)&&l(u)})}T(t,a),he()}Tr(vi,{target:document.getElementById("app")});
